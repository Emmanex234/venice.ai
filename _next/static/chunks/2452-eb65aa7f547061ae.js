!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="af629a88-ae42-45e2-b197-8721914de36f",e._sentryDebugIdIdentifier="sentry-dbid-af629a88-ae42-45e2-b197-8721914de36f")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2452],{74386:function(e,r,t){"use strict";t.d(r,{K:function(){return o}});var n=t(57437);let o=(0,t(53755).I)({displayName:"LogoIcon",path:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M457.089 612.526L456.889 612.726V397.526H369.188V353.326H413.389V131.026C387.589 121.526 369.188 96.7261 369.188 67.626C369.188 30.3262 399.488 0.125977 436.788 0.125977C474.089 0.125977 504.288 30.3262 504.288 67.626C504.288 97.0259 485.589 122.026 459.389 131.326V352.726H501.688V562.126C483.988 576.326 469.089 593.226 457.089 612.526ZM416.788 67.126C416.788 78.126 425.688 87.126 436.788 87.126C447.788 87.126 456.788 78.126 456.788 67.126C456.788 56.126 447.889 47.126 436.788 47.126C425.788 47.126 416.788 56.126 416.788 67.126Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M585.488 283.226V520.726C568.589 525.226 552.788 531.226 538.288 538.626V283.226H585.488Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M538.188 135.226H669.288V266.326H538.188V135.226ZM585.389 216.126H621.089V180.426H585.389V216.126Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M205.589 134.226H336.688V265.326H205.589V134.226ZM252.788 215.226H288.488V179.526H252.788V215.226Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M288.089 283.826H336.188V400.026H205.089V283.826H252.389V349.926H288.089V283.826Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M735.589 202.826C735.589 165.426 763.488 135.226 800.788 135.226C838.089 135.226 868.389 165.426 868.389 202.826C868.389 230.726 851.389 254.826 827.089 265.026V474.926H668.488V510.026C663.488 510.026 657.089 510.426 650.688 510.926C640.589 511.426 630.688 512.326 621.089 513.626V283.326H669.089V429.326H779.089V266.726C753.188 257.626 735.589 232.426 735.589 202.826ZM780.688 202.226C780.688 213.226 789.688 222.226 800.788 222.226C811.889 222.226 820.889 213.226 820.788 202.226C820.788 191.226 811.889 182.226 800.788 182.226C789.688 182.226 780.688 191.126 780.688 202.226Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M205.988 475.926H45.0889V266.326C18.8887 257.026 0.188477 232.026 0.188477 202.726C0.188477 165.326 30.3887 135.126 67.6885 135.126C105.089 135.126 135.288 165.426 135.288 202.726C135.288 231.626 117.188 256.226 91.6885 265.926V430.726H413.288V609.926C401.688 591.926 387.488 576.126 370.988 562.726V475.126H335.089V539.326C320.488 531.826 304.688 525.726 287.889 521.126V475.526H252.788V513.926C237.788 511.726 222.089 510.626 205.988 510.626V475.926ZM87.8887 202.126C87.8887 191.126 78.8887 182.126 67.7881 182.126C56.6885 182.126 47.6885 191.126 47.7881 202.126C47.7881 213.126 56.6885 222.126 67.7881 222.126C78.8887 222.126 87.8887 213.226 87.8887 202.126Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M826.288 535.226C830.288 684.026 821.788 841.526 700.288 1024.43C624.889 1137.83 536.688 1182.03 484.288 1199.13C454.089 1208.83 421.589 1208.83 391.288 1199.33C337.788 1182.53 247.688 1138.53 171.988 1024.53C50.4883 841.626 41.8887 684.126 45.9883 535.326C45.9883 535.326 76.8887 569.826 160.188 558.726C266.188 544.626 385.389 576.026 403.389 714.726V818.026C403.389 818.026 375.788 755.826 289.988 773.726C206.089 791.226 144.389 744.526 106.089 695.126C106.089 695.126 117.688 870.326 223.488 1003.23C312.988 1115.63 362.988 1135.63 415.889 1149.53C430.288 1153.23 445.389 1153.23 459.788 1149.43C511.889 1135.53 559.389 1115.33 648.788 1003.13C754.589 870.226 766.188 695.026 766.188 695.026C727.889 744.526 666.188 791.126 582.288 773.626C496.389 755.726 468.889 817.926 468.889 817.926V714.626C486.889 575.926 606.089 544.526 712.089 558.626C795.488 569.726 826.288 535.226 826.288 535.226ZM576.802 714.568C597.049 717.833 619.234 721.411 651.288 714.126C686.488 706.126 723.589 650.426 723.389 650.326C700.315 646.876 683.194 642.896 668.776 639.542L668.756 639.538L668.738 639.534C643.061 633.561 625.944 629.58 598.988 634.126C532.889 645.326 515.089 722.026 515.089 722.026C529.288 710.826 554.889 711.126 570.889 713.626C572.843 713.93 574.808 714.247 576.79 714.567L576.802 714.568ZM358.889 722.126C358.889 722.126 341.089 645.426 274.988 634.226C247.914 629.671 230.761 633.677 204.988 639.696L204.974 639.699C190.576 643.062 173.492 647.051 150.488 650.526C150.488 650.526 187.488 706.226 222.688 714.226C254.742 721.511 276.929 717.933 297.176 714.668C299.162 714.348 301.132 714.03 303.089 713.726C319.089 711.226 344.788 710.926 358.889 722.126Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M361.447 995.175C350.37 1002.06 324.528 1004.08 310.1 1004.05C308.307 1004.05 307.387 1006.17 308.755 1007.33C326.707 1022.55 353.042 1018.66 377.596 1014.66C387.479 1013.05 397.266 1016.43 407.544 1019.98C416.014 1022.91 424.817 1025.96 434.286 1026.42C443.754 1025.96 452.558 1022.91 461.028 1019.98C471.307 1016.43 481.093 1013.05 490.976 1014.66C515.529 1018.66 541.864 1022.55 559.817 1007.33C561.186 1006.17 560.266 1004.05 558.473 1004.05C544.043 1004.08 518.201 1002.06 507.125 995.175C505.237 994.002 503.418 992.835 501.645 991.698C488.747 983.426 478.265 976.703 461.797 980.448C455.348 981.916 452.367 984.339 449.62 986.573C446.212 989.345 443.162 991.825 434.286 991.825C425.41 991.825 422.36 989.345 418.951 986.573C416.204 984.339 413.225 981.916 406.774 980.448C390.308 976.703 379.825 983.426 366.928 991.698C365.154 992.835 363.334 994.002 361.447 995.175Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M380.628 1048.34C393.203 1053.17 413.383 1060.51 434.289 1059.91C455.194 1060.51 475.375 1053.17 487.95 1048.34C489.341 1047.8 490.793 1048.92 490.544 1050.39C485.229 1081.77 450.056 1093.89 434.289 1093.89C418.522 1093.89 383.349 1081.77 378.034 1050.39C377.785 1048.92 379.236 1047.8 380.628 1048.34Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M507.658 857.55C507.008 855.66 508.908 854.29 510.197 855.81C517.088 863.95 522.808 878.23 517.288 891.64C517.116 891.929 516.939 892.233 516.756 892.549C513.171 898.726 506.91 909.511 476.468 907.97C460.847 907.186 446.489 914.406 436.391 948.656C435.801 950.657 432.769 950.658 432.178 948.659C422.045 914.405 407.72 907.177 392.107 907.97C361.666 909.511 355.405 898.726 351.821 892.549C351.638 892.233 351.461 891.929 351.288 891.64C345.768 878.23 351.498 863.95 358.378 855.81C359.668 854.29 361.567 855.66 360.918 857.55C352.518 881.9 359.848 888.41 363.697 888.41C367.316 888.41 369.84 885.879 372.885 882.826C375.502 880.202 378.504 877.191 382.918 875.07C388.618 872.34 400.868 869.85 409.308 875.07C413.344 877.564 416.708 879.377 419.579 880.704C428.832 884.979 439.744 884.982 448.997 880.707C451.869 879.38 455.233 877.566 459.268 875.07C467.708 869.85 479.968 872.34 485.658 875.07C490.075 877.188 493.078 880.201 495.696 882.828C498.738 885.879 501.261 888.41 504.878 888.41C508.728 888.41 516.058 881.9 507.658 857.55Z",fill:"currentColor"})]}),viewBox:"0 0 869 1207"})},31869:function(e,r,t){"use strict";t.d(r,{f:function(){return u}});var n=t(57437),o=t(25730),a=t(2265),i=t(45168),s=t(23838),l=t(74468),d=t(13823);let c=(0,n.jsx)(i.tE8,{}),u=()=>{let{state:{showChatbar:e},dispatch:r}=(0,d.IO)(),t=(0,a.useCallback)(()=>{r({field:"showChatbar",value:!e}),s.Z.setItem("showChatbar",JSON.stringify(!e)),(0,l.Qe)({name:"toggledChatbar",data:{value:!e}})},[r,e]);return(0,n.jsx)(o.h,{colorScheme:"secondary",variant:"ghost",size:"md","aria-label":"Show Sidebar",icon:c,onClick:t})}},87281:function(e,r,t){"use strict";t.d(r,{n:function(){return m}});var n=t(57437),o=t(72760),a=t(86827),i=t(83657),s=t(32230),l=t(13449),d=t(13701),c=t(4360),u=t(37354),f=t(6924),p=t(45168),h=t(47672),x=t(8554);let m=e=>{let{characterId:r}=e,{data:t,status:m}=(0,x.sF)(r);return"pending"===m?(0,n.jsx)(o.$,{}):t?(0,n.jsxs)(a.M,{width:"full",height:"100%",flexDir:"column",gap:6,alignItems:"center",children:[(0,n.jsxs)(i.K,{spacing:1,alignItems:"center",children:[(0,n.jsx)(s.q,{mb:2,boxSize:"16rem",src:t.photo,ignoreFallback:!0}),(0,n.jsx)(l.k,{alignItems:"center",children:(0,n.jsx)(h.M,{characterId:t.id,as:d.z,rightIcon:(0,n.jsx)(p.YRR,{}),variant:"ghost",size:"lg",p:3,py:1,height:"auto",iconSpacing:1,minHeight:"auto",color:"text.base",hideNewChat:!0,children:t.name})}),(0,n.jsx)(c.x,{color:"text.subtle",textAlign:"center",maxWidth:"xl",mx:"auto",children:t.description})]}),t.intro&&(0,n.jsx)(u.Z,{children:(0,n.jsx)(f.e,{children:(0,n.jsx)(c.x,{children:t.intro})})})]}):(0,n.jsx)(n.Fragment,{})}},47672:function(e,r,t){"use strict";t.d(r,{M:function(){return b}});var n=t(57437),o=t(44167),a=t(71416),i=t(78796),s=t(86333),l=t(77951),d=t(85330),c=t(46402),u=t(67467),f=t(22053),p=t(99376),h=t(42586),x=t(2265),m=t(45168),C=t(41528),w=t(13823),g=t(8554);let b=(0,o.forwardRef)((e,r)=>{let{characterId:t,hideNewChat:o,...b}=e,{isOpen:v,onClose:R,onOpen:j}=(0,a.q)(),y=(0,h.useTranslations)(),{onOpen:S}=(0,C.R)("character"),k=(0,i.p)(),I=(0,p.useRouter)(),{data:T}=(0,g.sF)(t),{mutateAsync:M}=(0,g.Js)(),{mutateAsync:z}=(0,g.Jn)(),{handleDeleteFolder:F,state:{folders:V}}=(0,w.IO)(),H=(0,x.useCallback)(e=>{e.stopPropagation(),t&&I.push("/character-chat/".concat(t))},[t,I]),D=(0,x.useCallback)(e=>{e.stopPropagation(),t&&S({characterId:t,isEditing:!0})},[S,t]),E=(0,x.useCallback)(e=>{e.stopPropagation(),t&&S({characterId:t,isDuplicating:!0})},[S,t]),P=(0,x.useCallback)(async e=>{if(e.stopPropagation(),t&&window.confirm("Are you sure you want to delete this character?")){var r;await M(t);let e=null===(r=V.find(e=>e.characterId===t))||void 0===r?void 0:r.id;if(e&&await F(e),(null==T?void 0:T.isPublic)&&(null==T?void 0:T.publicId))try{await z(T.publicId)}catch(e){}k({status:"success",title:"Character deleted",description:"Character has been deleted",position:"top-right"})}},[t,M,V,null==T?void 0:T.isPublic,null==T?void 0:T.publicId,k,F,z]),L=(0,x.useCallback)(e=>{e.stopPropagation(),j()},[j]);return(0,n.jsxs)(s.v,{isOpen:v,onClose:R,children:[(0,n.jsx)(l.j,{onClick:L,size:"sm",fontSize:{base:"sm",md:"lg"},ref:r,...b}),(0,n.jsx)(d.h,{children:(0,n.jsxs)(c.q,{position:"absolute",zIndex:1500,children:[!o&&(0,n.jsxs)(u.s,{onClick:H,gap:2,children:[(0,n.jsx)(f.xu,{as:"span",fontSize:"lg",children:(0,n.jsx)(m.dKc,{})}),y("characterMenu.newChat")]}),(0,n.jsxs)(u.s,{onClick:D,gap:2,children:[(0,n.jsx)(f.xu,{as:"span",fontSize:"lg",children:(0,n.jsx)(m.Lik,{})}),y("characterMenu.editCharacter")]}),(0,n.jsxs)(u.s,{onClick:E,gap:2,children:[(0,n.jsx)(f.xu,{as:"span",fontSize:"lg",children:(0,n.jsx)(m.muo,{})}),y("characterMenu.duplicateCharacter")]}),(0,n.jsxs)(u.s,{onClick:P,gap:2,children:[(0,n.jsx)(f.xu,{as:"span",fontSize:"lg",children:(0,n.jsx)(m.EF5,{})}),y("characterMenu.deleteCharacter")]})]})})]})})},49062:function(e,r,t){"use strict";t.d(r,{q:function(){return b}});var n=t(57437),o=t(184),a=t(22053),i=t(58055),s=t(42586),l=t(2265),d=t(45168),c=t(26629),u=t(86827),f=t(22122);let p=e=>{let{icon:r}=e,{getInputProps:t,getRadioProps:o}=(0,c.x)(e),i=t(),s=o();return(0,n.jsx)(a.xu,{as:"label",children:(0,n.jsx)(f.u,{label:e.tooltip,placement:"right",openDelay:1e3,children:(0,n.jsxs)(u.M,{...s,"data-testid":"conversationTypeSelector-".concat(e.label),fontSize:"xl",borderRadius:"lg",boxSize:"32px",color:"text.subtle",cursor:"pointer",transitionProperty:"common",transitionDuration:"normal",_hover:{color:"text.subtle"},_checked:{bg:"background.button.primary.base",color:"text.primary.base",boxShadow:"0 1px 0 rgba(255,255,255,.15) inset"},children:[(0,n.jsx)("input",{...i}),r]})},e.value)})};var h=t(18254);let x=(0,n.jsx)(d.YsT,{}),m=(0,n.jsx)(d.msJ,{}),C=(0,n.jsx)(d.ssl,{}),w={[h.i.Text]:x,[h.i.Image]:m,[h.i.Code]:C},g={cursor:"not-allowed"},b=(0,l.memo)(e=>{let{value:r,onChange:t,isDisabled:d,iconOverrides:c}=e,{getRootProps:u,getRadioProps:f}=(0,o.a)({name:"type",value:r,onChange:t,isDisabled:d}),x=(0,l.useMemo)(()=>u(),[u]),m=(0,s.useTranslations)(),C=(0,l.useMemo)(()=>[h.i.Text,h.i.Image,h.i.Code].map(e=>{var r;return(0,n.jsx)(p,{icon:null!==(r=null==c?void 0:c[e])&&void 0!==r?r:w[e],tooltip:m("chatType.tooltips.".concat(e)),label:e,isDisabled:d,...f({value:e})},e)}),[f,c,d,m]);return(0,n.jsxs)(a.xu,{position:"relative",children:[(0,n.jsx)(i.U,{...x,spacing:1,bg:"background.button.secondary.base",borderRadius:"lg",height:"32px",children:C}),d&&(0,n.jsx)(a.xu,{position:"absolute",top:0,right:0,bottom:0,left:0,bg:"rgba(0, 0, 0, 0.05)",borderRadius:"xl",__css:g})]})});b.displayName="ToggleChatType"},57274:function(e,r,t){"use strict";t.d(r,{C:function(){return W}});var n=t(57437),o=t(13449),a=t(25730),i=t(13701),s=t(99376),l=t(42586),d=t(2265),c=t(45168),u=t(86537),f=t(62128),p=t(58528);let h=e=>{let{children:r}=e;return(0,n.jsx)(n.Fragment,{children:r})};h.Desktop=e=>{let{children:r}=e,[t]=(0,f.a)("(min-width: ".concat(p.A.md,")"),{ssr:!1});return t?(0,n.jsx)(n.Fragment,{children:r}):null},h.Mobile=e=>{let{children:r}=e,[t]=(0,f.a)("(min-width: ".concat(p.A.md,")"),{ssr:!1});return t?null:(0,n.jsx)(n.Fragment,{children:r})};var x=t(97205),m=t(31631),C=t(4360),w=t(25774),g=t(74468),b=t(44321),v=t(43159),R=t(51138),j=t(93369),y=t(18254),S=t(81613);let k=(0,n.jsx)(c.YsT,{size:"1rem"}),I=(0,n.jsx)(c.msJ,{size:"1rem"}),T=(0,n.jsx)(c.ssl,{size:"1rem"}),M=e=>(0,n.jsx)(i.z,{leftIcon:I,px:3,width:"full",justifyContent:{base:"center",md:"flex-start"},_hover:{color:"text.base"},...e}),z=e=>{let{conversationType:r,textAreaRef:t,onMessageTypeChange:a,placement:s="auto"}=e,[u,f]=(0,d.useState)(r),p=(0,l.useTranslations)(),h=(0,w.Sz)(v.St,e=>e.isProUser),z=(0,w.Sz)(v.St,e=>e.isVeniceStaff),F=(0,j.F)(e=>e.settings.textModel),V=(0,j.F)(e=>e.settings.imageModel),H=(0,j.F)(e=>e.settings.codeModel),D=(0,j.F)(e=>e.saveImageModel),E=(0,j.F)(e=>e.saveTextModel),P=(0,j.F)(e=>e.saveCodeModel),L=(0,w.Sz)(v.St,e=>e.issuePoints),Z=(0,d.useMemo)(()=>{let e;return e=(0,R.Do)(u,{includeRetired:!0,inActive:!1,isListed:!0,isProUser:h,isVeniceStaff:z}),h&&(e=e.filter(e=>!e.freeOnly)),e},[u,h,z]),A=(0,d.useMemo)(()=>{switch(r){case y.i.Text:return null!=F?F:R.bO.id;case y.i.Code:return null!=H?H:R.au.id;case y.i.Image:return null!=V?V:R.HX.id;default:return""}},[H,r,V,F]),U=(0,d.useMemo)(()=>(0,R.Ho)(A)||null,[A]),O=(0,d.useMemo)(()=>{if(!U)return null;switch(r){case y.i.Text:return U.id!==R.bO.id?U.friendly_name:null;case y.i.Image:return U.id!==R.HX.id?U.friendly_name:null;case y.i.Code:return U.id!==R.au.id?U.friendly_name:null;default:return null}},[U,r]),_=(0,d.useCallback)(e=>{let[n,o]=e.split(":"),i=(0,R.Ho)(o);if(!i)throw Error("Invalid model id");switch(r!==n&&a(u),n){case y.i.Text:E(i.id);break;case y.i.Image:D(i.id);break;case y.i.Code:P(i.id);default:return}(0,g.Qe)({name:"changedModel",data:{conversationType:y.i.Text,model:i}}),L(S.mR.MODEL_SELECTION),(null==t?void 0:t.current)&&t.current.focus()},[u,r,L,a,P,D,E,t]);(0,d.useEffect)(()=>{f(r)},[r]);let q=(0,d.useMemo)(()=>(0,n.jsxs)(o.k,{bg:{base:"background.surface.overlay.base",md:"background.surface.overlay.raised.base"},position:"sticky",top:0,p:2,zIndex:"sticky",flexDirection:"column",borderRightWidth:1,borderColor:"border.base",boxSizing:"border-box",flexShrink:0,width:{base:"full",md:"200px"},children:[(0,n.jsxs)(x.h,{spacing:0,variant:"ghost",size:"md",flexDirection:{base:"row",md:"column"},children:[(0,n.jsx)(M,{leftIcon:k,isActive:u===y.i.Text,onClick:()=>f(y.i.Text),children:p("chatSettings.tabs.text")}),(0,n.jsx)(M,{leftIcon:I,isActive:u===y.i.Image,onClick:()=>f(y.i.Image),children:p("chatSettings.tabs.image")}),(0,n.jsx)(M,{leftIcon:T,isActive:u===y.i.Code,onClick:()=>f(y.i.Code),children:p("chatSettings.tabs.code")})]}),(0,n.jsxs)(o.k,{flexDirection:"column",mt:"auto",gap:1,px:3,pb:3,display:{base:"none",md:"flex"},children:[(0,n.jsxs)(o.k,{alignItems:"center",gap:1,children:[(0,n.jsx)(c.Qoz,{size:"14px",color:"var(--chakra-colors-text-subtle)"}),(0,n.jsx)(m.X,{size:"xs",fontWeight:"medium",children:p("modelSelector.helper.title")})]}),(0,n.jsx)(C.x,{fontSize:"xs",color:"text.subtle",fontWeight:"normal",children:p("modelSelector.helper.description")})]})]}),[u,p]),N=(0,d.useMemo)(()=>(0,n.jsx)(o.k,{bg:"background.surface.overlay.base",display:{base:"flex",md:"none"},children:(0,n.jsxs)(o.k,{bg:"background.surface.overlay.raised.base",flexDirection:"column",mt:"auto",gap:1,py:3,px:6,children:[(0,n.jsxs)(o.k,{alignItems:"center",gap:1,children:[(0,n.jsx)(c.Qoz,{size:"14px"}),(0,n.jsx)(m.X,{size:"xs",fontWeight:"medium",children:p("modelSelector.helper.title")})]}),(0,n.jsx)(C.x,{fontSize:"xs",color:"text.subtle",fontWeight:"normal",children:p("modelSelector.helper.description")})]})}),[p]);return(0,n.jsx)(b.h,{options:Z,placement:s,value:"".concat(r,":").concat(A),conversationType:u,onChange:_,as:i.z,variant:"ghost",rightIcon:(0,n.jsx)(c.YRR,{}),size:{base:"sm",md:"md"},listHeader:q,listFooter:N,autoReset:!1,menuListProps:{flexDirection:{base:"column",md:"row"},maxWidth:{base:"375px",md:"650px"}},children:O||p("modelSelector.switcher.title")})};var F=t(31869),V=t(22053),H=t(5095),D=t(59745),E=t(21652),P=t.n(E),L=t(41528),Z=t(82129),A=t(3809);let U=e=>{let{conversationType:r,isDisabled:t,characterId:o}=e,{onOpen:s}=(0,L.R)("chatSettings"),u=(0,l.useTranslations)(),h=(0,w.Sz)(v.St,e=>e.id),{data:x}=(0,Z.QB)(h),m=(0,j.F)(e=>e.settings.imageSettings),C=(0,j.F)(e=>e.settings.textSettings),b=(0,w.Sz)(v.St,e=>e.isProUser),[R]=(0,f.a)("(min-width: ".concat(p.A.md,")"),{ssr:!1}),S=(0,d.useMemo)(()=>(null==x?void 0:x.some(e=>e.active))||!1,[x]),k=(0,d.useMemo)(()=>{switch(r){case y.i.Text:return!P()(C,A.Bj)||S;case y.i.Image:return!P()(m,A.IW);default:return!1}},[r,m,S,C]),I=()=>{(0,g.Qe)({name:"openedChatSettings",data:{}}),s({conversationType:null!=r?r:void 0,characterId:o})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(V.xu,{position:"relative",children:[(0,n.jsx)(H.M,{mode:"wait",children:k&&(0,n.jsx)(D.E.div,{animate:{scale:1},initial:{scale:0},style:{width:"10px",height:"10px",position:"absolute",top:"-1px",right:"-1px",zIndex:2,borderRadius:"100%",backgroundColor:"var(--primary)"}})}),b||!R?(0,n.jsx)(a.h,{colorScheme:"secondary",variant:"ghost",size:"md",icon:(0,n.jsx)(c.AXL,{}),"aria-label":"Chat settings",onClick:I,isDisabled:t}):(0,n.jsx)(i.z,{colorScheme:"secondary",variant:"ghost",size:"md",leftIcon:(0,n.jsx)(c.AXL,{}),"aria-label":"Chat settings",onClick:I,isDisabled:t,children:u("chatSettings.title")})]})})};var O=t(64214),_=t(13823);let q=(0,n.jsx)(c.dKc,{}),N={base:"fixed",md:"absolute"},W=(0,d.memo)(e=>{let{leftComponent:r,rightComponent:t,hideRightComponent:c,conversationType:f,characterId:p,textAreaRef:x,onMessageTypeChange:m}=e,C=(0,l.useTranslations)(),w=(0,s.useRouter)(),{state:{loading:g,messageIsStreaming:b}}=(0,_.IO)(),{clearSelectedConversation:v,selectedConversation:R}=(0,O.uu)(),j=null!=p?p:null==R?void 0:R.characterId,S=g||b,k=(0,d.useCallback)(()=>{if(v(),j)return w.push("/character-chat/".concat(j))},[j,v,w]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(o.k,{position:N,top:0,left:0,right:0,className:"chat-header",bg:"var(--background-transparent)",backdropFilter:"blur(15px)",borderBottomWidth:1,borderColor:"border.subtle",zIndex:"sticky",children:(0,n.jsxs)(u.fK,{flexProps:{width:"full"},py:2,minHeight:"auto",children:[(0,n.jsx)(u.ej,{children:r||(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(F.f,{}),!p&&m&&(0,n.jsx)(h,{children:(0,n.jsx)(h.Desktop,{children:(0,n.jsx)(z,{conversationType:null!=f?f:y.i.Text,textAreaRef:x,placement:"bottom-end",onMessageTypeChange:m})})})]})}),(0,n.jsx)(u.zR,{children:!p&&m&&(0,n.jsx)(h,{children:(0,n.jsx)(h.Mobile,{children:(0,n.jsx)(z,{conversationType:null!=f?f:y.i.Text,textAreaRef:x,onMessageTypeChange:m})})})}),!c&&(0,n.jsx)(u.y6,{children:t||(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(h,{children:[(0,n.jsx)(h.Mobile,{children:(0,n.jsx)(a.h,{icon:q,variant:"ghost",size:"md","aria-label":C("newChat"),isDisabled:S,onClick:k})}),(0,n.jsx)(h.Desktop,{children:(0,n.jsx)(i.z,{size:"md",variant:"ghost",onClick:k,leftIcon:q,isDisabled:S,children:C("newChat")})})]}),(0,n.jsx)(U,{conversationType:f,characterId:j})]})})]})})})});W.displayName="ChatHeader"},38236:function(e,r,t){"use strict";t.d(r,{H:function(){return b},W:function(){return v}});var n=t(57437),o=t(78796),a=t(22048),i=t(99411),s=t(42586),l=t(2265),d=t(36776),c=t(25774),u=t(74468),f=t(79482),p=t(51138),h=t(3490),x=t(14508),m=t(21846),C=t(18977),w=t(94197),g=t(93369);let b=(0,c.kr)({handleTextFileUpload:async()=>{},handleImageFileUpload:async()=>{},resetFileState:()=>{},setFiles:()=>{},isFileLoading:!1,fileName:"",fileType:"",fileText:"",fileTokens:0,files:[]}),v=e=>{let{children:r}=e,[t,c]=(0,l.useState)(!1),[v,R]=(0,l.useState)([]),[j,y]=(0,l.useState)(""),[S,k]=(0,l.useState)(""),[I,T]=(0,l.useState)(""),[M,z]=(0,l.useState)(0),F=(0,g.F)(e=>e.settings.textModel),V=(0,g.F)(e=>e.saveTextModel),H=(0,g.F)(e=>e.saveCodeModel),D=(0,o.p)(),E=(0,s.useTranslations)(),{getChatFile:P}=(0,w.Z)(),L=(0,l.useMemo)(()=>({status:"error",duration:1e4,isClosable:!0,position:"top-right"}),[]),Z=(0,l.useCallback)(e=>{D({title:E("chatInput.fileUpload.errors.genericError.title"),description:E("chatInput.fileUpload.errors.genericError.description"),...L}),R([]),a.Tb(e),(0,C.x)((0,d.Xy)(e))},[R,D,L,E]),A=(0,l.useCallback)(async e=>{try{c(!0),R([e]);let r=(0,p.Ho)(null!=F?F:p.bO.id);(0,p.Pd)(r)<p.sI&&(V(p.dw.id),H(p.dw.id),D({...L,title:E("chatInput.fileUpload.largerContextSelected.title"),description:E("chatInput.fileUpload.largerContextSelected.description"),status:"info"}));let t=(0,m.m)(e.name),n=await (0,i.ws)("".concat(h.ju,"/").concat((0,f.LJ)(),".").concat(t),e,{access:"public",handleUploadUrl:"/api/inference/chat-file/upload"}),o=n.downloadUrl,a=await P(o,n.contentType);c(!1),y(e.name),k((0,x.J)(e)),(0,u.Qe)({name:"uploadedDocument",data:{mimeType:e.type,tokens:a.tokens}});let s=a.text.trim();if("PasswordException"===s){D({title:E("chatInput.fileUpload.errors.passwordException.title"),description:E("chatInput.fileUpload.errors.passwordException.description"),...L}),R([]);return}if(""===s){D({title:E("chatInput.fileUpload.errors.noText.title"),description:E("chatInput.fileUpload.errors.noText.description"),...L}),R([]);return}T(a.text),z(a.tokens)}catch(e){c(!1),Z(e)}},[F,P,V,H,D,L,E,Z]),U=(0,l.useCallback)(async e=>{try{R([e]),c(!0);let r=await new Promise((r,t)=>{let n=new FileReader;n.onload=()=>{let e=n.result.split(",")[1];r(e.trim())},n.onerror=()=>t(Error("Failed to read file")),n.readAsDataURL(e)});c(!1),y(e.name),k((0,x.J)(e)),T(r),(0,u.Qe)({name:"uploadedImage",data:{mimeType:e.type,base64Size:r.length}})}catch(e){c(!1),Z(e)}},[Z]),O=(0,l.useCallback)(()=>{R([]),T(""),y(""),k(""),z(0)},[R]);return(0,n.jsx)(b.Provider,{value:{handleTextFileUpload:A,handleImageFileUpload:U,resetFileState:O,setFiles:R,isFileLoading:t,fileName:j,fileType:S,fileText:I,fileTokens:M,files:v},children:r})}},14478:function(e,r,t){"use strict";t.d(r,{e:function(){return a}});var n=t(47887),o=t(3490);let a=e=>e.filter(e=>!e.isRateLimited&&!e.isErrored&&!e.exceedsTokenLimit&&e.modelType===n.BY.Text&&"venice"!==e.role).slice(-o.dN).map(e=>({content:e.content,role:e.role,isFile:e.isFile}))},51868:function(e,r,t){"use strict";t.d(r,{Q:function(){return o}});var n=t(47887);let o=async e=>{let{type:r,modelPostBody:t,clientProcessingTime:o,abortSignal:a}=e,i=r===n.BY.Image?"/api/inference/image":"/api/inference/chat";return await fetch(i,{method:"POST",headers:{"Content-Type":"application/json","X-Venice-Version":"20250129.220346"},signal:a,body:JSON.stringify({...t,clientProcessingTime:o})})}},34590:function(e,r,t){"use strict";t.d(r,{e:function(){return m}});var n=t(78796),o=t(22048),a=t(42586),i=t(2265),s=t(25774),l=t(51868),d=t(43159),c=t(79482),u=t(51138),f=t(47887),p=t(3490),h=t(96490),x=t(18254);let m=()=>{let e=(0,n.p)(),r=(0,a.useTranslations)(),t=(0,s.Sz)(d.St,e=>e.isSignedIn),m=(0,s.Sz)(d.St,e=>e.isProUser);return{enhancePrompt:(0,i.useCallback)(async n=>{let a={requestId:(0,c.LJ)(),modelId:u.bO.id,prompt:[{role:"user",content:n}],systemPrompt:h.Gm.enhanceImage,webEnabled:!1,conversationType:x.i.Text,seed:Date.now(),topP:p.Ht},i=await (0,l.Q)({type:f.BY.Text,modelPostBody:a}),s=i.status;if(200===s)return i;if(429===s){let n=r("enhanceImagePrompt.errors.rateLimitExceeded.general");throw m?n+=" ".concat(r("enhanceImagePrompt.errors.rateLimitExceeded.pro")):t?n+=" ".concat(r("enhanceImagePrompt.errors.rateLimitExceeded.free")):n+=" ".concat(r("enhanceImagePrompt.errors.rateLimitExceeded.anon")),e({title:n,status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),Error("Rate limit exceeded")}throw o.uT("Error enhancing image",{extra:{responseStatus:s}}),e({title:r("enhanceImagePrompt.errors.unknownError"),status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),Error("Error enhancing image prompt")},[m,t,e,r])}}},80280:function(e,r,t){"use strict";t.d(r,{h:function(){return o}});var n=t(2265);function o(){let e=(0,n.useRef)(null),r=(0,n.useCallback)(r=>{if("Enter"===r.key&&!r.shiftKey&&!r.nativeEvent.isComposing){var t,n;(null===(t=e.current)||void 0===t?void 0:t.requestSubmit)&&(null===(n=e.current)||void 0===n||n.requestSubmit()),r.preventDefault()}},[]);return{formRef:e,onKeyDown:r}}},48728:function(e,r,t){"use strict";t.d(r,{z:function(){return o}});var n=t(48778);async function o(e,r,t){let o=new n.cB({separator:"\n",emitPartialTokens:!1});o.onValue=e=>{let{value:t,stack:n}=e;0===n.length&&"object"==typeof t&&t.constructor===Object&&("meta"===t.kind&&t.references||"content"===t.kind&&t.content)&&r(t)};let a=new TextDecoder,i=e.getReader();for(;;){let{done:e,value:r}=await i.read();if(e)return!1;let n=a.decode(r);if(o.write(n),null==t?void 0:t())return i.cancel(),!0}}},14508:function(e,r,t){"use strict";t.d(r,{J:function(){return o}});var n=t(21846);function o(e){let r=e.type.toLowerCase();if("text/plain"===r||""===r.trim())return"Plain Text";if(r.startsWith("image/"))return"Image";if(r.startsWith("audio/"))return"Audio";if(r.startsWith("video/"))return"Video";if("application/pdf"===r)return"PDF";if(r.includes("spreadsheet")||"application/vnd.ms-excel"===r)return"Spreadsheet";if(r.includes("wordprocessing")||"application/msword"===r)return"Document";else return(0,n.m)(e.name)}},21846:function(e,r,t){"use strict";t.d(r,{m:function(){return n}});let n=e=>{if(-1===e.lastIndexOf("."))return"txt";let r=e.split(".").pop();return null!=r?r.replaceAll(/\s/g,""):"txt"}},44167:function(e,r,t){"use strict";t.d(r,{forwardRef:function(){return L.forwardRef}});var n=t(7193);t.o(n,"forwardRef")&&t.d(r,{forwardRef:function(){return n.forwardRef}});var o=t(26216);t.o(o,"forwardRef")&&t.d(r,{forwardRef:function(){return o.forwardRef}});var a=t(71247);t.o(a,"forwardRef")&&t.d(r,{forwardRef:function(){return a.forwardRef}});var i=t(93765);t.o(i,"forwardRef")&&t.d(r,{forwardRef:function(){return i.forwardRef}});var s=t(62031);t.o(s,"forwardRef")&&t.d(r,{forwardRef:function(){return s.forwardRef}});var l=t(77192);t.o(l,"forwardRef")&&t.d(r,{forwardRef:function(){return l.forwardRef}});var d=t(93542);t.o(d,"forwardRef")&&t.d(r,{forwardRef:function(){return d.forwardRef}});var c=t(75149);t.o(c,"forwardRef")&&t.d(r,{forwardRef:function(){return c.forwardRef}});var u=t(54586);t.o(u,"forwardRef")&&t.d(r,{forwardRef:function(){return u.forwardRef}});var f=t(21776);t.o(f,"forwardRef")&&t.d(r,{forwardRef:function(){return f.forwardRef}});var p=t(21295);t.o(p,"forwardRef")&&t.d(r,{forwardRef:function(){return p.forwardRef}});var h=t(61714);t.o(h,"forwardRef")&&t.d(r,{forwardRef:function(){return h.forwardRef}});var x=t(44939);t.o(x,"forwardRef")&&t.d(r,{forwardRef:function(){return x.forwardRef}});var m=t(71292);t.o(m,"forwardRef")&&t.d(r,{forwardRef:function(){return m.forwardRef}});var C=t(27567);t.o(C,"forwardRef")&&t.d(r,{forwardRef:function(){return C.forwardRef}});var w=t(60706);t.o(w,"forwardRef")&&t.d(r,{forwardRef:function(){return w.forwardRef}});var g=t(9735);t.o(g,"forwardRef")&&t.d(r,{forwardRef:function(){return g.forwardRef}});var b=t(73814);t.o(b,"forwardRef")&&t.d(r,{forwardRef:function(){return b.forwardRef}});var v=t(85542);t.o(v,"forwardRef")&&t.d(r,{forwardRef:function(){return v.forwardRef}});var R=t(4543);t.o(R,"forwardRef")&&t.d(r,{forwardRef:function(){return R.forwardRef}});var j=t(28405);t.o(j,"forwardRef")&&t.d(r,{forwardRef:function(){return j.forwardRef}});var y=t(22888);t.o(y,"forwardRef")&&t.d(r,{forwardRef:function(){return y.forwardRef}});var S=t(62946);t.o(S,"forwardRef")&&t.d(r,{forwardRef:function(){return S.forwardRef}});var k=t(4254);t.o(k,"forwardRef")&&t.d(r,{forwardRef:function(){return k.forwardRef}});var I=t(55158);t.o(I,"forwardRef")&&t.d(r,{forwardRef:function(){return I.forwardRef}});var T=t(53030);t.o(T,"forwardRef")&&t.d(r,{forwardRef:function(){return T.forwardRef}});var M=t(53481);t.o(M,"forwardRef")&&t.d(r,{forwardRef:function(){return M.forwardRef}});var z=t(53333);t.o(z,"forwardRef")&&t.d(r,{forwardRef:function(){return z.forwardRef}});var F=t(73115);t.o(F,"forwardRef")&&t.d(r,{forwardRef:function(){return F.forwardRef}});var V=t(71069);t.o(V,"forwardRef")&&t.d(r,{forwardRef:function(){return V.forwardRef}});var H=t(85170);t.o(H,"forwardRef")&&t.d(r,{forwardRef:function(){return H.forwardRef}});var D=t(55212);t.o(D,"forwardRef")&&t.d(r,{forwardRef:function(){return D.forwardRef}});var E=t(96074);t.o(E,"forwardRef")&&t.d(r,{forwardRef:function(){return E.forwardRef}});var P=t(75148);t.o(P,"forwardRef")&&t.d(r,{forwardRef:function(){return P.forwardRef}});var L=t(16121)},7193:function(){},26216:function(){},71247:function(){},93765:function(){},62031:function(){},77192:function(){},93542:function(){},75149:function(){},54586:function(){},21776:function(){},21295:function(){},61714:function(){},44939:function(){},71292:function(){},27567:function(){},60706:function(){},9735:function(){},73814:function(){},85542:function(){},4543:function(){},28405:function(){},22888:function(){},62946:function(){},4254:function(){},55158:function(){},53030:function(){},53481:function(){},53333:function(){},73115:function(){},71069:function(){},85170:function(){},55212:function(){},96074:function(){},75148:function(){},16121:function(e,r,t){"use strict";t.d(r,{forwardRef:function(){return n.G}});var n=t(68973)},11593:function(e,r,t){"use strict";t.d(r,{Gi:function(){return u},WF:function(){return c},hE:function(){return d},pA:function(){return f}});var n=t(71632),o=t(29827),a=t(21770),i=t(718),s=t(63649),l=t(33458);let d=e=>{let{getConversationById:r}=(0,i.c)();return(0,n.a)({queryKey:s.S.conversation(null!=e?e:""),queryFn:async()=>{if(!e)return null;let t=await r(e);return null!=t?t:null},enabled:!!e})},c=e=>{let{getConversations:r}=(0,i.c)();return(0,n.a)({queryKey:s.S.conversations(e),queryFn:()=>r(e),enabled:!!e})},u=()=>{let e=(0,o.NL)();return(0,a.D)({mutationFn:e=>l.db.conversations.put(e,e.id),onSuccess:async(r,t)=>{await e.invalidateQueries({queryKey:s.S.conversations(t.ownerId)})}})},f=()=>{let e=(0,o.NL)();return(0,a.D)({mutationFn:e=>l.db.conversations.update(e.id,e),onMutate:async e=>l.db.conversations.get(e.id),onSuccess:async(r,t,n)=>{await e.invalidateQueries({queryKey:s.S.conversation(t.id)}),n&&await e.invalidateQueries({queryKey:s.S.conversations(n.ownerId)})}})}}}]);
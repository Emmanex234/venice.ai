!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0cd476d0-0d38-4b6b-8196-3520c9d7be01",e._sentryDebugIdIdentifier="sentry-dbid-0cd476d0-0d38-4b6b-8196-3520c9d7be01")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[283],{69367:function(e,t,s){Promise.resolve().then(s.bind(s,82434)),Promise.resolve().then(s.bind(s,19987)),Promise.resolve().then(s.bind(s,32156)),Promise.resolve().then(s.bind(s,4772)),Promise.resolve().then(s.bind(s,17231)),Promise.resolve().then(s.bind(s,80022)),Promise.resolve().then(s.bind(s,39054)),Promise.resolve().then(s.bind(s,15899)),Promise.resolve().then(s.bind(s,99047)),Promise.resolve().then(s.bind(s,23690))},82434:function(e,t,s){"use strict";s.d(t,{ChatProviders:function(){return y}});var i=s(57437),n=s(13449),r=s(4360),a=s(13701),o=s(22048),l=s(42586),c=s(2265),d=s(25774),u=s(10187),h=s(25315),p=s(64214),g=s(41528),x=s(38236),m=s(13823),f=s(5207),j=s(43159),v=s(33458),b=s(56967),S=s(93369);function y(e){let{children:t}=e,s=(0,l.useTranslations)("dbClosed"),{fetchSettings:y}=(0,S.F)(),w=(0,d.Sz)(j.St,e=>e.id),k=(0,d.Sz)(j.St,e=>e.isSignedIn),[C,z]=(0,c.useState)(v.db.hasClosed);return((0,c.useEffect)(()=>{y(w)},[y,w]),(0,c.useEffect)(()=>{b.B.setState({isSignedIn:k})},[k]),(0,c.useEffect)(()=>v.db.onHasClosedChange(z),[]),(0,c.useEffect)(()=>{C&&o.uT("Database closed")},[C]),C)?(0,i.jsx)(u.default,{children:(0,i.jsxs)(n.k,{gap:3,flexDir:"column",alignItems:"center",children:[(0,i.jsx)(r.x,{children:s("title")}),(0,i.jsx)(a.z,{colorScheme:"blue",size:"sm",onClick:()=>window&&window.location.reload(),children:s("reload")})]})}):(0,i.jsx)(g.T,{children:(0,i.jsx)(p.i5,{children:(0,i.jsx)(m.BG,{children:(0,i.jsx)(h.K1,{children:(0,i.jsx)(f.lZ,{children:(0,i.jsx)(x.W,{children:t})})})})})})}},4271:function(e,t,s){"use strict";s.d(t,{W:function(){return d}});var i=s(57437),n=s(61507),r=s(13449),a=s(34442),o=s(13701),l=s(47749),c=s(49089);let d=e=>{let{cancel:t,cancelTitle:s,description:d,progress:u}=e;return(0,i.jsx)(n.b,{status:"info",variant:"solid",borderRadius:"lg",gap:3,width:{base:"300px",md:"400px"},children:(0,i.jsxs)(r.k,{gap:{base:3},flexDir:{base:"column"},width:"100%",children:[(0,i.jsxs)(r.k,{gap:{base:3},flexDir:{base:"row"},alignItems:{md:"center"},children:[(0,i.jsx)(c.DUB,{}),(0,i.jsx)(a.X,{flex:1,letterSpacing:"0.02em",children:d}),(0,i.jsx)(o.z,{colorScheme:"blue",size:"sm",onClick:t,isDisabled:100===u||void 0===t,children:s})]}),(0,i.jsx)(l.E,{value:u,colorScheme:"primary",borderRadius:"full"})]})})}},19987:function(e,t,s){"use strict";s.r(t),s.d(t,{CharacterModal:function(){return e2}});var i=s(57437),n=s(52710),r=s(78796),a=s(86827),o=s(31631),l=s(4360),c=s(47749),d=s(70185),u=s(3137),h=s(50017),p=s(83657),g=s(13449),x=s(10883),m=s(32191),f=s(13701),j=s(20517),v=s(19383),b=s(48860),S=s(34096),y=s(5095),w=s(99376),k=s(42586),C=s(2265),z=s(29501),I=s(45168),R=s(25774),T=s(52347),M=s(86537),P=s(72246),E=s(99047),D=s(59989),F=s(28082);function A(e){let{children:t,onRemove:s,tagLabelProps:n,tagCloseButtonProps:r,...a}=e,o=null==r?void 0:r.onClick,l=(0,C.useCallback)(e=>{null==o||o(e),e.isDefaultPrevented()||null==s||s(e)},[s,o]);return(0,i.jsxs)(F.Vp,{...a,children:[(0,i.jsx)(F.Sn,{...n,children:t}),(0,i.jsx)(F.SD,{...r,onClick:l})]})}function L(e){for(var t=arguments.length,s=Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];return"function"==typeof e?e(...s):e}var K=(0,C.forwardRef)(function(e,t){let{tags:s=[],onTagsChange:n,onTagAdd:r,onTagRemove:a,addKeys:o=[" "],wrapProps:l,wrapItemProps:c,tagProps:d,tagLabelProps:u,tagCloseButtonProps:h,...p}=e,g=(0,C.useCallback)((e,t)=>{null==r||r(e,t),e.isDefaultPrevented()||null==n||n(e,s.concat([t]))},[s,n,r]),m=(0,C.useCallback)((e,t)=>{null==a||a(e,t),e.isDefaultPrevented()||null==n||n(e,[...s.slice(0,t),...s.slice(t+1)])},[s,n,a]),f=(0,C.useCallback)(e=>t=>{m(t,e)},[m]),j=p.onKeyDown,v=(0,C.useCallback)(e=>{if(null==j||j(e),e.isDefaultPrevented()||e.isPropagationStopped())return;let{currentTarget:t,key:i}=e,{selectionStart:n,selectionEnd:r}=t;o.indexOf(i)>-1&&t.value?(g(e,t.value),e.isDefaultPrevented()||(t.value=""),e.preventDefault()):"Backspace"===i&&s.length>0&&0===n&&0===r&&m(e,s.length-1)},[o,s.length,g,m,j]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.I,{variant:"filled",mb:4,...p,onKeyDown:v,ref:t}),(0,i.jsx)(D.E,{align:"center",...l,children:null==s?void 0:s.map((e,t)=>(0,C.createElement)(D.U,{...L(c,!1,t),key:t},(0,i.jsx)(A,{onRemove:f(t),tagLabelProps:L(u,e,t),tagCloseButtonProps:L(h,e,t),colorScheme:p.colorScheme,size:p.size,...L(d,e,t),children:"#".concat(e)})))})]})}),O=s(22122),N=s(87179),B=s(61507),W=s(6314),U=s(32817),H=s(34442),X=s(90593),Z=s(22053),q=s(44321),_=s(7414),V=s(43159),G=s(51138),Q=s(18254);let J=e=>{let{value:t,onChange:s,isDisabled:n}=e,r=(0,k.useTranslations)(),a=(0,R.Sz)(V.St,e=>e.isProUser),o=(0,R.Sz)(V.St,e=>e.isVeniceStaff),l=(0,C.useCallback)(e=>{let[,t]=e.split(":");s(t)},[s]),c=(0,C.useMemo)(()=>{let e=(0,G.Do)(Q.i.Text,{inActive:!1,isProUser:a,isVeniceStaff:o});return a?e.filter(e=>!e.freeOnly):e},[a,o]),d=(0,C.useMemo)(()=>c.find(e=>e.id===t),[c,t]);return(0,i.jsx)(_.X,{heading:r("modelSelector.selectedModel"),rowProps:{px:0},children:(0,i.jsx)(q.h,{options:c,conversationType:Q.i.Text,value:"".concat(Q.i.Text,":").concat(t),onChange:l,isDisabled:n,as:f.z,iconSpacing:1,rightIcon:(0,i.jsx)(X.v,{}),children:(0,i.jsx)(Z.xu,{textOverflow:"ellipsis",overflow:"hidden",maxWidth:{base:"150px",md:"300px"},children:null==d?void 0:d.friendly_name})})})};var Y=s(45008),$=s(57806),ee=s(3146),et=s(95171),es=s(40748),ei=s(34394),en=s(41425),er=e=>{let{children:t,name:s,label:n,labelRight:r,labelProps:a,helperText:o,helperTextProps:l,errorMessageProps:c,tooltip:d,...u}=e,{control:h}=(0,z.Gc)(),{fieldState:{error:p}}=(0,z.bc)({name:s,control:h});return(0,i.jsxs)(et.NI,{isInvalid:!!p,...u,children:[n&&"string"==typeof n?(0,i.jsxs)(es.l,{htmlFor:s,fontSize:"sm",display:"flex",gap:1,alignItems:"center",...a,children:[n," ",d&&(0,i.jsx)(en.x,{label:d,children:(0,i.jsx)(Z.xu,{as:"span",color:"text.subtle",fontSize:"md",children:(0,i.jsx)(I.Qoz,{})})}),r]}):n,t,p&&(0,i.jsx)(ei.J1,{...c,children:p.message}),o&&"string"==typeof o?(0,i.jsx)(et.Q6,{...l,children:o}):o]})};function ea(){let e=(0,Y._)(["\n        .chakra-form__label {\n          margin-bottom: 0;\n        }\n        .chakra-switch {\n          display: flex;\n          align-items: center;\n        }\n        .chakra-form__error-message {\n          margin-top: 0;\n        }\n      "]);return ea=function(){return e},e}let eo=e=>{let{name:t,label:s,switchProps:n,...r}=e,{control:a,register:o}=(0,z.Gc)(),{fieldState:{error:l}}=(0,z.bc)({name:t,control:a});return(0,i.jsx)(Z.xu,{css:(0,ee.iv)(ea()),children:(0,i.jsx)(er,{name:t,label:s,as:g.k,alignItems:"center",...r,children:(0,i.jsx)($.r,{id:t,isInvalid:!!l,...n,...o(t)})})})};eo.displayName="SwitchControl";var el=s(48149),ec=s(75519),ed=s(7717),eu=s(3490),eh=s(8554),ep=s(81613);let eg={PENDING:{color:"yellow.500",switchColor:"yellow.800"},APPROVED:{color:"green.500",switchColor:"green.400"},REJECTED:{color:"red.500",switchColor:"red.400"}},ex=()=>{let{control:e,trigger:t,watch:s,formState:{isDirty:n}}=(0,z.Gc)(),r=(0,k.useTranslations)("characterModal.settings"),a=(0,R.Sz)(V.St,e=>e.isProUser),o=s("isPublic"),l=s("publicId"),{data:c}=(0,eh.fL)(l),d=l&&n?ep.wR.PENDING:null==c?void 0:c.status,u=(0,z.bc)({name:"textSettings.model.id",control:e,defaultValue:G.bN.id}),h=(0,z.bc)({name:"textSettings.advancedSettings.temperature",control:e,defaultValue:eu.Js}),g=(0,z.bc)({name:"textSettings.advancedSettings.topP",control:e,defaultValue:eu.jv}),[x]=(0,z.qo)({control:e,name:["textSettings.advancedSettings.active"]}),m=(0,C.useCallback)(e=>{u.field.onChange(e),t("context")},[u.field,t]),f=(0,C.useCallback)(e=>{h.field.onChange(e)},[h.field]),j=(0,C.useCallback)(e=>{g.field.onChange(e)},[g.field]),v=(0,C.useMemo)(()=>{switch(d){case ep.wR.PENDING:return r("status.pending");case ep.wR.APPROVED:return r("status.approved");case ep.wR.REJECTED:return r("status.rejected");default:return r("status.pending")}},[d,r]);return(0,i.jsxs)(p.K,{children:[(0,i.jsxs)(p.K,{position:"relative",children:[(0,i.jsx)(eo,{tooltip:r("tooltip.publicTooltip"),name:"isPublic",label:r("fields.public"),justifyContent:"space-between",isDisabled:!a,pb:4,sx:{"[data-checked]":{"&.chakra-switch__track":{backgroundColor:d?eg[d].switchColor:eg.PENDING.switchColor}}}}),o&&(0,i.jsxs)(B.b,{status:d===ep.wR.APPROVED?"success":d===ep.wR.REJECTED?"error":"warning",size:"sm",borderRadius:"md",children:[(0,i.jsx)(W.z,{}),(0,i.jsx)(U.C,{children:v}),(null==c?void 0:c.rejectionReason)&&(0,i.jsx)(H.X,{children:c.rejectionReason})]})]}),(0,i.jsx)(eo,{name:"webEnabled",tooltip:r("tooltip.webEnabled"),label:r("fields.webEnabled"),justifyContent:"space-between",py:4}),(0,i.jsx)(ed.Z,{title:"Model",containerProps:{bg:"transparent"},flexProps:{px:0},children:(0,i.jsx)(J,{value:u.field.value,onChange:m})}),(0,i.jsxs)(ed.Z,{title:r("fields.advancedSettings"),rightComponent:(0,i.jsx)(eo,{name:"textSettings.advancedSettings.active"}),containerProps:{bg:"transparent"},flexProps:{px:0},children:[(0,i.jsx)(el.P,{value:h.field.value,onChange:f,isDisabled:!x,rowProps:{px:0}}),(0,i.jsx)(ec.y,{value:g.field.value,onChange:j,isDisabled:!x,rowProps:{px:0}})]})]})};var em=s(68686),ef=s(37354),ej=s(6924),ev=s(72760),eb=s(25730),eS=s(7276),ey=s(31223);let ew={boxShadow:"0 0 0 5px #000"},ek={boxShadow:"0 0 0 5px var(--primary)"},eC=()=>{var e;let t=(0,k.useTranslations)("characterModal.context"),{control:s,getValues:n,trigger:r}=(0,z.Gc)(),o=G.bN.id,[d,u]=(0,z.qo)({control:s,name:["textSettings.model.active","textSettings.model.id"]}),h=(0,C.useMemo)(()=>d&&u?u:o,[u,o,d]),g=(0,G.Ho)(h),x=(0,z.bc)({name:"context",control:s,rules:{validate:e=>{let t=n(),s=o;if(t.textSettings.model.active){var i;s=null!==(i=t.textSettings.model.id)&&void 0!==i?i:o}let r=(0,G.Ho)(s),a=(null!=e?e:[]).reduce((e,t)=>e+t.tokens,0),l=(0,G.Pd)(r);if(Number(a)>l){let e=Math.round(Number(a)/l*100);return"Context is ".concat(e,"% over the token limit. Try replacing the attached file(s) with smaller excerpts.")}return!0},deps:["textSettings.model.active","textSettings.model.id"]}}),m=(0,C.useCallback)(e=>{x.field.onChange(e)},[x.field]),{uploadFiles:f,totalTokens:j,files:v,removeFile:b,error:S}=(0,ey.g)({setFiles:m,initialFiles:null!==(e=x.field.value)&&void 0!==e?e:[]}),y=(0,C.useCallback)((e,t)=>{t&&t.stopPropagation(),f(e)},[f]),{getRootProps:w,getInputProps:R,isFocused:T,isDragAccept:M,open:P}=(0,eS.uI)({accept:{"application/pdf":[],"text/*":[]},maxSize:10485760,noClick:!0,noKeyboard:!0,onDropAccepted:y}),E=(0,C.useMemo)(()=>({...T?ew:{},...M?ek:{}}),[T,M]);return(0,C.useEffect)(()=>{r("context")},[d,r]),(0,i.jsxs)(p.K,{mt:4,children:[(0,i.jsxs)(a.M,{width:"full",py:6,px:6,borderWidth:1,borderColor:"border.base",borderStyle:"dashed",borderRadius:"xl",flexDir:"column",...w({style:E}),children:[(0,i.jsx)(a.M,{boxSize:10,bg:"background.button.secondary.base",borderRadius:"lg",children:(0,i.jsx)(I.S7E,{})}),(0,i.jsxs)(p.K,{spacing:0,textAlign:"center",mt:2,children:[(0,i.jsxs)(l.x,{fontSize:"sm",color:"text.subtle",fontWeight:"medium",children:[(0,i.jsx)(em.r,{color:"text.link",onClick:P,children:t("cta")})," ",t("cta2")]}),(0,i.jsx)(l.x,{fontSize:"xs",color:"text.subtle",fontWeight:"medium",children:t("fileLimits")})]}),(0,i.jsx)("input",{name:"context",...R()})]}),(0,i.jsxs)(p.K,{minWidth:0,width:"full",children:[(0,i.jsx)(_.X,{heading:t("fields.maxContentLength"),tooltipBody:t("tooltip.maxContentLengthTooltip"),rowProps:{px:0},children:(0,i.jsx)(l.x,{children:new Intl.NumberFormat().format(Number((0,G.Pd)(g)))})}),(0,i.jsx)(c.E,{value:j/(0,G.Pd)(g)*100,borderRadius:"full",height:"2"}),x.formState.errors.context&&(0,i.jsxs)(B.b,{status:"error",size:"sm",borderRadius:"lg",children:[(0,i.jsx)(W.z,{}),(0,i.jsx)(H.X,{fontSize:"sm",lineHeight:"normal",children:x.formState.errors.context.message})]}),S&&(0,i.jsxs)(B.b,{status:"error",size:"sm",borderRadius:"lg",children:[(0,i.jsx)(W.z,{}),(0,i.jsx)(H.X,{fontSize:"sm",lineHeight:"normal",children:S})]}),v.map(e=>(0,i.jsx)(ef.Z,{overflow:"hidden",width:"full",children:(0,i.jsxs)(ej.e,{display:"flex",flexDir:"row",gap:4,alignItems:"center",minWidth:0,children:[(0,i.jsx)(a.M,{boxSize:10,bg:"background.button.secondary.base",borderRadius:"lg",flexShrink:0,children:e.isLoading?(0,i.jsx)(ev.$,{}):(0,i.jsx)(I.S7E,{})}),(0,i.jsxs)(p.K,{spacing:0,minWidth:0,width:"full",overflow:"hidden",children:[(0,i.jsx)(l.x,{width:"full",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:e.fileName}),(0,i.jsx)(l.x,{minWidth:0,overflow:"hidden",color:"text.subtle",children:e.tokens})]}),(0,i.jsx)(eb.h,{flexShrink:0,ml:"auto","aria-label":"Remove",icon:(0,i.jsx)(I.EF5,{}),onClick:()=>b(e.id)})]})},e.id))]})]})};var ez=s(16654);let eI=e=>{let{icon:t,hasError:s,children:n}=e;return(0,i.jsxs)(ez.O,{gap:1,px:3,py:2,fontSize:"sm",fontWeight:"medium",justifyContent:"flex-start",color:s?"text.error":"text.subtle",sx:{svg:{width:"20px",height:"20px"}},_selected:{bg:"background.button.secondary.base",color:s?"text.error":"var(--primary)",borderColor:s?"text.error":"var(--primary)"},children:[s?(0,i.jsx)(I.HtX,{}):t,n]})};var eR=s(65373),eT=s(32230),eM=s(86333),eP=s(77951),eE=s(46402),eD=s(67467),eF=s(8958);let eA=e=>{var t;let{name:s,onGenerate:n,isGenerateLoading:r}=e,a=(0,k.useTranslations)("characterModal"),{control:o,watch:l}=(0,z.Gc)(),{field:c}=(0,z.bc)({name:s,control:o}),[d,u]=(0,C.useState)(!1),h=l("instructions"),p=l("name"),m=d||r,f=(0,C.useCallback)(()=>{if(!c.value)return;let e=(p||"character").toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,""),t="".concat(e,".png"),s=(0,eF.v)(c.value,t,"image/png");if(s){let e=URL.createObjectURL(s),i=document.createElement("a");i.href=e,i.download=t,i.click(),URL.revokeObjectURL(e)}},[p,c.value]);return(0,i.jsxs)(g.k,{gap:2,alignItems:"center",flexDir:{base:"row",md:"column"},position:"relative",children:[(0,i.jsx)(x.I,{type:"file",onChange:e=>{var t;let s=null===(t=e.currentTarget.files)||void 0===t?void 0:t[0];if(s){u(!0);let e=new FileReader;e.onloadend=()=>{let t=e.result;c.onChange(t),u(!1)},e.readAsDataURL(s)}},accept:"image/png, image/jpeg, image/jpeg, image/webp",hidden:!0,id:"file-upload"}),(0,i.jsxs)(g.k,{position:"relative",children:[m&&(0,i.jsx)(eR.D,{size:"2rem",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",trackColor:"whiteAlpha.200",zIndex:2,isIndeterminate:!0}),(0,i.jsx)(eT.q,{boxSize:"12rem",fontSize:"6rem",borderRadius:"xl",color:"text.subtle",ignoreFallback:!0,opacity:m?.5:1,src:null!==(t=c.value)&&void 0!==t?t:"",icon:(0,i.jsx)(I.msJ,{}),as:"label",htmlFor:"file-upload",cursor:"pointer",borderWidth:1,borderColor:"border.input",bg:"background.input.base"}),(0,i.jsxs)(eM.v,{children:[(0,i.jsx)(eP.j,{as:eb.h,"aria-label":"Image options",icon:(0,i.jsx)(I.ZIz,{}),variant:"solid",size:"sm",position:"absolute",isRound:!0,bottom:-2,right:-2,bg:"black",_hover:{bg:"black"},fontSize:"xl",color:"white"}),(0,i.jsxs)(eE.q,{children:[(0,i.jsx)(eD.s,{icon:(0,i.jsx)(I.T8D,{size:"1rem"}),onClick:n,isDisabled:!h,closeOnSelect:!0,children:a("generatePhoto")}),(0,i.jsx)(eD.s,{as:"label",htmlFor:"file-upload",icon:(0,i.jsx)(I.S7F,{size:"1rem"}),closeOnSelect:!0,cursor:"pointer",children:a("uploadPhoto")}),(0,i.jsx)(eD.s,{icon:(0,i.jsx)(I.HXz,{size:"1rem"}),onClick:f,isDisabled:!c.value,closeOnSelect:!0,children:a("downloadPhoto")})]})]})]})]})};var eL=s(59745);let eK=e=>{let{defaultDuration:t=6e3}=e,s=(0,C.useMemo)(()=>t/1e3+2,[t]),n=(0,C.useMemo)(()=>{let e=s/1.5>10?5:s/1.5;return{hidden:{pathLength:0,opacity:0},visible:()=>({pathLength:1,opacity:1,transition:{pathLength:{delay:e,type:"spring",duration:2,bounce:0},opacity:{delay:e,duration:2}}})}},[s]),r=(0,C.useMemo)(()=>({hidden:{pathLength:0},visible:()=>({pathLength:1,transition:{pathLength:{type:"spring",duration:s>10?10:s,bounce:0,repeat:1/0,repeatDelay:s}}})}),[s]);return(0,i.jsxs)(eL.E.svg,{fill:"none",stroke:"var(--primary)",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",viewBox:"0 0 24 24",initial:"hidden",animate:"visible",strokeWidth:1.5,children:[(0,i.jsx)(eL.E.path,{d:"M14 3v4a1 1 0 0 0 1 1h4",variants:r}),(0,i.jsx)(eL.E.path,{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",variants:r}),(0,i.jsx)(eL.E.path,{d:"M9 9l1 0",variants:n}),(0,i.jsx)(eL.E.path,{d:"M9 13l6 0",variants:n}),(0,i.jsx)(eL.E.path,{d:"M9 17l6 0",variants:n})]})},eO=e=>{let{isDisabled:t,onGenerate:s}=e,n=(0,k.useTranslations)("characterModal"),{control:r,watch:a}=(0,z.Gc)(),{formState:o,field:{onChange:l,value:c}}=(0,z.bc)({name:"instructions",control:r}),d=a("name"),u=a("description");return(0,i.jsx)(er,{label:n("fields.instructions"),name:"instructions",isInvalid:!!o.errors.instructions,isDisabled:t,labelProps:{mr:0},labelRight:(0,i.jsx)(O.u,{label:n("tooltip.generateInstructionsTooltip"),children:(0,i.jsx)(eb.h,{"aria-label":"Auto-Generate Instructions",icon:(0,i.jsx)(I.T8D,{}),variant:"ghost",ml:"auto",onClick:s,isDisabled:!d||!u,isLoading:t})}),children:(0,i.jsx)(m.g,{minHeight:300,variant:"filled",id:"instructions",placeholder:n("placeholders.instructions"),value:c,onChange:l})})};var eN=s(96490);let eB={height:"32px"},eW=e=>{let{onGenerateInstructions:t,isGenerating:s}=e,n=(0,k.useTranslations)("characterModal"),r=(0,z.Gc)(),{control:a}=(0,z.Gc)(),o=(0,z.qo)({control:a,name:"useCustomSystemPrompt"}),l=(0,C.useCallback)(async()=>{r.setValue("useCustomSystemPrompt",!o),r.setValue("customSystemPrompt",o?"":eN.Gm.characterTemplate,{shouldDirty:!0,shouldTouch:!0,shouldValidate:!0}),await r.trigger("customSystemPrompt")},[r,o]);return(0,i.jsxs)(p.K,{spacing:6,children:[(0,i.jsx)(er,{label:n("fields.introStatement"),name:"intro",pt:0,tooltip:n("tooltip.introTooltip"),labelProps:eB,isInvalid:!!r.formState.errors.intro,children:(0,i.jsx)(x.I,{variant:"filled",id:"introStatement",...r.register("intro")})}),(0,i.jsx)(eO,{isDisabled:s,onGenerate:t}),o?(0,i.jsxs)(p.K,{spacing:4,children:[(0,i.jsxs)(er,{label:n("fields.customSystemPrompt"),name:"customSystemPrompt",tooltip:n("tooltip.systemPromptHelp"),isInvalid:!!r.formState.errors.customSystemPrompt,children:[(0,i.jsx)(m.g,{minHeight:150,variant:"filled",id:"customSystemPrompt",...r.register("customSystemPrompt")}),(0,i.jsx)(et.Q6,{children:n("helperText.systemPromptGuidelines")})]}),(0,i.jsx)(f.z,{fontSize:"sm",size:"md",onClick:l,leftIcon:(0,i.jsx)(I.lhV,{}),colorScheme:"red",variant:"ghost",children:n("cta.removeCustomSystemPrompt")})]}):(0,i.jsx)(f.z,{size:"md",fontSize:"sm",onClick:l,leftIcon:(0,i.jsx)(I.rIf,{}),children:n("cta.addCustomSystemPrompt")})]})},eU=e=>{let{defaultDuration:t=6e3}=e,s=(0,C.useMemo)(()=>t/1e3+2,[t]),n=(0,C.useMemo)(()=>{let e=s/1.5>10?5:s/1.5;return{hidden:{pathLength:0,opacity:0},visible:()=>({pathLength:1,opacity:1,transition:{pathLength:{delay:e,type:"spring",duration:2,bounce:0},opacity:{delay:e,duration:2}}})}},[s]),r=(0,C.useMemo)(()=>({hidden:{pathLength:0},visible:()=>({pathLength:1,transition:{pathLength:{type:"spring",duration:s>10?10:s,bounce:0,repeat:1/0,repeatDelay:s}}})}),[s]);return(0,i.jsxs)(eL.E.svg,{fill:"none",stroke:"var(--primary)",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",viewBox:"0 0 24 24",initial:"hidden",animate:"visible",strokeWidth:1.5,children:[(0,i.jsx)(eL.E.path,{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",variants:r}),(0,i.jsx)(eL.E.path,{d:"M12 10m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",variants:n}),(0,i.jsx)(eL.E.path,{d:"M6.168 18.849a4 4 0 0 1 3.832 -2.849h4a4 4 0 0 1 3.834 2.855",variants:n})]})};var eH=s(21770),eX=s(51868),eZ=s(79482),eq=s(47887),e_=s(3240),eV=s(48728),eG=s(3809);let eQ=()=>{let e=(0,r.p)(),t=(0,k.useTranslations)();return(0,eH.D)({mutationFn:async e=>{var t;let{name:s,description:i}=e,n={requestId:(0,eZ.LJ)(),modelId:G.bO.id,prompt:[{role:"user",content:"Create a thorough role-playing background and instructions for a character named ".concat(s," based on this description: ").concat(i)}],systemPrompt:"",webEnabled:!1,seed:Date.now(),conversationType:Q.i.Text,topP:null!==(t=eG.Bj.topP)&&void 0!==t?t:eu.Ht},r=await (0,eX.Q)({type:eq.BY.Text,modelPostBody:n});if(!r.ok){if(503===r.status)throw Error("capacityLimit");if(429===r.status)throw Error("Rate limited");throw Error("Error generating instructions")}return r},onError:s=>{let i=t("characterModal.statusMessages.autoGenError"),n="";switch(s.message){case"Request timed out":n=t("characterModal.statusMessages.requestTimedOut");break;case"capacityLimit":n=t("characterModal.statusMessages.capacityLimit");break;case"Rate limited":n=t("characterModal.statusMessages.rateLimited",{type:"Chat"});break;default:n=s.message}e({title:i,description:n,status:"error",duration:5e3,isClosable:!0})},onSuccess:async(t,s)=>{let{onChange:i}=s;if(null===t.body){e({title:"Error generating instructions",description:"Received an empty response from the server.",status:"error",duration:5e3,isClosable:!0});return}let n="";try{await (0,eV.z)(t.body,e=>{"content"===e.kind&&(n+=e.content)}),i(n)}catch(t){console.error("Error consuming chat response stream:",t),e({title:"Error processing response",description:"An error occurred while processing the server response.",status:"error",duration:5e3,isClosable:!0})}}})},eJ=()=>{let e=(0,r.p)(),t=(0,k.useTranslations)();return(0,eH.D)({mutationFn:async e=>{var t;let{description:s}=e,i=null===(t=(0,G.mg)({modelType:eq.BY.Image,trait:eq.gO.HighestQuality}))||void 0===t?void 0:t.id,n={aspectRatio:eG.vr,steps:30,cfgScale:5,negativePrompt:"",safeVenice:!0,stylePreset:"",isHighRes:!1,loraStrength:75,requestId:(0,eZ.LJ)(),modelId:null!=i?i:G.HX.id,seed:Math.floor(1e8*Math.random()),width:512,height:512,prompt:"Create a headshot profile photo for the following character: ".concat(s),hideWatermark:!0},r=await (0,eX.Q)({type:eq.BY.Image,modelPostBody:n});if(!r.ok){if(503===r.status)throw Error("capacityLimit");if(429===r.status)throw Error("Rate limited");throw Error("Error generating photo")}return r},onError:s=>{let i=t("characterModal.statusMessages.autoGenError"),n="";switch(s.message){case"Request timed out":n=t("characterModal.statusMessages.requestTimedOut");break;case"capacityLimit":n=t("characterModal.statusMessages.capacityLimit");break;case"Rate limited":n=t("characterModal.statusMessages.rateLimited",{type:"Image"});break;default:n=s.message}e({title:i,description:n,status:"error",duration:5e3,isClosable:!0})},onSuccess:async(e,t)=>{let{onChange:s}=t,i=await e.arrayBuffer(),n=(0,e_.s)(i);s("data:image/png;base64,".concat(n))}})};var eY=s(41528),e$=s(93020);let e0={height:"32px"},e1=e=>(0,i.jsx)(n.x,{px:{base:4,md:6},py:{base:4,md:6},minWidth:0,maxWidth:"100%",overflow:"hidden",...e}),e2=()=>{var e;let t=(0,k.useTranslations)("characterModal"),[s,n]=(0,C.useState)(!1),{isOpen:D,onClose:F,data:A}=(0,eY.R)("character"),{mutateAsync:L}=(0,eh.TJ)(),{mutateAsync:B}=(0,eh.X4)(),{mutateAsync:W}=(0,eh.y6)(),{mutateAsync:U}=(0,eh.Jn)(),H=(0,r.p)(),X=(0,w.useRouter)(),Z=(0,R.Sz)(V.St,e=>e.id),{data:q,status:_}=(0,eh.sF)(null!==(e=null==A?void 0:A.characterId)&&void 0!==e?e:""),{mutateAsync:Q,status:J,isError:Y}=eQ(),{mutateAsync:$,status:ee,isError:et}=eJ(),es=(0,C.useMemo)(()=>({name:"",description:"",instructions:"",photo:"",intro:"",isPublic:!1,webEnabled:!1,overrideSystemPrompts:!1,useCustomSystemPrompt:!1,customSystemPrompt:"",context:[],tags:[],textSettings:{model:{active:!0,id:G.bN.id},advancedSettings:{active:!1,temperature:void 0,topP:void 0}}}),[]),ei=(0,z.cI)({defaultValues:es,mode:"onChange"}),{formState:{errors:en,isDirty:ea,isValid:eo}}=ei,el=(0,C.useMemo)(()=>!eo||!ea&&!(null==A?void 0:A.isDuplicating),[eo,ea,null==A?void 0:A.isDuplicating]),ec=ei.watch("name"),ed=ei.watch("description"),eu=ei.watch("instructions"),ep=(0,C.useMemo)(()=>et||Y?(n(!1),!1):"pending"===ee||"pending"===J||void 0,[J,Y,et,ee]),eg=(0,C.useMemo)(()=>"success"===J&&"success"===ee?100:"success"===J&&"pending"===ee?75:"success"===J?50:25,[J,ee]),{field:{onChange:em}}=(0,z.bc)({name:"instructions",control:ei.control}),{field:{onChange:ef}}=(0,z.bc)({name:"photo",control:ei.control}),{field:{onChange:ej,value:ev}}=(0,z.bc)({name:"tags",control:ei.control}),eb=(0,C.useCallback)(async e=>{let s={...e};try{if(!q||(null==A?void 0:A.isDuplicating)||(null==q?void 0:q.isImported)){let t=(0,eZ.LJ)();s={...e,ownerId:Z,id:t,isImported:!1}}if(!s.isPublic&&s.publicId)try{await U(s.publicId)}catch(e){}finally{s={...s,publicId:void 0}}if(s.isPublic&&!s.publicId)try{let e=await B(s);s={...s,publicId:e}}catch(e){H({status:"error",title:t("statusMessages.errorTitle"),description:t("statusMessages.errorDescription"),position:"top-right"}),s={...s,publicId:void 0,isPublic:!1}}if(s.isPublic&&s.publicId)try{await W(s)}catch(e){try{let e=await B(s);s={...s,publicId:e}}catch(e){H({status:"error",title:t("statusMessages.errorTitle"),description:t("statusMessages.errorDescription"),position:"top-right"}),s={...s,publicId:void 0,isPublic:!1}}}await L(s),ei.reset(es),H({status:"success",title:!q||(null==A?void 0:A.isDuplicating)?t("statusMessages.characterCreated"):t((null==q?void 0:q.isImported)?"statusMessages.characterImported":"statusMessages.characterUpdated"),description:!q||(null==A?void 0:A.isDuplicating)?t("statusMessages.characterCreatedDescription"):t((null==q?void 0:q.isImported)?"statusMessages.characterImportedDescription":"statusMessages.characterUpdatedDescription",{name:q.name}),position:"top-right"}),F(),((null==q?void 0:q.isImported)||(null==A?void 0:A.isDuplicating))&&X.push("/character-chat/".concat(s.id))}catch(e){H({status:"error",title:t("statusMessages.errorTitle"),description:t("statusMessages.errorDescription"),position:"top-right"})}},[q,null==A?void 0:A.isDuplicating,Z,L,ei,es,H,t,F,W,U,B,X]),eS=(0,C.useCallback)(()=>{ei.reset(),F()},[ei,F]),ey=(0,C.useCallback)(async()=>{await Q({name:ec,description:ed,onChange:em})},[ed,Q,ec,em]),ew=(0,C.useCallback)(async()=>{await $({description:eu,onChange:ef})},[$,eu,ef]),ek=(0,C.useCallback)(async()=>{n(!0),await Q({name:ec,description:ed,onChange:em});let e=ei.getValues("instructions");if(!e){H({status:"error",description:t("statusMessages.autoGenFailed")}),n(!1);return}await $({description:e,onChange:ef}),n(!1)},[ed,Q,$,ei,ec,em,ef,t,H]),ez=(0,C.useMemo)(()=>"pending"===_&&(null==A?void 0:A.characterId)?(0,i.jsx)(E.LoadingSpinnerPage,{minHeight:"300px"}):ep&&s?(0,i.jsx)(N.K,{children:(0,i.jsxs)(a.M,{minHeight:"350px",flexDir:"column",gap:4,py:12,children:[(0,i.jsx)(a.M,{fontSize:"6rem",children:"pending"===J?(0,i.jsx)(eK,{defaultDuration:2e3}):(0,i.jsx)(eU,{defaultDuration:2e3})}),(0,i.jsx)(o.X,{size:"md",children:t("pending"===J?"generating.instructions.title":"generating.photo.title")}),(0,i.jsx)(l.x,{maxWidth:"350px",mx:"auto",textAlign:"center",color:"text.subtle",children:t("pending"===J?"generating.instructions.body":"generating.photo.body")}),(0,i.jsx)(c.E,{width:"100%",maxWidth:"300px",borderRadius:"full",colorScheme:"primary",size:"sm",hasStripe:!0,isAnimated:!0,mt:6,value:eg,sx:{"& > div:first-child":{transitionProperty:"width"}}})]})},"generating"):(0,i.jsxs)(N.K,{children:[(0,i.jsxs)(M.fK,{borderBottomWidth:1,borderColor:"border.base",py:4,px:{base:4,md:6},minHeight:"auto",children:[(0,i.jsx)(M.fK.Left,{children:(0,i.jsx)(P.$,{children:q?t("dialogTitles.updateCharacter"):t("dialogTitles.createCharacter")})}),(0,i.jsx)(M.fK.Right,{children:(0,i.jsx)(T.i,{onClick:F})})]}),(0,i.jsx)(z.RV,{...ei,children:(0,i.jsxs)("form",{onSubmit:(0,e$.I)(ei.handleSubmit(eb)),children:[(0,i.jsxs)(d.m,{isLazy:!0,display:"flex",flexDir:{base:"column",md:"row"},variant:"pill",children:[(0,i.jsxs)(u.t,{px:4,py:4,gap:{base:0,md:4},borderColor:"border.base",flexDir:{base:"row",md:"column"},bg:"transparent",borderRadius:"none",borderBottomWidth:0,width:"full",maxWidth:{base:"full",md:"200px"},overflowY:"auto",flexShrink:0,children:[(0,i.jsx)(eI,{icon:(0,i.jsx)(I.Kam,{}),children:t("tabs.general")}),(0,i.jsx)(eI,{icon:(0,i.jsx)(I.YsT,{}),children:t("tabs.instructions")}),(0,i.jsx)(eI,{hasError:!!en.context,icon:(0,i.jsx)(I.S7E,{}),children:t("tabs.context")}),(0,i.jsx)(eI,{icon:(0,i.jsx)(I.sDK,{}),children:t("tabs.settings")})]}),(0,i.jsxs)(h.n,{overflow:"hidden",children:[(0,i.jsx)(e1,{children:(0,i.jsxs)(p.K,{spacing:6,children:[(0,i.jsx)(g.k,{gap:6,flexDir:{base:"column-reverse",md:"row"},children:(0,i.jsxs)(p.K,{spacing:4,flex:1,children:[(0,i.jsx)(eA,{name:"photo",onGenerate:ew,isGenerateLoading:"pending"===ee}),(0,i.jsx)(er,{label:t("fields.name"),labelProps:e0,name:"name",tooltip:t("tooltip.nameTooltip"),isInvalid:!!ei.formState.errors.name,children:(0,i.jsx)(x.I,{variant:"filled",id:"name",...ei.register("name",{required:t("fields.nameRequired")})})}),(0,i.jsx)(er,{label:t("fields.description"),tooltip:t("tooltip.descriptionTooltip"),labelProps:e0,name:"description",isInvalid:!!ei.formState.errors.description,children:(0,i.jsx)(m.g,{variant:"filled",id:"description",...ei.register("description")})}),(0,i.jsx)(O.u,{label:t("tooltip.generate"),children:(0,i.jsx)(f.z,{onClick:ek,isLoading:s,leftIcon:(0,i.jsx)(I.T8D,{}),mt:"auto",isDisabled:!ec||!ed||ep,children:t("cta.autoGenerate")})})]})}),(0,i.jsx)(er,{label:"Tags",name:"tags",children:(0,i.jsx)(K,{tags:ev,onTagsChange:(e,t)=>{Array.isArray(t)&&ej(t)}})})]})}),(0,i.jsx)(e1,{children:(0,i.jsx)(eW,{onGenerateInstructions:ey,isGenerating:"pending"===J})}),(0,i.jsxs)(e1,{children:[(0,i.jsxs)(p.K,{spacing:2,children:[(0,i.jsx)(o.X,{size:"sm",children:t("context.uploadContext")}),(0,i.jsx)(l.x,{color:"text.subtle",fontSize:"sm",children:t("context.contextInfo")})]}),(0,i.jsx)(eC,{})]}),(0,i.jsx)(e1,{children:(0,i.jsx)(ex,{})})]})]}),(0,i.jsxs)(j.m,{gap:2,justifyContent:"space-between",px:{base:4,md:6},children:[(0,i.jsx)(f.z,{variant:"outline",onClick:eS,children:t("cta.cancel")}),(0,i.jsx)(f.z,{type:"submit",colorScheme:"primary",isDisabled:el,isLoading:ei.formState.isSubmitting,children:t("cta.save")})]})]})})]},"form"),[null==A?void 0:A.characterId,ed,en.context,q,eS,ek,ey,ew,J,s,ep,el,ei,ec,F,eb,ej,ee,_,eg,t,ev]);return(0,C.useEffect)(()=>{if(q&&"success"===_){let e={...q};((null==A?void 0:A.isDuplicating)||q.isImported)&&(e={...e,name:"".concat(q.name," (Copy)")}),ei.reset(e)}else ei.reset(es)},[null==A?void 0:A.isDuplicating,es,q,ei,_]),(0,i.jsxs)(v.u_,{isOpen:D,onClose:eS,size:"2xl",children:[(0,i.jsx)(b.Z,{}),(0,i.jsx)(S.h,{children:(0,i.jsx)(y.M,{mode:"wait",initial:!1,children:ez})})]})}},39054:function(e,t,s){"use strict";s.d(t,{ChatLoading:function(){return a}});var i=s(57437),n=s(29575),r=s(13823);let a=e=>{let{children:t}=e,{state:{chatReady:s}}=(0,r.IO)();return s?(0,i.jsx)(i.Fragment,{children:t}):(0,i.jsx)(n.i,{})}},29575:function(e,t,s){"use strict";s.d(t,{i:function(){return u}});var i=s(57437),n=s(83657),r=s(4360),a=s(47749),o=s(42586),l=s(2265),c=s(10187),d=s(33458);let u=e=>{let{altLogo:t}=e,s=(0,o.useTranslations)(),[u,h]=(0,l.useState)(d.db.status),[p,g]=(0,l.useState)(d.db.migrationState),[x,m]=(0,l.useState)(!1);return(0,l.useEffect)(()=>d.db.onStatusChange(h),[]),(0,l.useEffect)(()=>d.db.onMigrationStateChange(g),[]),(0,l.useEffect)(()=>{let e=setTimeout(()=>m(!0),3e3);return()=>clearTimeout(e)},[]),(0,i.jsx)(c.default,{altLogo:t,children:x&&(0,i.jsxs)(n.K,{alignItems:"center",gap:4,children:[(0,i.jsx)(r.x,{children:(()=>{switch(u){case"loading":return s("chatLoading.loading");case"blocked":return s("chatLoading.refresh");default:return}})()}),p.running&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.x,{children:s("chatLoading.migration",{version:p.version})}),(0,i.jsx)(a.E,{value:p.progress,colorScheme:"primary",borderRadius:"full",width:"100%"})]})]})})}},34261:function(e,t,s){"use strict";s.d(t,{M:function(){return r},U:function(){return a}});var i=s(57437),n=s(87032);s(2265);let r=e=>(0,i.jsx)(n.Ms,{bg:"background.button.primary.base",...e}),a=e=>(0,i.jsx)(n.Uj,{bg:"background.button.secondary.base",...e})},15899:function(e,t,s){"use strict";s.r(t),s.d(t,{ImageDetailsDrawer:function(){return D}});var i=s(57437),n=s(41214),r=s(48860),a=s(36165),o=s(27924),l=s(16152),c=s(83657),d=s(91092),u=s(31631),h=s(4360),p=s(25730),g=s(20517),x=s(13701),m=s(42586),f=s(2265),j=s(45168),v=s(86799),b=s(99047),S=s(7414),y=s(13449),w=s(1914);let k=e=>{if(0===e||!e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][t]},C=e=>{let{message:t}=e,{isCopied:s,copyToClipboard:n}=(0,w.m)({timeout:2e3}),r=(0,f.useMemo)(()=>{if(null==t?void 0:t.contentBinary)return new Blob([t.contentBinary]).size},[null==t?void 0:t.contentBinary]),a=(0,f.useCallback)(()=>{n(t.content)},[n,t.content]);return(0,i.jsxs)(S.X,{layout:"stacked",stackProps:{gap:2},rowProps:{px:0},children:[t.content&&(0,i.jsxs)(y.k,{alignItems:"center",gap:2,children:[(0,i.jsx)(h.x,{fontSize:"lg",children:t.content}),(0,i.jsx)(p.h,{"aria-label":"copy prompt",fontSize:"lg",variant:"ghost",float:"right",onClick:a,icon:s?(0,i.jsx)(j.e6w,{}):(0,i.jsx)(j.muo,{})})]}),(0,i.jsx)(h.x,{color:"text.subtle",fontSize:"sm",children:k(r)})]})};var z=s(33145),I=s(6960);let R=e=>{var t,s;let{message:n}=e,{data:r}=(0,I.q7)(n);return r?(0,i.jsx)(z.default,{src:r,alt:"Generated Image","data-testid":"imageMessage","data-imageid":n.id,width:null===(t=n.imageSettings)||void 0===t?void 0:t.width,height:null===(s=n.imageSettings)||void 0===s?void 0:s.height,loading:"lazy"}):null};var T=s(41528),M=s(51138),P=s(93369);let E=e=>{var t,s,n,r,a,o,y,k,z,E,D,F,A,L;let{messageId:K}=e,O=(0,m.useTranslations)("imageSettings"),{onClose:N}=(0,T.R)("imageDetails"),{data:B,status:W}=(0,I.A3)(K),{copyToClipboard:U,isCopied:H}=(0,w.m)({timeout:2e3}),X=(0,P.F)(e=>e.saveImageSettings),Z=(0,P.F)(e=>e.saveImageModel),q=(0,f.useMemo)(()=>{if(B)return(0,M.Ho)(null==B?void 0:B.modelId)},[B]),_=(0,f.useCallback)(()=>{X({...P.F.getState().settings.imageSettings,...null==B?void 0:B.imageSettings}),q&&Z(q.id),N()},[null==B?void 0:B.imageSettings,q,N,Z,X]),V=(0,f.useCallback)(()=>{(null==B?void 0:B.seed)&&U(B.seed.toString())},[U,null==B?void 0:B.seed]);return"pending"===W?(0,i.jsx)(b.LoadingSpinnerPage,{}):B?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.f,{p:0,children:[(0,i.jsx)(R,{message:B}),(0,i.jsxs)(c.K,{px:6,children:[(0,i.jsx)(C,{message:B}),(0,i.jsxs)(c.K,{divider:(0,i.jsx)(d.c,{borderColor:"border.base"}),spacing:0,children:[(0,i.jsx)(u.X,{size:"sm",py:4,children:O("prompt.information.title")}),(0,i.jsx)(S.X,{heading:"Model",icon:(0,i.jsx)(j.Kam,{}),rowProps:{px:0},children:(0,i.jsx)(h.x,{fontSize:"sm",children:null==q?void 0:q.friendly_name})}),(0,i.jsxs)(S.X,{heading:O("prompt.imageSettings.advancedSettings.seed.title"),icon:(0,i.jsx)(j.BvO,{}),rowProps:{px:0},stackProps:{alignItems:"center",gap:2},children:[(0,i.jsx)(h.x,{fontSize:"sm",children:null!==(L=null==B?void 0:B.seed)&&void 0!==L?L:"-"}),(0,i.jsx)(p.h,{icon:H?(0,i.jsx)(j.e6w,{}):(0,i.jsx)(j.muo,{}),"aria-label":"Copy seed",variant:"ghost",fontSize:"lg",onClick:V})]}),(0,i.jsx)(S.X,{heading:O("prompt.dimensions.title"),icon:(0,i.jsx)(j.Tb1,{}),rowProps:{px:0},children:(0,i.jsxs)(h.x,{fontSize:"sm",children:[null===(t=B.imageSettings)||void 0===t?void 0:t.width,"x",null===(s=B.imageSettings)||void 0===s?void 0:s.height," (",null===(n=B.imageSettings)||void 0===n?void 0:n.aspectRatio,")"]})}),(0,i.jsx)(S.X,{heading:O("prompt.imageStyle.title"),icon:(0,i.jsx)(j.gpo,{}),rowProps:{px:0},children:(0,i.jsx)(h.x,{fontSize:"sm",children:(null===(r=B.imageSettings)||void 0===r?void 0:r.stylePreset)===""?"None":null===(a=B.imageSettings)||void 0===a?void 0:a.stylePreset})}),(0,i.jsx)(S.X,{heading:O("prompt.adherence.title"),icon:(0,i.jsx)(j.QeJ,{}),rowProps:{px:0},children:(0,i.jsx)(h.x,{fontSize:"sm",children:(0,v.k6)(null===(o=B.imageSettings)||void 0===o?void 0:o.cfgScale)})}),(0,i.jsx)(S.X,{heading:O("prompt.negativePrompt.title"),icon:(0,i.jsx)(j.n$O,{}),rowProps:{px:0},children:(0,i.jsx)(h.x,{fontSize:"sm",children:(null===(y=B.imageSettings)||void 0===y?void 0:y.negativePrompt)===""?"None":null===(k=B.imageSettings)||void 0===k?void 0:k.negativePrompt})}),(0,i.jsx)(S.X,{heading:O("prompt.imageSettings.advancedSettings.steps.title"),icon:(0,i.jsx)(j.lpy,{}),rowProps:{px:0},children:(0,i.jsx)(h.x,{fontSize:"sm",children:null===(z=B.imageSettings)||void 0===z?void 0:z.steps})}),(0,i.jsx)(S.X,{heading:O("prompt.imageSettings.advancedSettings.loraStrength.title"),icon:(0,i.jsx)(j.PgF,{}),rowProps:{px:0},children:(0,i.jsx)(h.x,{fontSize:"sm",children:null===(E=B.imageSettings)||void 0===E?void 0:E.loraStrength})}),(0,i.jsx)(S.X,{heading:O("prompt.imageSettings.safeVenice.title"),icon:(0,i.jsx)(j.wQf,{}),rowProps:{px:0},children:(0,i.jsx)(h.x,{fontSize:"sm",children:(null===(D=B.imageSettings)||void 0===D?void 0:D.safeVenice)?"On":"Off"})}),(0,i.jsx)(S.X,{heading:O("prompt.imageSettings.hideWatermark.title"),icon:(0,i.jsx)(j.ddB,{}),rowProps:{px:0},children:(0,i.jsx)(h.x,{fontSize:"sm",children:(null===(F=B.imageSettings)||void 0===F?void 0:F.hideWatermark)?"On":"Off"})}),(0,i.jsx)(S.X,{heading:O("prompt.imageSettings.imageToImageStrength.title"),icon:(0,i.jsx)(j.AWB,{}),rowProps:{px:0},children:(0,i.jsx)(h.x,{fontSize:"sm",children:null===(A=B.imageSettings)||void 0===A?void 0:A.imageToImageStrength})})]})]})]}),(0,i.jsx)(g.m,{py:6,gap:4,children:(0,i.jsx)(x.z,{colorScheme:"primary",width:"full",onClick:_,children:O("useSettings.cta")})})]}):(0,i.jsx)(i.Fragment,{})},D=()=>{let{isOpen:e,onClose:t,data:s}=(0,T.R)("imageDetails"),l=null==s?void 0:s.messageId;return(0,i.jsxs)(n.d,{isOpen:e,onClose:t,size:"sm",children:[(0,i.jsx)(r.Z,{}),(0,i.jsxs)(a.s,{children:[(0,i.jsx)(o.o,{mt:"env(safe-area-inset-top)"}),l&&(0,i.jsx)(E,{messageId:l})]})]})}},99047:function(e,t,s){"use strict";s.d(t,{LoadingSpinnerPage:function(){return a}});var i=s(57437),n=s(86827),r=s(72760);let a=e=>(0,i.jsx)(n.M,{height:"100%",width:"100%",...e,children:(0,i.jsx)(r.$,{size:"xl",thickness:"6px",color:"var(--muted)"})})},41425:function(e,t,s){"use strict";s.d(t,{x:function(){return o}});var i=s(57437),n=s(22053),r=s(2265),a=s(22122);let o=e=>{let{children:t,...s}=e,[o,l]=(0,r.useState)(!1),{isDisabled:c}=s;return(0,i.jsx)(a.u,{isOpen:o,isDisabled:c,...s,children:(0,i.jsx)(n.xu,{...c?{}:{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onClick:()=>l(!0)},children:t})})}},47672:function(e,t,s){"use strict";s.d(t,{M:function(){return b}});var i=s(57437),n=s(44167),r=s(71416),a=s(78796),o=s(86333),l=s(77951),c=s(85330),d=s(46402),u=s(67467),h=s(22053),p=s(99376),g=s(42586),x=s(2265),m=s(45168),f=s(41528),j=s(13823),v=s(8554);let b=(0,n.forwardRef)((e,t)=>{let{characterId:s,hideNewChat:n,...b}=e,{isOpen:S,onClose:y,onOpen:w}=(0,r.q)(),k=(0,g.useTranslations)(),{onOpen:C}=(0,f.R)("character"),z=(0,a.p)(),I=(0,p.useRouter)(),{data:R}=(0,v.sF)(s),{mutateAsync:T}=(0,v.Js)(),{mutateAsync:M}=(0,v.Jn)(),{handleDeleteFolder:P,state:{folders:E}}=(0,j.IO)(),D=(0,x.useCallback)(e=>{e.stopPropagation(),s&&I.push("/character-chat/".concat(s))},[s,I]),F=(0,x.useCallback)(e=>{e.stopPropagation(),s&&C({characterId:s,isEditing:!0})},[C,s]),A=(0,x.useCallback)(e=>{e.stopPropagation(),s&&C({characterId:s,isDuplicating:!0})},[C,s]),L=(0,x.useCallback)(async e=>{if(e.stopPropagation(),s&&window.confirm("Are you sure you want to delete this character?")){var t;await T(s);let e=null===(t=E.find(e=>e.characterId===s))||void 0===t?void 0:t.id;if(e&&await P(e),(null==R?void 0:R.isPublic)&&(null==R?void 0:R.publicId))try{await M(R.publicId)}catch(e){}z({status:"success",title:"Character deleted",description:"Character has been deleted",position:"top-right"})}},[s,T,E,null==R?void 0:R.isPublic,null==R?void 0:R.publicId,z,P,M]),K=(0,x.useCallback)(e=>{e.stopPropagation(),w()},[w]);return(0,i.jsxs)(o.v,{isOpen:S,onClose:y,children:[(0,i.jsx)(l.j,{onClick:K,size:"sm",fontSize:{base:"sm",md:"lg"},ref:t,...b}),(0,i.jsx)(c.h,{children:(0,i.jsxs)(d.q,{position:"absolute",zIndex:1500,children:[!n&&(0,i.jsxs)(u.s,{onClick:D,gap:2,children:[(0,i.jsx)(h.xu,{as:"span",fontSize:"lg",children:(0,i.jsx)(m.dKc,{})}),k("characterMenu.newChat")]}),(0,i.jsxs)(u.s,{onClick:F,gap:2,children:[(0,i.jsx)(h.xu,{as:"span",fontSize:"lg",children:(0,i.jsx)(m.Lik,{})}),k("characterMenu.editCharacter")]}),(0,i.jsxs)(u.s,{onClick:A,gap:2,children:[(0,i.jsx)(h.xu,{as:"span",fontSize:"lg",children:(0,i.jsx)(m.muo,{})}),k("characterMenu.duplicateCharacter")]}),(0,i.jsxs)(u.s,{onClick:L,gap:2,children:[(0,i.jsx)(h.xu,{as:"span",fontSize:"lg",children:(0,i.jsx)(m.EF5,{})}),k("characterMenu.deleteCharacter")]})]})})]})})},32156:function(e,t,s){"use strict";s.d(t,{ChatInterfaceWrapper:function(){return b}});var i=s(57437),n=s(30166),r=s(2265),a=s(19383),o=s(48860),l=s(34096),c=s(49270),d=s(86827),u=s(16152),h=s(4360),p=s(68686),g=s(97048),x=s(74468),m=s(74386);let f=e=>{let{incompatibilityError:t}=e;return(0,r.useEffect)(()=>{(0,x.Qe)({name:"incompatibleModalTriggered",data:{userAgent:navigator.userAgent,incompatibilityError:t}})},[t]),(0,i.jsxs)(a.u_,{size:{base:"full",md:"lg"},isCentered:!0,isOpen:!0,onClose:()=>{},"data-testid":"incompatibleModal",children:[(0,i.jsx)(o.Z,{}),(0,i.jsxs)(l.h,{children:[(0,i.jsxs)(c.x,{children:[(0,i.jsx)(d.M,{children:(0,i.jsx)(m.K,{mt:"20px",mb:"40px",boxSize:{base:"80px",md:"130px"}})}),"Your browser is causing drama..."]}),(0,i.jsxs)(u.f,{pb:8,children:[(0,i.jsxs)(h.x,{mb:8,children:["noIndexDB"===t&&"Local storage is not supported by your browser version. ","browserBlocked"===t&&"Access to local storage has been blocked by your privacy settings. ","Venice's privacy architecture requires local storage to function properly and securely."]}),(0,i.jsx)(h.x,{mb:8,children:"We recommend using a browser that supports local encrypted storage, such as the latest versions of Brave, Chrome, Firefox, Edge, or Safari."}),g.gn&&(0,i.jsx)(h.x,{mb:8,children:'Please note that "Lockdown Mode" on iOS will also block access to local storage and prevent Venice from working.'}),(0,i.jsxs)(h.x,{mb:8,children:["Please reach out to us via"," ",(0,i.jsx)(p.r,{href:"mailto: admin@venice.ai",textDecoration:"underline",children:"email"})," ","or"," ",(0,i.jsx)(p.r,{href:"https://twitter.com/askvenice",textDecoration:"underline",children:"Twitter"})," ","for additional support or if you are using a supported browser but still experiencing this issue."]}),(0,i.jsxs)(h.x,{children:["Lean more about"," ",(0,i.jsx)(p.r,{href:"/blog/venice-ai-privacy-architecture",textDecoration:"underline",children:"Venice's privacy architecture here."})]})]})]})]})},j=(0,n.default)(()=>s.e(4845).then(s.bind(s,74845)),{loadableGenerated:{webpack:()=>[74845]},ssr:!1}),v=(0,n.default)(()=>Promise.all([s.e(6051),s.e(5706),s.e(8715)]).then(s.bind(s,78715)).then(e=>e.PwaInstall),{loadableGenerated:{webpack:()=>[78715]},ssr:!1}),b=e=>{let{children:t}=e,[s,n]=(0,r.useState)(!1),[a,o]=(0,r.useState)("");return((0,r.useEffect)(()=>{"indexedDB"in window||(o("noIndexDB"),n(!0));try{window.localStorage.getItem("securityProbe")}catch(e){("SecurityError"===e.name||"DatabaseClosedError"===e.name)&&(o("browserBlocked"),n(!0))}},[]),s)?(0,i.jsx)(f,{incompatibilityError:a}):(0,i.jsxs)(i.Fragment,{children:[t,(0,i.jsx)(j,{}),(0,i.jsx)(v,{})]})}},4772:function(e,t,s){"use strict";s.r(t),s.d(t,{ChatSettingsDrawer:function(){return tn}});var i=s(57437),n=s(16654),r=s(41214),a=s(48860),o=s(36165),l=s(49270),c=s(31631),d=s(27924),u=s(70185),h=s(3137),p=s(42586),g=s(2265),x=s(45168),m=s(22122),f=s(14123),j=s(16152),v=s(57806),b=s(4964),S=s(13701),y=s(74468),w=s(90593),k=s(86333),C=s(77951),z=s(13449),I=s(22053),R=s(46402),T=s(43753),M=s(11843);let P=Object.freeze({af:"ZA",agq:"CM",ak:"GH",am:"ET",ar:"AE",as:"IN",asa:"TZ",az:"AZ",bas:"CM",be:"BY",bem:"ZM",bez:"IT",bg:"BG",bm:"ML",bn:"BD",bo:"CN",br:"FR",brx:"IN",bs:"BA",ca:"ES",cgg:"UG",chr:"US",cs:"CZ",cy:"GB",da:"DK",dav:"KE",de:"DE",dje:"NE",dua:"CM",dyo:"SN",ebu:"KE",ee:"GH",en:"GB",el:"GR",es:"ES",et:"EE",eu:"EU",ewo:"CM",fa:"IR",fil:"PH",fr:"FR",ga:"IE",gl:"ES",gsw:"CH",gu:"IN",guz:"KE",gv:"GB",ha:"NG",haw:"US",he:"IL",hi:"IN",ff:"CN",fi:"FI",fo:"FO",hr:"HR",hu:"HU",hy:"AM",id:"ID",ig:"NG",ii:"CN",is:"IS",it:"IT",ja:"JP",jmc:"TZ",ka:"GE",kab:"DZ",ki:"KE",kam:"KE",mer:"KE",kde:"TZ",kea:"CV",khq:"ML",kk:"KZ",kl:"GL",kln:"KE",km:"KH",kn:"IN",ko:"KR",kok:"IN",ksb:"TZ",ksf:"CM",kw:"GB",lag:"TZ",lg:"UG",ln:"CG",lt:"LT",lu:"CD",lv:"LV",luo:"KE",luy:"KE",mas:"TZ",mfe:"MU",mg:"MG",mgh:"MZ",ml:"IN",mk:"MK",mr:"IN",ms:"MY",mt:"MT",mua:"CM",my:"MM",naq:"NA",nb:"NO",nd:"ZW",ne:"NP",nl:"NL",nmg:"CM",nn:"NO",nus:"SD",nyn:"UG",om:"ET",or:"IN",pa:"PK",pl:"PL",ps:"AF",pt:"PT",rm:"CH",rn:"BI",ro:"RO",ru:"RU",rw:"RW",rof:"TZ",rwk:"TZ",saq:"KE",sbp:"TZ",seh:"MZ",ses:"ML",sg:"CF",shi:"MA",si:"LK",sk:"SK",sl:"SI",sn:"ZW",so:"SO",sq:"AL",sr:"RS",sv:"SE",sw:"TZ",swc:"CD",ta:"IN",te:"IN",teo:"UG",th:"TH",ti:"ER",to:"TO",tr:"TR",twq:"NE",tzm:"MA",uk:"UA",ur:"PK",uz:"UZ",vai:"LR",vi:"VN",vun:"TZ",xog:"UG",yav:"CM",yo:"NG",zh:"CN",zu:"ZA"}),E=e=>{if(!e)return null;let t=P[e]||null;return t?String.fromCodePoint(...t.toUpperCase().split("").map(e=>127397+e.charCodeAt(0))):null};var D=s(3490);let F=e=>{let{defaultValue:t,buttonProps:s,showLanguage:n}=e,r=(0,p.useTranslations)("localeSwitcher"),a=(0,g.useCallback)(async e=>{"string"==typeof e&&(await fetch("/api/user/locale?locale=".concat(e)),window.location.reload())},[]);return(0,i.jsxs)(k.v,{children:[(0,i.jsx)(C.j,{as:S.z,rightIcon:(0,i.jsx)(w.v,{}),...s,children:(0,i.jsxs)(z.k,{alignItems:"center",gap:2,children:[(0,i.jsx)(I.xu,{as:"span",lineHeight:1,fontSize:"lg",children:E(t)}),!!n&&r(t)]})}),(0,i.jsx)(R.q,{width:"full",p:2,children:(0,i.jsx)(T._,{title:r("label"),defaultValue:t,onChange:a,type:"radio",children:D.lE.map(e=>(0,i.jsx)(M.i,{value:e,width:"full",mx:0,children:(0,i.jsxs)(z.k,{alignItems:"center",gap:2,children:[(0,i.jsx)(I.xu,{as:"span",lineHeight:1,mt:1,fontSize:"lg",children:E(e)}),r(e)]})},e))})})]})},A=e=>{let{buttonProps:t,showLanguage:s}=e,n=(0,p.useLocale)();return(0,i.jsx)(F,{defaultValue:n,buttonProps:t,showLanguage:s})};var L=s(7717),K=s(7414),O=s(25730),N=s(25774),B=s(41425),W=s(43159),U=s(79482);let H=e=>{let{onClick:t,value:s,color:n,isActive:r,isDisabled:a}=e,o=(0,g.useCallback)(()=>{t(s)},[t,s]);return(0,i.jsx)(O.h,{onClick:o,size:"xs",bg:n,isActive:r,isDisabled:a,_hover:{boxShadow:"0 0 0 4px var(--muted-foreground)"},_active:{boxShadow:"0 0 0 4px var(--foreground)"},"aria-label":"switch color"})},X=()=>{let e=(0,p.useTranslations)(),[t,s]=(0,g.useState)(null),n=(0,N.Sz)(W.St,e=>e.isMorTokenHolder);(0,g.useEffect)(()=>{let e=(0,U.EK)();e&&(s(e),document.documentElement.setAttribute("data-color",e))},[]);let r=e=>{s(e),document.documentElement.setAttribute("data-color",e),(0,U.lE)(e)};return(0,i.jsx)(K.X,{layout:"stacked",heading:e("settings.appSettings.themeColor.title"),children:(0,i.jsxs)(z.k,{gap:4,flexWrap:"wrap",justifyContent:"flex-start",children:[(0,i.jsx)(H,{onClick:r,value:"",color:"var(--color-brand)",isActive:""===t}),(0,i.jsx)(H,{onClick:r,value:"pink",color:"var(--color-pink)",isActive:"pink"===t}),(0,i.jsx)(H,{onClick:r,value:"purple",color:"var(--color-purple)",isActive:"purple"===t}),(0,i.jsx)(H,{onClick:r,value:"orange",color:"var(--color-orange)",isActive:"orange"===t}),(0,i.jsx)(H,{onClick:r,value:"violet",color:"var(--color-violet)",isActive:"violet"===t}),(0,i.jsx)(H,{onClick:r,value:"fuchsia",color:"var(--color-fuchsia)",isActive:"fuchsia"===t}),(0,i.jsx)(B.x,{label:"Morpheus theme for MOR token Pro users",isDisabled:n,children:(0,i.jsx)(H,{onClick:r,value:"mor",color:"var(--color-mor)",isDisabled:!n,isActive:"mor"===t})}),(0,i.jsx)(H,{onClick:r,value:"gray",color:"var(--color-gray)",isActive:"gray"===t})]})})};var Z=s(63724),q=s(93369),_=s(56134);let V={bg:"transparent",px:2,boxShadow:"none"},G=()=>{let e=(0,p.useTranslations)(),{colorMode:t,setColorMode:s}=(0,f.If)(),n=(0,Z.w)(),r=(0,q.F)(e=>e.saveEnterBehavior),a=(0,q.F)(e=>e.settings.enterBehavior),o=(0,q.F)(e=>e.saveInputHistoryNavigationSettings),l=(0,q.F)(e=>e.settings.inputHistoryNavigation),c=(0,g.useCallback)(e=>{s(e.target.value),(0,y.Qe)({name:"toggledColorMode",data:{mode:e.target.value}})},[s]),d=(0,g.useCallback)(()=>window&&window.location.reload(),[]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(j.f,{px:0,children:(0,i.jsxs)(L.Z,{containerProps:V,divider:(0,i.jsx)(i.Fragment,{}),children:[(0,i.jsx)(K.X,{heading:e("settings.appSettings.enterSubmitsChat.title"),tooltipBody:e("settings.appSettings.enterSubmitsChat.tooltip"),children:(0,i.jsx)(v.r,{isChecked:a===_.m.Submit,onChange:e=>{r(e.target.checked?_.m.Submit:_.m.NewLine)}})}),(0,i.jsx)(K.X,{heading:e("settings.appSettings.inputHistoryNavigation.title"),tooltipBody:e("settings.appSettings.inputHistoryNavigation.tooltip"),children:(0,i.jsx)(v.r,{isChecked:l,onChange:e=>{o(e.target.checked)}})}),(0,i.jsx)(K.X,{heading:e("settings.appSettings.colorScheme.title"),body:"",children:(0,i.jsxs)(b.P,{variant:"filled",size:"sm",value:t,onChange:c,children:[(0,i.jsx)("option",{value:"light",children:e("settings.appSettings.colorScheme.light")}),(0,i.jsx)("option",{value:"dark",children:e("settings.appSettings.colorScheme.dark")})]})}),(0,i.jsx)(X,{}),(0,i.jsx)(K.X,{heading:e("localeSwitcher.label"),layout:"stacked",body:(0,i.jsx)(A,{})}),(0,i.jsx)(K.X,{heading:e("settings.appSettings.version.title"),body:"20250129.213603",layout:"stacked",children:n&&(0,i.jsx)(S.z,{colorScheme:"primary",size:"sm",onClick:d,children:e("settings.appSettings.version.cta")})})]})})})};var Q=s(83657),J=s(91092),Y=s(4231),$=s(20517),ee=s(78796),et=s(12),es=s(57635),ei=s.n(es),en=s(64214),er=s(6960);function ea(){let e=(0,p.useTranslations)(),[t,s]=(0,g.useState)(!1),{selectedConversation:n}=(0,en.uu)(),r=(0,ee.p)(),{data:a,error:o}=(0,er.Op)((null==n?void 0:n.id)||""),l=(0,g.useCallback)(e=>{r({duration:5e3,isClosable:!0,...e})},[r]),c=(0,g.useCallback)(async()=>{if(!(null==a?void 0:a.length)){l({title:e("imageSettings.downloadAllImages.toast.noImages.title"),status:"info",duration:3e3});return}s(!0);try{let t=new(ei()),s=t.folder("images");await Promise.all(a.map(async e=>{let{id:t,imageUrl:i}=e,n=await fetch(i),r=await n.blob();null==s||s.file("image-".concat(t,".png"),r)}));let i=await t.generateAsync({type:"blob"});(0,et.saveAs)(i,e("imageSettings.downloadAllImages.zipName")+".zip"),l({title:e("imageSettings.downloadAllImages.toast.success.title"),description:e("imageSettings.downloadAllImages.toast.success.description",{count:a.length}),status:"success"})}catch(t){console.error("Error downloading images:",t),l({title:e("imageSettings.downloadAllImages.toast.error.title"),description:e("imageSettings.downloadAllImages.toast.error.description"),status:"error"})}finally{s(!1)}},[a,l,e]),d=(0,g.useMemo)(()=>t?e("imageSettings.downloadAllImages.cta.loadingText"):e("imageSettings.downloadAllImages.cta.text"),[t,e]);return o&&l({title:e("imageSettings.downloadAllImages.toast.fetchError.title"),description:e("imageSettings.downloadAllImages.toast.fetchError.description"),status:"error"}),(0,i.jsx)(m.u,{label:e("imageSettings.downloadAllImages.cta.tooltip"),children:(0,i.jsx)(S.z,{leftIcon:(0,i.jsx)(x.HXz,{}),isLoading:t,variant:"outline",onClick:c,children:d})})}var eo=s(28082),el=s(4360),ec=s(86799),ed=s(87032),eu=s(34261),eh=e=>{let{values:t,onChange:s,onChangeEnd:n,value:r,showMarks:a=!1}=e,o=g.useCallback(e=>{s(t.reduce((t,s)=>Math.abs(s-e)<Math.abs(t-e)?s:t))},[t,s]);return(0,i.jsxs)(ed.iR,{value:r,onChange:o,onChangeEnd:n,min:t[0],max:t[t.length-1],step:.1,children:[a&&t.map(e=>(0,i.jsx)(ed.jz,{value:e,top:"50%",transform:"translateY(-50%)",height:"var(--slider-thumb-size)",width:"var(--slider-thumb-size)",borderRadius:"full",_first:{ml:"-0.5rem",display:"none"},_notFirst:{ml:"-0.5rem"},_last:{ml:0,display:"none"},textAlign:"center",opacity:e===t[t.length-1]?0:1,display:"flex",alignItems:"center",justifyContent:"center",children:(0,i.jsx)(I.xu,{width:"2px",height:"10px",bg:"text.subtle",opacity:"0.5"})},e)),(0,i.jsx)(ed.Uj,{children:(0,i.jsx)(eu.M,{})}),(0,i.jsx)(ed.gs,{})]})},ep=s(51138);let eg=e=>{var t,s;if(!e)return ep.EG;let i=(0,ep.Ho)(e);return(null==i?void 0:null===(t=i.settingsOverrides)||void 0===t?void 0:t.cfgScale)?null==i?void 0:null===(s=i.settingsOverrides)||void 0===s?void 0:s.cfgScale:ep.EG},ex=()=>{let e=(0,p.useTranslations)(),t=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.cfgScale}),s=(0,q.F)(e=>e.settings.imageModel),n=(0,q.F)(e=>e.saveImageSettings),[r,a]=(0,g.useState)(t),o=(0,g.useCallback)(e=>{n({cfgScale:e})},[n]);return(0,g.useEffect)(()=>{a(t),"flux.1-dev-uncensored-akash"===s&&void 0!==t&&t<5&&(o(eg(s)[0]),a(eg(s)[0]))},[t,o,s]),(0,i.jsxs)(K.X,{layout:"stacked",heading:e("imageSettings.prompt.adherence.title"),tooltipBody:e("imageSettings.prompt.adherence.tooltip"),body:(0,i.jsx)(eo.Vp,{children:(0,ec.k6)(r)}),children:[(0,i.jsx)(eh,{values:eg(s),value:r,onChange:a,onChangeEnd:o,showMarks:!0}),(0,i.jsxs)(z.k,{width:"full",justifyContent:"space-between",color:"text.subtle",fontSize:"sm",children:[(0,i.jsx)(el.x,{children:e("imageSettings.prompt.adherence.creative")}),(0,i.jsx)(el.x,{children:e("imageSettings.prompt.adherence.strict")})]})]})};var em=s(58055),ef=s(41528);let ej=e=>{let{textProps:t,...s}=e,n=(0,p.useTranslations)(),{onOpen:r}=(0,ef.R)("upgrade");return(0,N.Sz)(W.St,e=>e.isProUser)?null:(0,i.jsx)(z.k,{...s,children:(0,i.jsxs)(el.x,{fontSize:"sm",fontWeight:"medium",color:"text.subtle",letterSpacing:"0.012em",...t,children:[n("upgradeMessage.availableFor")," ",(0,i.jsx)(S.z,{variant:"link",color:"text.link",onClick:()=>r(),children:n("upgradeMessage.cta")})]})})};var ev=s(3809);let eb={bg:"transparent",px:2,boxShadow:"none"},eS=()=>{let e=(0,p.useTranslations)(),t=(0,N.Sz)(W.St,e=>e.isProUser),s=(0,N.Sz)(W.St,e=>e.childMode),n=(0,q.F)(e=>e.saveImageSettings),r=(0,q.F)(e=>e.settings.imageModel),a=r&&(0,ep.Ho)(r),o=(null==a?void 0:a.supportsHD)!==!1,l=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.aspectRatio}),c=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.hideWatermark}),d=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.width}),u=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.height}),h=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.isHighRes})&&o,x=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.safeVenice}),m=(0,g.useCallback)(()=>{n({safeVenice:!x})},[x,n]),f=(0,g.useCallback)(()=>{n({hideWatermark:!c})},[c,n]),j=(0,g.useCallback)((e,t)=>{let s=ev.Hv[e].sizes[t&&o?"pro":"free"];n({aspectRatio:e,...s?{width:s.width,height:s.height,isConstrained:!0}:{}})},[o,n]);(0,g.useEffect)(()=>{l&&j(l,h)},[l,j,h,o]);let S=(0,g.useCallback)(e=>{j(e.target.value,h)},[j,h]),y=(0,g.useCallback)(e=>{let t=e.target.checked,s=ev.Hv[l].sizes[t?"pro":"free"];n({isHighRes:t,...s?{width:s.width,height:s.height,isConstrained:!0}:{}})},[l,n]);return(0,i.jsxs)(L.Z,{title:e("imageSettings.prompt.imageSettings.title"),containerProps:eb,divider:(0,i.jsx)(i.Fragment,{}),rightComponent:(0,i.jsx)(el.x,{fontWeight:"semibold",fontSize:"sm",color:"text.subtle",children:"".concat(d,"x").concat(u)}),children:[(0,i.jsx)(K.X,{heading:e("imageSettings.prompt.imageSettings.aspectRatio.title"),children:(0,i.jsx)(b.P,{size:"sm",variant:"filled",value:l,onChange:S,children:Object.entries(ev.Hv).map(e=>{let[t,s]=e;return(0,i.jsx)("option",{value:t,children:s.label},t)})})}),(0,i.jsx)(K.X,{heading:e("imageSettings.prompt.imageSettings.highRes.title"),tooltipBody:o?void 0:e("imageSettings.prompt.imageSettings.highRes.modelDoesNotSupportHd"),layout:"stacked",hiddenMessage:(0,i.jsx)(ej,{}),body:(0,i.jsx)(v.r,{isChecked:h,isDisabled:!o,onChange:y})}),(0,i.jsx)(K.X,{heading:e("imageSettings.prompt.imageSettings.hideWatermark.title"),layout:"stacked",tooltipBody:e("imageSettings.prompt.imageSettings.hideWatermark.tooltip"),hideChildren:!t,hiddenMessage:(0,i.jsx)(ej,{textProps:{textAlign:"right"}}),...t?{body:(0,i.jsx)(v.r,{colorScheme:"blue",isChecked:c,onChange:f})}:{}}),!s&&(0,i.jsx)(K.X,{heading:e("imageSettings.prompt.imageSettings.safeVenice.title"),layout:"stacked",tooltipBody:e("imageSettings.prompt.imageSettings.safeVenice.tooltip"),body:(0,i.jsxs)(em.U,{children:[(0,i.jsx)(ej,{textAlign:"right",textProps:{textAlign:"right"}}),(0,i.jsx)(v.r,{colorScheme:"blue",isChecked:x,isDisabled:!t,onChange:m})]})})]})},ey=()=>{let e=(0,p.useTranslations)("imageSettings.prompt.imageSettings.inpaintingBlendStrength"),t=(0,N.Sz)(W.St,e=>e.isVeniceStaff),s=(0,q.F)(e=>e.settings.imageModel),n=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.imageToImageStrength}),r=(0,q.F)(e=>e.saveImageSettings),a=[{value:0,label:e("noBlending")},{value:33,label:e("minorBlending")},{value:66,label:e("strongBlending")},{value:100,label:e("maxBlending")}],o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=a.find((t,s,i)=>e<=t.value||s===i.length-1);return null!=t?t:a[0]},l=o(n),[c,d]=(0,g.useState)(l.value);return((0,g.useEffect)(()=>{d(l.value)},[l.value]),!t||(null==s?void 0:s.toLowerCase().includes("flux")))?null:(0,i.jsxs)(K.X,{layout:"stacked",heading:e("title"),tooltipBody:e("tooltip"),body:(0,i.jsx)(eo.Vp,{whiteSpace:"nowrap",children:o(c).label}),children:[(0,i.jsx)(eh,{values:a.map(e=>e.value),value:c,onChange:e=>d(o(e).value),onChangeEnd:e=>r({imageToImageStrength:e}),showMarks:!0}),(0,i.jsxs)(z.k,{width:"full",justifyContent:"space-between",color:"text.subtle",fontSize:"sm",children:[(0,i.jsx)(el.x,{children:e("none")}),(0,i.jsx)(el.x,{children:e("max")})]})]})},ew=()=>{let e=(0,p.useTranslations)(),t=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.loraStrength}),s=(0,q.F)(e=>e.settings.imageModel),n=(0,ep.Ho)(null!=s?s:""),r=(0,q.F)(e=>e.saveImageSettings),[a,o]=(0,g.useState)(t),l=(0,g.useCallback)(e=>{r({loraStrength:e})},[r]);return((0,g.useEffect)(()=>{o(t)},[t]),(null==n?void 0:n.supportsLoras)!==!0)?null:(0,i.jsx)(K.X,{layout:"stacked",heading:e("imageSettings.prompt.imageSettings.advancedSettings.loraStrength.title"),tooltipBody:e("imageSettings.prompt.imageSettings.advancedSettings.loraStrength.tooltip"),body:(0,i.jsx)(eo.Vp,{children:a}),children:(0,i.jsx)(eh,{values:[0,25,50,75,100],value:a,onChange:o,onChangeEnd:l,showMarks:!0})})},ek=e=>{var t,s;if(!e)return ep.Uh;let i=(0,ep.Ho)(e);return(null==i?void 0:null===(t=i.settingsOverrides)||void 0===t?void 0:t.steps)?null==i?void 0:null===(s=i.settingsOverrides)||void 0===s?void 0:s.steps:ep.Uh},eC=()=>{let e=(0,p.useTranslations)(),t=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.steps}),s=(0,q.F)(e=>e.settings.imageModel),n=(0,q.F)(e=>e.saveImageSettings),[r,a]=(0,g.useState)(t),o=(0,g.useCallback)(e=>{n({steps:e})},[n]);return(0,g.useEffect)(()=>{a(t);let e=ek(s);t&&t>e.max&&(o(e.default),a(e.default))},[s,t]),(0,i.jsx)(K.X,{layout:"stacked",heading:e("imageSettings.prompt.imageSettings.advancedSettings.steps.title"),tooltipBody:"".concat(e("imageSettings.prompt.imageSettings.advancedSettings.steps.tooltip.part1")).concat(null===ev.IW||void 0===ev.IW?void 0:ev.IW.steps).concat(e("imageSettings.prompt.imageSettings.advancedSettings.steps.tooltip.part2")),body:(0,i.jsx)(eo.Vp,{children:r}),children:(0,i.jsxs)(ed.iR,{min:7,max:ek(s).max,value:r,onChangeEnd:o,onChange:a,children:[(0,i.jsx)(ed.Uj,{children:(0,i.jsx)(ed.Ms,{})}),(0,i.jsx)(ed.gs,{})]})})};var ez=s(97244),eI=s(37354),eR=s(55093),eT=s(71416),eM=s(76405),eP=s(50017),eE=s(52710),eD=s(19383),eF=s(34096),eA=s(33145);let eL=e=>(0,i.jsx)(n.O,{bg:"background.button.secondary.base",borderRadius:"full",fontSize:"sm",fontWeight:"medium",px:3,py:1,lineHeight:1,minBlockSize:8,_selected:{bg:"background.button.primary.base",color:"text.primary.base"},...e}),eK=e=>{let{preset:t}=e,[s,n]=(0,g.useState)(!1),r=(0,g.useCallback)(()=>n(!0),[]),a=t?t.toLowerCase().replace(/\s/g,"-"):"none";return(0,i.jsx)(ez.O,{isLoaded:s,children:(0,i.jsx)(eA.default,{src:ev.DY[a],alt:t,loading:"lazy",onLoad:r,width:800,height:800})})},eO=(0,g.forwardRef)((e,t)=>{let{preset:s,isActive:n,isFavorite:r,onClick:a,onFavorite:o,isDisabled:l}=e,c=(0,p.useTranslations)("imageSettings.prompt.imageStyle"),d=(0,g.useCallback)(()=>{a(s)},[a,s]),u=(0,g.useCallback)(()=>{o(s)},[o,s]);return(0,i.jsxs)(eI.Z,{bg:"transparent",cursor:"pointer",boxShadow:"none",role:"group",ref:t,children:[(0,i.jsxs)(I.xu,{bg:"background.surface.base",borderRadius:"lg",children:[s&&(0,i.jsx)(O.h,{icon:r?(0,i.jsx)(x.M9,{}):(0,i.jsx)(x.KdP,{}),"aria-label":c("favoriteThisStyle"),title:c("favoriteThisStyle"),position:"absolute",right:2,top:2,isRound:!0,boxSize:{base:6,md:8},color:r?"text.link":"text.subtle",bg:"background.surface.base",minWidth:"auto",opacity:{base:1,md:0},_groupHover:{opacity:1},boxShadow:"md",_hover:{bg:"background.surface.base",color:r?"text.link":"text.base"},fontSize:{base:"sm",md:"lg"},zIndex:"4",onClick:u}),(0,i.jsx)(eR.o,{ratio:1,onClick:d,bg:"background.surface.muted",borderWidth:3,borderColor:"transparent",_hover:{boxShadow:"0 0 0 3px var(--border-hover)"},_active:{boxShadow:"0 0 0 3px var(--primary)"},borderRadius:"lg",overflow:"hidden",transitionProperty:"common",transitionDuration:"normal",...n&&{"data-active":!0},_disabled:{opacity:.5,cursor:"not-allowed",pointerEvents:"none"},...l&&{"data-disabled":!0},children:(0,i.jsx)(eK,{preset:s})})]}),(0,i.jsx)(el.x,{textAlign:"center",fontSize:"xs",fontWeight:"medium",mt:1,children:s||"None"})]})});eO.displayName="StylePresetCard";let eN=()=>{let e=(0,p.useTranslations)(),t=(0,g.useRef)(null),s=(0,g.useRef)(null),{onToggle:n,isOpen:r,onClose:o}=(0,eT.q)(),l=(0,q.F)(e=>e.saveImageSettings),c=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.stylePreset}),d=(0,q.F)(e=>e.settings.imageModel),x=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.favoriteImageStyles}),m=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.stylesTab}),[f,j]=(0,g.useState)(!1),v=(0,g.useMemo)(()=>ev.kl.sort(),[]),b=(0,g.useMemo)(()=>{var e;let t=(0,ep.Ho)(null!=d?d:ep.HX.id);return null!==(e=null==t?void 0:t.supportsStylePresents)&&void 0!==e&&e},[d]),S=(0,g.useCallback)(e=>{l({stylePreset:e})},[l]),y=(0,g.useCallback)(e=>{let t=null!=x?x:[];l({favoriteImageStyles:t.includes(e)?t.filter(t=>t!==e):[...t,e]})},[x,l]),w=(0,g.useCallback)(e=>{l({stylesTab:e})},[l]);(0,g.useEffect)(()=>{if(t.current&&s.current){let e=t.current,i=s.current,n=e.offsetTop-i.offsetTop,r=i.clientHeight,a=e.clientHeight;i.scrollTo({top:n-r/2+a/2,behavior:"auto"})}},[t,s]);let k=(0,g.useCallback)(e=>{" "===e.key&&c&&f&&n()},[c,f,n]),C=(0,g.useMemo)(()=>(null==x?void 0:x.length)!==0&&x?(0,i.jsx)(eM.M,{maxHeight:"275px",overflowY:"auto",columns:3,gap:4,p:4,ref:s,children:x.map(e=>(0,i.jsx)(eO,{preset:e,isActive:e===c,isDisabled:!b,isFavorite:null==x?void 0:x.includes(e),onClick:S,onFavorite:y,ref:e===c?t:null},e))}):(0,i.jsx)(el.x,{color:"text.subtle",fontSize:"sm",px:4,py:2,children:e("imageSettings.prompt.imageStyle.noFavorites")}),[x,y,S,c,b,e]);return(0,g.useEffect)(()=>{let e=e=>k(e);return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[k]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(K.X,{layout:"stacked",rowProps:{p:0},children:(0,i.jsxs)(u.m,{variant:"unstyled",isLazy:!0,onChange:w,index:m,children:[(0,i.jsxs)(h.t,{px:4,gap:2,mt:4,children:[(0,i.jsx)(eL,{children:e("imageSettings.prompt.imageStyle.all")}),(0,i.jsx)(eL,{children:e("imageSettings.prompt.imageStyle.favorites")})]}),(0,i.jsxs)(eP.n,{children:[(0,i.jsx)(eE.x,{px:0,py:2,children:(0,i.jsxs)(eM.M,{maxHeight:"275px",overflowY:"auto",columns:3,gap:4,p:4,ref:s,onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),children:[(0,i.jsx)(eO,{preset:"",isDisabled:!b,isActive:void 0===c||""===c,onClick:S,onFavorite:y}),v.map(e=>(0,i.jsx)(eO,{preset:e,isActive:e===c,isDisabled:!b,isFavorite:null==x?void 0:x.includes(e),onClick:S,onFavorite:y,ref:e===c?t:null},e))]})}),(0,i.jsx)(eE.x,{px:0,py:2,children:C})]})]})}),!b&&(0,i.jsx)(K.X,{layout:"stacked",children:(0,i.jsx)(el.x,{children:e("imageSettings.prompt.imageStyle.noSupport")})}),(0,i.jsxs)(eD.u_,{isOpen:r,onClose:o,isCentered:!0,children:[(0,i.jsx)(a.Z,{sx:{outline:"none"}}),(0,i.jsx)(eF.h,{bg:"transparent",sx:{outline:"none"},maxWidth:"800px",borderWidth:0,children:c&&(0,i.jsx)(eR.o,{ratio:1,children:(0,i.jsx)(eK,{preset:c})})})]})]})};var eB=s(45197),eW=s(44321),eU=s(18254),eH=s(81613);let eX=e=>{let{conversationType:t,containerProps:s}=e,n=(0,p.useTranslations)(),r=(0,N.Sz)(W.St,e=>e.isProUser),a=(0,N.Sz)(W.St,e=>e.isVeniceStaff),o=(0,q.F)(e=>e.settings.textModel),l=(0,q.F)(e=>e.settings.imageModel),c=(0,q.F)(e=>e.settings.codeModel),d=(0,q.F)(e=>e.saveImageModel),u=(0,q.F)(e=>e.saveTextModel),h=(0,q.F)(e=>e.saveCodeModel),x=(0,N.Sz)(W.St,e=>e.issuePoints),m=(0,g.useMemo)(()=>{let e;return e=(0,ep.Do)(t,{includeRetired:!0,inActive:!1,isListed:!0,isProUser:r,isVeniceStaff:a}),r&&(e=e.filter(e=>!e.freeOnly)),e},[t,r,a]),f=(0,g.useMemo)(()=>{switch(t){case eU.i.Text:return null!=o?o:ep.bO.id;case eU.i.Code:return null!=c?c:ep.au.id;case eU.i.Image:return null!=l?l:ep.HX.id;default:return""}},[c,t,l,o]),j=(0,g.useMemo)(()=>(0,ep.Ho)(f),[f]),v=(0,g.useCallback)(e=>{let[,s]=e.split(":"),i=(0,ep.Ho)(s);if(!i)throw Error("Invalid model id");switch(t){case eU.i.Text:u(i.id);break;case eU.i.Image:d(i.id);break;case eU.i.Code:h(i.id);default:return}(0,y.Qe)({name:"changedModel",data:{conversationType:eU.i.Text,model:i}}),x(eH.mR.MODEL_SELECTION)},[t,x,h,d,u]);return(0,i.jsx)(L.Z,{title:n("modelSelector.title"),containerProps:s,children:(0,i.jsx)(K.X,{heading:n("modelSelector.selectedModel"),children:(0,i.jsx)(eW.h,{options:m,value:"".concat(t,":").concat(f),onChange:v,as:S.z,iconSpacing:1,rightIcon:(0,i.jsx)(eB.g,{}),conversationType:t,children:(0,i.jsx)(I.xu,{textOverflow:"ellipsis",overflow:"hidden",maxWidth:{base:"150px",md:"300px"},children:null==j?void 0:j.friendly_name})})})})};var eZ=s(10883),eq=s(64798),e_=s.n(eq);let eV=()=>{let e=(0,p.useTranslations)(),t=(0,N.Sz)(W.St,e=>e.isProUser),s=(0,q.F)(e=>e.settings.imageModel),n=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.negativePrompt}),r=(0,q.F)(e=>e.saveImageSettings),a=s&&(0,ep.Ho)(s),[o,l]=(0,g.useState)(n),c=(0,g.useCallback)(e=>{r({negativePrompt:e})},[r]),d=(0,g.useMemo)(()=>e_()(c,250),[c]),u=(0,g.useCallback)(e=>{l(e),d(e)},[d]),h=(0,g.useCallback)(e=>{u(e.target.value)},[u]);return(0,g.useEffect)(()=>{l(n)},[n]),(0,i.jsx)(K.X,{heading:e("imageSettings.prompt.negativePrompt.title"),layout:"stacked",tooltipBody:e((null==a?void 0:a.supportsNegativePrompts)===!1?"imageSettings.prompt.negativePrompt.disabled":"imageSettings.prompt.negativePrompt.tooltip"),hideChildren:!t,hiddenMessage:(0,i.jsx)(ej,{textProps:{textAlign:"right"}}),children:(0,i.jsx)(eZ.I,{width:"full",variant:"filled",size:"sm",placeholder:e("imageSettings.prompt.negativePrompt.placeholder"),value:o,isDisabled:!t||(null==a?void 0:a.supportsNegativePrompts)===!1,onChange:h})})},eG=()=>{let e=(0,p.useTranslations)(),t=(0,q.F)(e=>e.saveImageSettings),s=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.isCustomSeed}),n=(0,q.F)(e=>{var t;return null===(t=e.settings.imageSettings)||void 0===t?void 0:t.customSeed}),[r,a]=(0,g.useState)(n),o=(0,g.useCallback)(()=>{t({isCustomSeed:!s})},[s,t]),l=(0,g.useCallback)(e=>{let s=Math.floor(parseInt(e));s>D.XR&&(s=D.XR),s<D.Ts&&(s=D.Ts),t({customSeed:s.toString()})},[t]),c=(0,g.useMemo)(()=>e_()(l,250),[l]),d=(0,g.useCallback)(e=>{a(e),c(e)},[c]),u=(0,g.useCallback)(e=>{d(e.target.value)},[d]);return(0,g.useEffect)(()=>{a(n)},[n]),(0,i.jsx)(K.X,{layout:"stacked",heading:e("imageSettings.prompt.imageSettings.advancedSettings.seed.title"),body:(0,i.jsx)(v.r,{isChecked:s,onChange:o}),tooltipBody:e("imageSettings.prompt.imageSettings.advancedSettings.seed.tooltip"),children:(0,i.jsx)(eZ.I,{size:"sm",variant:"filled",value:r,onChange:u,isDisabled:!s,type:"number",step:"1"})})},eQ={bg:"transparent",px:2,boxShadow:"none"},eJ=()=>{let e=(0,p.useTranslations)(),t=(0,q.F)(e=>e.resetImageSettings),[s,n]=(0,g.useState)(!1),r=(0,g.useCallback)(()=>{t()},[t]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.f,{px:0,pb:4,children:(0,i.jsxs)(Q.K,{spacing:0,divider:(0,i.jsx)(J.c,{borderColor:"border.subtle"}),children:[(0,i.jsx)(eX,{conversationType:eU.i.Image,containerProps:eQ}),(0,i.jsxs)(L.Z,{title:e("imageSettings.prompt.title"),containerProps:eQ,divider:(0,i.jsx)(i.Fragment,{}),children:[(0,i.jsx)(eV,{}),(0,i.jsxs)(Q.K,{children:[(0,i.jsx)(ex,{}),(0,i.jsx)(ey,{}),(0,i.jsx)(ew,{})]})]}),(0,i.jsx)(L.Z,{title:e("imageSettings.prompt.imageStyle.title"),containerProps:eQ,children:(0,i.jsx)(eN,{})}),(0,i.jsx)(eS,{}),(0,i.jsx)(L.Z,{title:e("imageSettings.prompt.imageSettings.advancedSettings.title"),onClick:()=>n(!s),containerProps:eQ,rightComponent:(0,i.jsx)(O.h,{"aria-label":e("imageSettings.prompt.imageSettings.advancedSettings.ariaLabel"),icon:s?(0,i.jsx)(x.YeS,{}):(0,i.jsx)(x.YRR,{}),variant:"ghost",onClick:()=>n(!s)}),children:(0,i.jsx)(Y.U,{in:s,children:(0,i.jsxs)(Q.K,{children:[(0,i.jsx)(eG,{}),(0,i.jsx)(eC,{})]})})})]})}),(0,i.jsxs)($.m,{justifyContent:"space-between",px:{base:4,md:6},children:[(0,i.jsx)(S.z,{onClick:r,children:e("imageSettings.resetToDefault.cta")}),(0,i.jsx)(ea,{})]})]})};var eY=s(95171),e$=s(40748),e0=s(32191),e1=s(1914),e2=s(82129);let e4=()=>{let e=(0,p.useTranslations)(),t=(0,N.Sz)(W.St,e=>e.id),{data:s}=(0,e2.QB)(t),n=(0,e2.y$)(),r=(0,e2.sv)(),[a,o]=(0,g.useState)(!1),[l,c]=(0,g.useState)(void 0),{isCopied:d,copyToClipboard:u}=(0,e1.m)({timeout:2e3}),h=(0,g.useCallback)(async e=>await n.mutateAsync({...e,ownerId:t}),[t,n]),f=(0,g.useCallback)(()=>{c({friendlyName:"",prompt:"",active:!0}),o(!0)},[]),j=(0,g.useCallback)(t=>async()=>{!1!==confirm(e("textSettings.systemPrompt.deleteConfirmation"))&&await r.mutateAsync(t)},[r,e]),b=(0,g.useCallback)(async e=>{e&&(await h(e),c(void 0),o(!1))},[h]),y=(0,g.useCallback)(e=>{var t;let s=null===(t=e.target.attributes.getNamedItem("id"))||void 0===t?void 0:t.value,i=e.target.value;"active"===s&&(i=!(null==l?void 0:l.active)),c({...l,[s]:i})},[l]),w=()=>{c(void 0),o(!1)},k=(0,g.useCallback)(()=>{var e;d&&null!=l&&l.prompt||u(null!==(e=null==l?void 0:l.prompt)&&void 0!==e?e:"")},[u,d,l]),C=(0,g.useMemo)(()=>{if(l)return(0,i.jsxs)(Q.K,{p:4,children:[(0,i.jsxs)(el.x,{fontSize:"md",fontWeight:"semibold",mb:2,children:[l.id?e("textSettings.systemPrompt.editTitle"):e("textSettings.systemPrompt.addTitle")," ",e("textSettings.systemPrompt.title")]}),(0,i.jsxs)(Q.K,{spacing:4,children:[(0,i.jsxs)(eY.NI,{children:[(0,i.jsx)(e$.l,{fontSize:"sm",children:e("textSettings.systemPrompt.friendlyName")}),(0,i.jsx)(eZ.I,{type:"text",id:"friendlyName",value:l.friendlyName,onChange:y,isRequired:!0}),(0,i.jsx)(eY.Q6,{fontSize:"xs",children:e("textSettings.systemPrompt.helperText")})]}),(0,i.jsxs)(eY.NI,{children:[(0,i.jsx)(e$.l,{fontSize:"sm",children:e("textSettings.systemPrompt.prompt")}),(0,i.jsx)(e0.g,{value:l.prompt,id:"prompt",variant:"outline",onChange:y,isRequired:!0})]}),(0,i.jsxs)(z.k,{justifyContent:"space-between",alignItems:"center",children:[(0,i.jsxs)(z.k,{gap:2,alignItems:"center",children:[(0,i.jsx)(v.r,{id:"active",isChecked:l.active,onChange:y,isRequired:!0}),(0,i.jsx)(e$.l,{htmlFor:"active",fontSize:"sm",mb:"0",color:l.active?"text.base":"text.subtle",children:e("textSettings.systemPrompt.active")})]}),(0,i.jsxs)(z.k,{justifyContent:"right",children:[(0,i.jsx)(m.u,{label:d?e("textSettings.systemPrompt.copied"):e("textSettings.systemPrompt.copy"),children:(0,i.jsx)(O.h,{mr:2,icon:d?(0,i.jsx)(x.e6w,{}):(0,i.jsx)(x.muo,{}),"aria-label":e("textSettings.systemPrompt.copy"),fontSize:"18px",onClick:k})}),(0,i.jsx)(S.z,{mr:2,onClick:w,children:e("textSettings.systemPrompt.cancel.cta")}),(0,i.jsx)(S.z,{colorScheme:"primary",onClick:()=>b(l),children:e("textSettings.systemPrompt.save.cta")})]})]})]})]})},[y,b,k,l,d,e]),I=(0,g.useCallback)(e=>{c(e),o(!0)},[]),R=(0,g.useMemo)(()=>(null==s?void 0:s.length)?s.map(e=>(0,i.jsx)(K.X,{heading:e.friendlyName,children:(0,i.jsxs)(em.U,{spacing:2,children:[(0,i.jsx)(v.r,{id:"active",isChecked:e.active,onChange:async()=>{await b({...e,active:!e.active})},isRequired:!0}),(0,i.jsx)(O.h,{size:"sm","aria-label":"Edit",icon:(0,i.jsx)(x.Lik,{}),fontSize:"lg",onClick:()=>I(e),variant:"solid"}),(0,i.jsx)(O.h,{size:"sm","aria-label":"Delete",icon:(0,i.jsx)(x.EF5,{}),fontSize:"lg",onClick:j(e.id),variant:"solid"})]})},e.id)):(0,i.jsx)(el.x,{color:"text.subtle",p:4,fontSize:"sm",fontWeight:"medium",children:e("textSettings.systemPrompt.tooltip")}),[j,I,b,e,s]),T=(0,g.useMemo)(()=>(0,i.jsx)(S.z,{leftIcon:(0,i.jsx)(x.rIf,{}),variant:"solid",isDisabled:a,onClick:f,children:e("textSettings.systemPrompt.add.cta")}),[f,a,e]);return(0,i.jsxs)(L.Z,{title:e("textSettings.systemPrompt.title"),rightComponent:T,containerProps:{backgroundColor:"transparent",px:2,boxShadow:"none"},children:[!a&&R,a&&C]})};var e3=s(48149),e7=s(75519);let e5={bg:"transparent",px:2,boxShadow:"none"},e6=e=>{let{conversationType:t}=e,s=(0,p.useTranslations)(),[n,r]=(0,g.useState)(!1),a=(0,q.F)(e=>e.settings.textModel),o=a&&(0,ep.Ho)(a),l=(0,q.F)(e=>e.saveTextSettings),c=(0,q.F)(e=>e.resetTextSettings),d=(0,q.F)(e=>e.settings.textSettings),u=(0,g.useCallback)(e=>{l({temperature:e})},[l]),h=(0,g.useCallback)(e=>{l({topP:e})},[l]),m=(0,g.useCallback)(e=>{l({webEnabled:e.target.checked})},[l]),f=(0,g.useCallback)(()=>{c()},[c]),b=t===eU.i.Text;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.f,{px:0,children:(0,i.jsxs)(Q.K,{spacing:0,divider:(0,i.jsx)(J.c,{borderColor:"border.subtle"}),children:[(0,i.jsx)(eX,{conversationType:t,containerProps:e5}),(0,i.jsx)(e4,{}),(0,i.jsx)(L.Z,{title:s("textSettings.advancedSettings.title"),containerProps:e5,divider:(0,i.jsx)(i.Fragment,{}),onClick:()=>r(!n),rightComponent:(0,i.jsx)(O.h,{"aria-label":s("imageSettings.prompt.imageSettings.advancedSettings.ariaLabel"),icon:n?(0,i.jsx)(x.YeS,{}):(0,i.jsx)(x.YRR,{}),variant:"ghost",onClick:()=>r(!n)}),children:(0,i.jsxs)(Y.U,{in:n,children:[(0,i.jsx)(e3.P,{onChange:u,value:null==d?void 0:d.temperature}),(0,i.jsx)(e7.y,{onChange:h,value:null==d?void 0:d.topP}),(null==o?void 0:o.webEnabled)&&(0,i.jsx)(K.X,{heading:s("textSettings.advancedSettings.web.title"),layout:"stacked",tooltipBody:s(b?"textSettings.advancedSettings.web.tooltip":"textSettings.advancedSettings.web.disabled"),body:(0,i.jsx)(v.r,{colorScheme:"blue",isChecked:(null==d?void 0:d.webEnabled)!==!1,isDisabled:!b,onChange:m})})]})})]})}),(0,i.jsx)($.m,{px:{base:4,md:6},children:(0,i.jsx)(S.z,{onClick:f,children:s("textSettings.resetToDefault.cta")})})]})},e8=(0,i.jsx)(x.YsT,{size:"1rem"}),e9=(0,i.jsx)(x.msJ,{size:"1rem"}),te=(0,i.jsx)(x.ssl,{size:"1rem"}),tt=(0,i.jsx)(x.sDK,{size:"1rem"}),ts=e=>{let{icon:t,label:s,isDisabled:r}=e,a=(0,p.useTranslations)();return(0,i.jsx)(m.u,{label:a("chatSettings.tabs.tooltip.disabled"),isDisabled:!r,children:(0,i.jsxs)(n.O,{gap:2,isDisabled:r,children:[t," ",s]})})},ti={[eU.i.Text]:0,[eU.i.Image]:1,[eU.i.Code]:2,App:3},tn=()=>{let e=(0,p.useTranslations)(),{isOpen:t,onClose:s,data:n}=(0,ef.R)("chatSettings"),[x,m]=(0,g.useState)(ti[eU.i.Text]),f=(0,g.useCallback)(e=>{m(e)},[]),j=(0,g.useMemo)(()=>{switch(x){case ti[eU.i.Text]:return(0,i.jsx)(e6,{conversationType:eU.i.Text});case ti[eU.i.Code]:return(0,i.jsx)(e6,{conversationType:eU.i.Code});case ti[eU.i.Image]:return(0,i.jsx)(eJ,{});case ti.App:return(0,i.jsx)(G,{});default:return(0,i.jsx)(i.Fragment,{})}},[x]);return(0,g.useEffect)(()=>{if(null==n?void 0:n.characterId){m(ti.App);return}(null==n?void 0:n.conversationType)&&m(ti[n.conversationType])},[null==n?void 0:n.conversationType,null==n?void 0:n.characterId]),(0,i.jsxs)(r.d,{isOpen:t,onClose:s,size:"sm",children:[(0,i.jsx)(a.Z,{}),(0,i.jsxs)(o.s,{children:[(0,i.jsxs)(l.x,{py:4,px:6,pt:"calc(env(safe-area-inset-top) + 1rem)",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,i.jsx)(c.X,{size:"sm",children:e("chatSettings.title")}),(0,i.jsx)(d.o,{position:"static"})]}),(0,i.jsx)(u.m,{index:x,onChange:f,children:(0,i.jsxs)(h.t,{px:6,overflowX:"auto",children:[(0,i.jsx)(ts,{icon:e8,label:e("chatSettings.tabs.text"),isDisabled:!!(null==n?void 0:n.characterId)}),(0,i.jsx)(ts,{icon:e9,label:e("chatSettings.tabs.image"),isDisabled:!!(null==n?void 0:n.characterId)}),(0,i.jsx)(ts,{icon:te,label:e("chatSettings.tabs.code"),isDisabled:!!(null==n?void 0:n.characterId)}),(0,i.jsx)(ts,{icon:tt,label:e("chatSettings.tabs.app")})]})}),j]})]})}},48149:function(e,t,s){"use strict";s.d(t,{P:function(){return d}});var i=s(57437),n=s(28082),r=s(87032),a=s(42586),o=s(2265),l=s(34261),c=s(7414);let d=e=>{let{value:t,onChange:s,isDisabled:d,rowProps:u}=e,[h,p]=(0,o.useState)(t),g=(0,a.useTranslations)();return(0,o.useEffect)(()=>{p(t)},[t]),(0,i.jsx)(c.X,{layout:"stacked",heading:g("textSettings.advancedSettings.temperature.title"),tooltipBody:g("textSettings.advancedSettings.temperature.tooltip"),body:(0,i.jsx)(n.Vp,{size:"sm",children:h}),rowProps:u,children:(0,i.jsxs)(r.iR,{min:.2,max:2,step:.1,value:h,onChange:p,onChangeEnd:s,isDisabled:d,children:[(0,i.jsx)(l.U,{children:(0,i.jsx)(l.M,{})}),(0,i.jsx)(r.gs,{})]})})}},75519:function(e,t,s){"use strict";s.d(t,{y:function(){return d}});var i=s(57437),n=s(28082),r=s(87032),a=s(42586),o=s(2265),l=s(34261),c=s(7414);let d=e=>{let{onChange:t,value:s,isDisabled:d,rowProps:u}=e,[h,p]=(0,o.useState)(s),g=(0,a.useTranslations)();return(0,o.useEffect)(()=>{p(s)},[s]),(0,i.jsx)(c.X,{layout:"stacked",heading:g("textSettings.advancedSettings.topP.title"),tooltipBody:g("textSettings.advancedSettings.topP.tooltip"),body:(0,i.jsx)(n.Vp,{size:"sm",children:h}),rowProps:u,children:(0,i.jsxs)(r.iR,{min:.2,max:1,step:.1,value:h,onChange:p,onChangeEnd:t,isDisabled:d,children:[(0,i.jsx)(r.Uj,{children:(0,i.jsx)(l.M,{})}),(0,i.jsx)(r.gs,{})]})})}},86799:function(e,t,s){"use strict";s.d(t,{k6:function(){return i}});let i=e=>!e||e>=0&&e<=1?"Lowest":e>=2&&e<=4?"Low":e>=5&&e<=9?"Mid":e>=10&&e<=14?"High":e>=15?"Highest":"Unknown"},17231:function(e,t,s){"use strict";s.r(t),s.d(t,{ChatSidebar:function(){return t4}});var i,n,r,a,o=s(57437),l=s(99376),c=s(71416),d=s(10795),u=s(80368),h=s(42586),p=s(2265),g=s(23838),x=s(74468),m=s(19383),f=s(48860),j=s(34096),v=s(25774),b=s(71272),S=s(73595),y=s(83657),w=s(16152),k=s(4360),C=s(61507),z=s(6314),I=s(34442),R=s(20517),T=s(13701),M=s(71632),P=s(85109),E=s(86020),D=s(78796),F=s(37354),A=s(6924),L=s(31631),K=s(12125),O=s(10883),N=s(68193),B=s(25730),W=s(13449),U=s(29827),H=s(21770),X=s(71096),Z=s.n(X),q=s(45168),_=s(13823),V=s(5207),G=s(43159),Q=s(63649),J=s(94197);let Y=e=>{let{date:t}=e;return(0,o.jsx)("time",{children:Z()(t).format("MM/DD/YYYY, h:mma")})},$=e=>{let{backup:t,setDisableCreateButton:s,setRestoreId:i,isRestoring:n}=e,r=(0,h.useTranslations)("settings.encryptedBackup"),{dispatch:a}=(0,_.IO)(),{deleteEncryptedBackup:l}=(0,J.Z)(),c=(0,U.NL)(),d=(0,D.p)(),u=(0,V.yl)(e=>e.restoreBackup),g=(0,V.yl)(e=>e.isRunning),x=(0,v.Sz)(G.St,e=>e.id),[m,f]=(0,p.useState)(""),[j,b]=(0,p.useState)(!1),[S,w]=(0,p.useState)(!1),C=(0,H.D)({mutationFn:async()=>l(t.id),onMutate:async()=>{await c.cancelQueries({queryKey:Q.S.encryptedBackups(x)}),c.setQueryData(Q.S.encryptedBackups(x),e=>e.filter(e=>e.id!==t.id))},onError:()=>{d({title:r("prompt.deleteFailed"),status:"error",duration:9e3,isClosable:!0,position:"top-right"})},onSuccess:()=>{d({title:r("prompt.deleteSucceeded"),status:"success",duration:9e3,isClosable:!0,position:"top-right"})},onSettled:async()=>{await c.invalidateQueries({queryKey:Q.S.encryptedBackups(x)}),w(!1)}}),z=()=>d({title:r("prompt.notFound.title"),description:r("prompt.notFound.description"),status:"warning",duration:9e3,isClosable:!0,position:"top-right"}),I=e=>{if(e.preventDefault(),""===m)return z();u(t.encryptedBlobUrls,m,t.nonce),a({field:"showSettingsModal",value:!1})};return n?(0,o.jsx)(F.Z,{children:(0,o.jsx)(A.e,{children:(0,o.jsx)("form",{onSubmit:I,style:{width:"100%"},children:(0,o.jsxs)(y.K,{spacing:4,children:[(0,o.jsx)(L.X,{size:"sm",children:r("restoreTitle",{title:t.name})}),(0,o.jsxs)(K.B,{children:[(0,o.jsx)(O.I,{type:j?"text":"password",isDisabled:g,onChange:e=>{f(e.target.value)},placeholder:r("table.actions.restore.placeholder"),autoFocus:!0,value:m}),(0,o.jsx)(N.x,{children:(0,o.jsx)(B.h,{"aria-label":j?"Hide password":"Show password",icon:j?(0,o.jsx)(P.t,{}):(0,o.jsx)(E.O,{}),onClick:()=>b(e=>!e),variant:"ghost",size:"sm"})})]}),(0,o.jsxs)(W.k,{justifyContent:"flex-end",gap:2,children:[(0,o.jsx)(T.z,{colorScheme:"secondary",isDisabled:g,onClick:()=>{f(""),i(void 0),s(!1)},children:r("create.close")}),(0,o.jsx)(T.z,{colorScheme:"primary",isLoading:g,type:"submit",isDisabled:""===m||g,onSubmit:I,children:r("table.actions.restore.cta")})]})]})})})}):(0,o.jsx)(F.Z,{children:(0,o.jsxs)(A.e,{display:"flex",flexDir:"row",justifyContent:"space-between",alignItems:"center",children:[(0,o.jsxs)(y.K,{children:[(0,o.jsx)(L.X,{size:"sm",children:t.name||(0,o.jsx)(Y,{date:t.createdAt})}),t.name&&(0,o.jsx)(k.x,{fontSize:"sm",color:"text.subtle",children:(0,o.jsx)(Y,{date:t.createdAt})})]}),(0,o.jsxs)(W.k,{gap:2,children:[(0,o.jsx)(B.h,{size:"sm","aria-label":r("table.actions.delete.cta"),icon:(0,o.jsx)(q.EF5,{}),fontSize:"lg",colorScheme:"red",onClick:()=>{window.confirm(r("table.actions.delete.confirmation"))&&(w(!0),C.mutate())},variant:"ghost",isLoading:S}),(0,o.jsx)(T.z,{colorScheme:"secondary",size:"sm",onClick:()=>{i(t.id),s(!0)},isDisabled:g||S,children:r("table.actions.restore.cta")})]})]})})};var ee=s(95171),et=s(40748),es=s(41124),ei=s(86537),en=s(72246),er=s(99047),ea=s(58055),eo=s(22053);let el=e=>{if(!e)return 0;let t=0;e.length>=6&&t++,e.length>=8&&t++,e.length>=12&&t++,e.length>=16&&t++,e.length>=18&&t++,e.length>=20&&t++,e.length>=22&&t++,e.length>=24&&t++;let s=1;return/[a-z]/.test(e)&&s++,/[A-Z]/.test(e)&&s++,/[0-9]/.test(e)&&s++,/[^a-zA-Z0-9]/.test(e)&&s++,/[a-zA-Z][0-9\W]+[a-zA-Z]/.test(e)&&s++,Math.min(5,Math.max(0,Math.floor((t+s)/2)))},ec=p.forwardRef(function(e,t){let{password:s,...i}=e,n=el(s),r=n/5*100,a=r<33?"red":r<66?"orange":"green";return(0,o.jsx)(ea.U,{width:"full",ref:t,...i,children:Array.from({length:5}).map((e,t)=>(0,o.jsx)(eo.xu,{height:"1",flex:"1",rounded:"sm",bg:"gray","data-selected":t<n?"":void 0,layerStyle:"fill.subtle",_selected:{bg:a,layerStyle:"fill.solid"}},t))})});var ed=s(25315);let eu=e=>{let{onCancel:t,onBack:s}=e,i=(0,h.useTranslations)("settings.encryptedBackup"),n=(0,v.Sz)(G.St,e=>e.id),{dispatch:r}=(0,_.IO)(),[a,l]=(0,p.useState)(""),[c,d]=(0,p.useState)(""),[u,g]=(0,p.useState)(""),[x,m]=(0,p.useState)(!1),[f,j]=(0,p.useState)(!1),b=(0,ed.YF)(e=>e.createBackup),S=(0,ed.YF)(e=>e.isRunning),y=(0,ed.YF)(e=>e.dbLocked),C=(0,ed.YF)(e=>e.cancel),z=(0,ed.YF)(e=>e.addDbLockListener);(0,p.useEffect)(()=>z(e=>{"unlock"===e&&r({field:"showSettingsModal",value:!1})}),[r]);let I=()=>{l(""),d(""),g("")},M=e=>{e.preventDefault(),b(n,c,a)},D=""===c||""===u||c!==u;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(ei.fK,{children:[(0,o.jsx)(ei.fK.Left,{children:(0,o.jsx)(es.r,{onClick:s,isDisabled:y})}),(0,o.jsx)(ei.fK.Middle,{children:(0,o.jsx)(en.$,{children:i("create.submit")})})]}),(0,o.jsxs)("form",{onSubmit:M,style:{width:"100%"},children:[y?(0,o.jsx)(w.f,{children:(0,o.jsxs)(W.k,{align:"center",gap:4,direction:"column",children:[(0,o.jsx)(k.x,{fontSize:"md",color:"text.subtle",children:i("create.dbLocked")}),(0,o.jsx)(er.LoadingSpinnerPage,{height:"300px"})]})}):(0,o.jsx)(w.f,{children:(0,o.jsxs)(W.k,{align:"center",gap:4,direction:"column",children:[(0,o.jsx)(k.x,{fontSize:"md",color:"text.subtle",children:i("create.description")}),(0,o.jsxs)(ee.NI,{children:[(0,o.jsx)(et.l,{children:i("create.name.label")}),(0,o.jsx)(O.I,{onChange:e=>{l(e.target.value)},placeholder:i("create.name.placeholder"),type:"text",value:a,isDisabled:S})]}),(0,o.jsxs)(ee.NI,{children:[(0,o.jsx)(et.l,{children:i("create.password.label")}),(0,o.jsxs)(K.B,{children:[(0,o.jsx)(O.I,{type:x?"text":"password",onChange:e=>{d(e.target.value)},placeholder:i("create.password.placeholder"),value:c,max:32,isDisabled:S}),(0,o.jsx)(N.x,{children:(0,o.jsx)(B.h,{"aria-label":x?"Hide password":"Show password",icon:x?(0,o.jsx)(P.t,{}):(0,o.jsx)(E.O,{}),onClick:()=>m(e=>!e),variant:"ghost",size:"sm"})})]})]}),(0,o.jsx)(ec,{password:c}),(0,o.jsxs)(ee.NI,{children:[(0,o.jsx)(et.l,{children:i("create.confirmPassword.label")}),(0,o.jsxs)(K.B,{children:[(0,o.jsx)(O.I,{type:f?"text":"password",onChange:e=>{g(e.target.value)},placeholder:i("create.confirmPassword.placeholder"),value:u,max:32,isDisabled:S}),(0,o.jsx)(N.x,{children:(0,o.jsx)(B.h,{"aria-label":f?"Hide password":"Show password",icon:f?(0,o.jsx)(P.t,{}):(0,o.jsx)(E.O,{}),onClick:()=>j(e=>!e),variant:"ghost",size:"sm"})})]})]})]})}),(0,o.jsxs)(R.m,{gap:4,py:6,children:[(0,o.jsx)(T.z,{onClick:()=>{C(),I(),t()},children:i("create.cancel")}),(0,o.jsx)(T.z,{colorScheme:"primary",onClick:M,type:"submit",isDisabled:D,isLoading:S,children:i("create.submit")})]})]})]})},eh=e=>{let{setRoute:t}=e,s=(0,h.useTranslations)("settings.encryptedBackup"),{getEncryptedBackups:i}=(0,J.Z)(),n=(0,ed.YF)(e=>e.isRunning),r=(0,ed.YF)(e=>e.success),a=(0,V.yl)(e=>e.isRunning),l=(0,v.Sz)(G.St,e=>e.id),[c,d]=(0,p.useState)(!1),[u,g]=(0,p.useState)(!1),[x,m]=(0,p.useState)(),{data:f,isLoading:j}=(0,M.a)({queryKey:Q.S.encryptedBackups(l),queryFn:i});(0,p.useEffect)(()=>{!n&&r&&g(!1)},[n,r]);let S=(0,p.useMemo)(()=>(null==f?void 0:f.length)?(0,o.jsx)(y.K,{children:null==f?void 0:f.map(e=>(0,o.jsx)($,{setDisableCreateButton:d,backup:e,isRestoring:x===e.id,setRestoreId:m},"backup-".concat(e.id)))}):(0,o.jsx)(o.Fragment,{}),[f,x]);return j?(0,o.jsx)(er.LoadingSpinnerPage,{height:"300px"}):(0,o.jsxs)(o.Fragment,{children:[u?(0,o.jsx)(eu,{onCancel:()=>{g(!1)},onBack:()=>g(!1)}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(ei.fK,{children:[(0,o.jsx)(ei.fK.Left,{children:(0,o.jsx)(es.r,{onClick:()=>{t(b.K.Settings)}})}),(0,o.jsx)(ei.fK.Middle,{children:(0,o.jsx)(en.$,{children:s("title")})})]}),(0,o.jsx)(w.f,{children:(0,o.jsxs)(y.K,{gap:6,children:[(0,o.jsx)(k.x,{color:"text.subtle",children:s("description")}),(0,o.jsxs)(C.b,{size:"sm",borderRadius:"lg",children:[(0,o.jsx)(z.z,{}),(0,o.jsx)(I.X,{children:s("warning")})]}),S]})})]}),!u&&(0,o.jsx)(R.m,{py:6,children:(0,o.jsx)(T.z,{colorScheme:"primary",onClick:()=>{g(!0)},width:"full",size:"md",isDisabled:c,isLoading:n||a,children:s("createCta")})})]})};var ep=s(86827),eg=s(72760),ex=s(37983),em=s(48373),ef=s(10272),ej=s(70638),ev=s(21438),eb=s(9091),eS=s(58962),ey=s(88664),ew=s(31092),ek=s(28082);let eC=e=>(0,o.jsx)(ek.Vp,{bg:"var(--muted)",color:"var(--primary)",fontSize:"xs",...e,children:"PRO"});var ez=s(81613),eI=e=>{let{pointStatement:t,innerRef:s}=e;return(0,o.jsxs)(ej.Tr,{ref:s,children:[(0,o.jsx)(ew.Td,{children:(0,o.jsx)(k.x,{fontSize:"sm",children:new Date(t.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})})}),(0,o.jsx)(ew.Td,{children:(0,o.jsxs)(W.k,{gap:2,alignItems:"center",children:[(0,o.jsx)(k.x,{fontSize:"sm",children:t.event}),t.userType===ez.FW.PRO&&(0,o.jsx)(eC,{})]})}),(0,o.jsx)(ew.Td,{isNumeric:!0,children:(0,o.jsx)(ep.M,{children:(0,o.jsx)(k.x,{fontSize:"sm",children:t.points})})})]})},eR=s(3490);let eT=()=>{let{ref:e,inView:t}=(0,ey.YD)(),{getPointsStatement:s}=(0,J.Z)(),{data:i,fetchNextPage:n,hasNextPage:r,isPending:a,isFetchingNextPage:l}=(0,eS.N)({queryKey:["points","statement"],queryFn:e=>{let{pageParam:t=0}=e;return s(t)},initialPageParam:0,getNextPageParam:(e,t)=>e.length===eR.pw?t.length*eR.pw:void 0});(0,p.useEffect)(()=>{t&&r&&n()},[t,n,r]);let c=(0,o.jsx)(ep.M,{my:6,children:(0,o.jsx)(eg.$,{})}),d=(0,p.useMemo)(()=>{var t;return null==i?void 0:null===(t=i.pages)||void 0===t?void 0:t.map(t=>t.map((s,i)=>(0,o.jsx)(eI,{pointStatement:s,innerRef:t.length===i+1?e:void 0},s.timestamp)))},[null==i?void 0:i.pages,e]);return a?c:(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(ex.x,{children:[(0,o.jsxs)(em.i,{variant:"simple",children:[(0,o.jsx)(ef.h,{children:(0,o.jsxs)(ej.Tr,{children:[(0,o.jsx)(ev.Th,{w:"15%",children:"Date"}),(0,o.jsx)(ev.Th,{children:"Action"}),(0,o.jsx)(ev.Th,{w:"20%",isNumeric:!0,children:(0,o.jsx)(ep.M,{children:"Points"})})]})}),(0,o.jsx)(eb.p,{children:d})]}),l&&c]})})},eM=e=>{let{setRoute:t}=e,s=(0,p.useCallback)(()=>{t(b.K.Settings)},[t]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(ei.fK,{children:[(0,o.jsx)(ei.fK.Left,{children:(0,o.jsx)(es.r,{onClick:s})}),(0,o.jsx)(ei.fK.Middle,{children:(0,o.jsx)(en.$,{children:"Point History"})})]}),(0,o.jsx)(w.f,{px:0,children:(0,o.jsx)(eT,{})})]})};var eP=s(68686),eE=s(26262),eD=s(52339),eF=s(89307),eA=s(65934),eL=s(7717),eK=s(27924),eO=s(13841);let eN=e=>{let{isOpen:t,onClose:s}=e;return(0,o.jsxs)(m.u_,{isOpen:t,onClose:s,isCentered:!0,children:[(0,o.jsx)(f.Z,{}),(0,o.jsxs)(j.h,{maxWidth:"calc(-2rem + 100vw)",width:"55rem",children:[(0,o.jsx)(eK.o,{color:"black",zIndex:"modal"}),(0,o.jsx)(eO.Iw,{routing:"virtual"})]})]})};var eB=s(7414),eW=s(33458);let eU=async()=>{let e=await eW.db.conversations.toCollection().primaryKeys();return eW.db.messageIds.where("conversationId").noneOf(e).count()},eH=()=>{let e=(0,h.useTranslations)("settings.debug.orphanedMessages"),{data:t,isPending:s,mutate:i}=(0,H.D)({mutationFn:eU});return(0,o.jsx)(eB.X,{heading:e("title"),body:(0,o.jsx)(k.x,{color:"text.subtle",fontSize:"sm",children:void 0===t?e("description"):e("orphanedCount",{orphanedCount:t})}),children:(0,o.jsx)(T.z,{colorScheme:"primary",onClick:()=>i(),isLoading:s,isDisabled:void 0!==t,children:e("countButton")})})},eX=()=>{let e=(0,h.useTranslations)("settings.chatHistory.persistence"),[t,s]=(0,p.useState)(!1),[i,n]=(0,p.useState)(!1),[r,a]=(0,p.useState)(!0),[o,l]=(0,p.useState)(!1),[c,d]=(0,p.useState)(!1),[u,g]=(0,p.useState)("default"),x=(0,D.p)(),m=async()=>{try{if(!navigator.storage||!navigator.storage.persist||!navigator.storage.persisted){s(!1),a(!1);return}s(!0);let e=await navigator.storage.persisted();n(e)}catch(e){console.error("Error checking storage persistence:",e),s(!1)}finally{a(!1)}},f=()=>{"Notification"in window&&g(Notification.permission)},j=async()=>{if(!navigator.storage||!navigator.storage.persist)return!1;try{l(!0);let t=await navigator.storage.persist();return n(t),t||(d(!0),x({title:e("deniedAlertTitle"),description:e("denied"),status:"error",duration:9e3,isClosable:!0,id:"storage-persistence"})),t}catch(e){return console.error("Error requesting storage persistence:",e),!1}finally{l(!1)}},v=async()=>{if(!("Notification"in window))return!1;try{l(!0);let e=await Notification.requestPermission();return"granted"===e&&m(),"granted"===e}catch(e){return!1}finally{g(Notification.permission),l(!1)}};return(0,p.useEffect)(()=>{m(),f()},[]),{isSupported:t,isPersisted:i,isLoading:r,requestPersistence:j,requesting:o,hasDeniedPersistence:c,notificationPermission:u,requestNotificationPermission:v}},eZ=()=>{let e=(0,h.useTranslations)("settings.chatHistory.persistence"),{isLoading:t,isPersisted:s,isSupported:i,requesting:n,hasDeniedPersistence:r,requestNotificationPermission:a,notificationPermission:l,requestPersistence:c}=eX(),d=r&&"denied"===l,u=e(d?"denied":"enable"),p=e(d?"enableNotifications":"persistStorage");return(0,o.jsx)(eB.X,{heading:e("title"),body:(0,o.jsx)(k.x,{color:"text.subtle",fontSize:"sm",children:s?e("persistedMessage"):u}),children:(0,o.jsx)(T.z,{colorScheme:"primary",onClick:d?a:c,isDisabled:!i||s||t,isLoading:n,children:s?e("persisted"):p})})};var eq=s(57806);let e_=()=>{let e=(0,v.Sz)(G.St,e=>e.isProUser),t=(0,v.Sz)(G.St,e=>e.isSignedIn),s=(0,v.Sz)(G.St,e=>e.refetchUserProfile);if(eR.M3||!t)return(0,o.jsx)(o.Fragment,{});let i=async()=>{(await fetch("/api/venice/set_user_type",{method:"POST"})).ok&&s()};return(0,o.jsx)(eL.Z,{title:"Toggle Pro Status",containerProps:{boxShadow:"sm",borderWidth:1,borderColor:"border.base",py:0},children:(0,o.jsxs)(eB.X,{children:[(0,o.jsx)(k.x,{color:"text.subtle",fontSize:"sm",children:"Override user's Pro status in Development and Preview."}),(0,o.jsx)(eq.r,{colorScheme:"blue",isChecked:e,onChange:i})]})})};var eV=s(60187);let eG=()=>{let e;let{state:{chatRequestsRemaining:t,chatRequestsResetAt:s,imageRequestsRemaining:i,imageRequestsResetAt:n}}=(0,_.IO)(),r=(0,v.Sz)(G.St,e=>e.isProUser),a=(0,v.Sz)(G.St,e=>e.isSignedIn);a&&r||(e=a?"Upgrade to Venice.ai Pro above to get more requests.":"Sign up above to get more requests.");let l=e&&(0,o.jsx)(eV.u,{label:e,fontSize:"md",mb:0,children:(0,o.jsx)("span",{children:(0,o.jsx)(q.HtX,{})})});return(0,o.jsxs)(eL.Z,{title:"Remaining Requests",containerProps:{boxShadow:"sm",borderWidth:1,borderColor:"border.base",py:0},children:[(0,o.jsxs)(eB.X,{heading:"Chat",children:[(0,o.jsxs)(k.x,{fontSize:"sm",mr:2,children:[t?"".concat(t," remaining"):"-",s&&(0,o.jsxs)(o.Fragment,{children:[" until ",Z()(s).format("h:mm A")]})]}),l]}),(0,o.jsxs)(eB.X,{heading:"Image",children:[(0,o.jsxs)(k.x,{fontSize:"sm",mr:2,children:[i?"".concat(i," remaining"):"-",n&&(0,o.jsxs)(o.Fragment,{children:[" until ",Z()(n).format("h:mm A")]})]}),l]})]})},eQ=(0,p.createContext)(void 0);var eJ=s(52347),eY=s(74386),e$=s(47749),e0=s(35966),e1=s(64798),e2=s.n(e1),e4=s(41425);let e3=e=>{let{children:t,showWhenOverPercentage:s,spaceProps:i,colorScheme:n="primary",...r}=e,a=(0,h.useTranslations)("settings.storage"),[l,c]=(0,p.useState)(),[d,u]=(0,p.useState)(),[g,x]=(0,p.useState)(!1),[m,f]=(0,p.useState)(void 0===s);(0,p.useEffect)(()=>{let e=e2()(async()=>{var e,t;if(!(null===(t=navigator)||void 0===t?void 0:null===(e=t.storage)||void 0===e?void 0:e.estimate))return;let{quota:i,usage:n}=await navigator.storage.estimate();c(i),u(n),x(!0),!m&&i&&void 0!==n&&n/i*100>(null!=s?s:0)&&f(!0)},3e3);return g||e(),m&&e0.default.on("storagemutated",e),()=>{m&&e0.default.on("storagemutated").unsubscribe(e)}},[m,s,g]);let j=g?l:1,v=g?d:0;if(!j||void 0===v)return null;let b=Number((v/j*100).toFixed(2));if(s&&b<=s)return null;let S=j/1073741824,w=S>1?(j/1073741824).toFixed(1).replace(".0",""):S.toFixed(2),C=a("title",{percentage:g?b:"~",quota:g?w:"~"});return(0,o.jsxs)(y.K,{...i,children:[b<=100?t:(0,o.jsx)(k.x,{whiteSpace:"pre-wrap",fontSize:"sm",color:"text.error",children:a("inaccurate")}),(0,o.jsxs)(y.K,{direction:"row",alignItems:"center",children:[(0,o.jsx)(k.x,{whiteSpace:"pre-wrap",fontSize:"sm",children:C}),(0,o.jsx)(e4.x,{label:a("tooltip"),children:(0,o.jsx)(eo.xu,{as:"span",color:"text.subtle",children:(0,o.jsx)(q.Qoz,{})})})]}),(0,o.jsx)(e$.E,{isIndeterminate:!g,value:b,colorScheme:n,borderRadius:"full",...r})]})};var e7=s(97244),e5=s(5095),e6=s(59745);let e8=(e,t,s)=>{let i=new Intl.PluralRules("en-US",{type:"ordinal"}),n="".concat(e," ").concat(s),r=new Map([["zero","0 ".concat(s)],["one",1===e?"1 ".concat(t):n],["two",n],["few",n],["many",n],["other","".concat(e.toLocaleString()," ").concat(s)]]),a=i.select(e);return r.get(a)||"".concat(e.toLocaleString()," ").concat(s)},e9=e=>{let{textProps:t}=e,s=(0,h.useTranslations)(),i=(0,v.Sz)(G.St,e=>e.isLoaded),n=(0,v.Sz)(G.St,e=>e.isSignedIn),r=(0,v.Sz)(G.St,e=>e.pointsBalance),a=(0,p.useMemo)(()=>{if(void 0!==r)return(0,o.jsx)(e5.M,{mode:"wait",children:(0,o.jsx)(e6.E.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},layout:!0,transition:{layout:{type:"spring",bounce:.4,duration:.5}},children:(0,o.jsx)(k.x,{...t,children:e8(r,s("points.singular"),s("points.plural"))})},r)})},[r,t,s]);return i&&!n?(0,o.jsx)(o.Fragment,{}):(0,o.jsx)(e7.O,{isLoaded:i,children:a})};var te=s(81151),tt=s(32230),ts=s(81897);let ti=e=>{let[t,s]=(0,p.useState)(!1),i=(0,v.Sz)(G.St,e=>e.id),n=(0,v.Sz)(G.St,e=>e.userName),r=(0,v.Sz)(G.St,e=>e.userAvatarUrl),a=(0,p.useMemo)(()=>r||(0,ts.B)(i),[r,i]);if((0,p.useEffect)(()=>{s(!0)},[]),t)return(0,o.jsx)(tt.q,{borderRadius:"md",size:"xs",src:a,name:n,...e})},tn=(0,p.memo)(e=>{let{subText:t,showProTag:s=!1,size:i="sm",showDots:n,...r}=e,a=(0,v.Sz)(G.St,e=>e.isLoaded),l=(0,v.Sz)(G.St,e=>e.userName),c=(0,v.Sz)(G.St,e=>e.userSecondaryName),d=(0,v.Sz)(G.St,e=>e.isProUser);return(0,o.jsxs)(W.k,{gap:3,alignItems:"center",width:"full",...r,children:[(0,o.jsxs)(W.k,{gap:3,alignItems:"center",overflow:"hidden",children:[(0,o.jsx)(e7.O,{isLoaded:a,borderRadius:"lg",children:(0,o.jsx)(ti,{size:i,borderRadius:"lg"})}),(0,o.jsx)(te.N,{noOfLines:2,isLoaded:a,minWidth:0,children:(0,o.jsxs)(y.K,{spacing:0,alignItems:"flex-start",children:[(0,o.jsx)(k.x,{fontSize:i,fontWeight:"semibold",color:"text.base",overflow:"hidden",textOverflow:"ellipsis",width:"full",children:l}),null!=t?t:c]})})]}),(0,o.jsxs)(W.k,{gap:2,alignItems:"center",children:[d&&s&&(0,o.jsx)(e7.O,{isLoaded:a,children:(0,o.jsx)(eC,{})}),n&&(0,o.jsx)(q.ZIz,{color:"var(--muted-foreground)"})]})]})});tn.displayName="UserCard";let tr=e=>(0,o.jsx)(ek.Vp,{bg:"var(--muted)",color:"var(--primary)",fontSize:"xs",...e,children:"STAFF"});var ta=s(64214),to=s(41528),tl=s(1914);let tc={boxShadow:"sm",borderWidth:1,borderColor:"border.base",py:0},td={mx:4,my:4},tu=e=>{let{setRoute:t,onClose:s}=e,i=(0,h.useTranslations)(),{isOpen:n,onClose:r,onOpen:a}=(0,c.q)(),d=(0,l.useRouter)(),{handleClearConversations:u}=(0,p.useContext)(eQ),g=(0,U.NL)(),{onOpen:m}=(0,to.R)("upgrade"),{copyToClipboard:f}=(0,tl.m)({timeout:2e3}),{disconnect:j}=(0,eF.qL)(),{open:S}=(0,eF.Ig)(),{clearSelectedConversation:C}=(0,ta.uu)(),z=(0,v.Sz)(G.St,e=>e.userName),I=(0,v.Sz)(G.St,e=>e.isWalletConnectUser),R=(0,v.Sz)(G.St,e=>e.isClerkUser),M=(0,v.Sz)(G.St,e=>e.isProUser),P=(0,v.Sz)(G.St,e=>e.isStripeUser),E=(0,v.Sz)(G.St,e=>e.isSignedIn),A=(0,v.Sz)(G.St,e=>e.isVeniceStaff),L=(0,v.Sz)(G.St,e=>e.isMorTokenHolder),H=(0,v.Sz)(G.St,e=>e.referralCode),X=(0,v.Sz)(G.St,e=>e.referralRanking),Z=null==X?void 0:X.totalReferrals,{signOut:_,redirectToSignIn:V}=(0,eD.ll)(),Q=async()=>{await S({view:"Account"})},J=(0,p.useCallback)(()=>{window.confirm(i("settings.chatHistory.deleteHistory.confirmation"))&&((0,x.Qe)({name:"clearedHistory",data:{}}),C(),g.getQueriesData({queryKey:["image"]}).forEach(e=>{let[t,s]=e;s&&URL.revokeObjectURL(s)}),g.removeQueries({queryKey:["image","message","conversation","messageIds"]}),u(),s&&s())},[C,u,s,g,i]),Y=(0,D.p)(),$=(0,p.useCallback)(e=>{f(e),Y({duration:9e3,id:"referral-link-toast",isClosable:!0,position:"top-right",status:"success",title:i("settings.veniceAccounts.referralProgram.link.success")})},[f,Y,i]),ee=(0,p.useCallback)(async()=>{let e="".concat(i("settings.veniceAccounts.referralProgram.link.description"),": https://venice.ai/chat?ref=").concat(H);if(navigator.canShare&&navigator.canShare({text:e}))return await navigator.share({text:e}).then(()=>!0).catch(()=>!0);$(e)},[$,H,i]),et=(0,p.useCallback)(()=>{(0,x.Qe)({name:"viewedPointsHistory",data:{}}),t(b.K.PointHistory)},[t]),es=(0,p.useCallback)(()=>{(0,x.Qe)({name:"viewedApiKeys",data:{}}),t(b.K.ApiKeys)},[t]),er=(0,p.useCallback)(async()=>{await V()},[V]),el=(0,p.useCallback)(async()=>{g.invalidateQueries({queryKey:["*"]}),(0,x.Qe)({name:"signedOut",data:{}}),C(),I?(await j(),await (0,eA.w7)()):await _()},[C,j,I,g,_]),ec=(0,o.jsxs)(eo.xu,{children:[A?(0,o.jsx)(tr,{mr:2}):(0,o.jsx)(o.Fragment,{}),M?(0,o.jsx)(eC,{}):(0,o.jsx)(o.Fragment,{})]});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(ei.fK,{children:[(0,o.jsxs)(ei.fK.Middle,{children:[(0,o.jsx)(q.Kam,{}),(0,o.jsx)(en.$,{children:i("account.title")})]}),(0,o.jsx)(ei.fK.Right,{children:(0,o.jsx)(eJ.i,{})})]}),(0,o.jsxs)(w.f,{px:4,pt:4,pb:"calc(env(safe-area-inset-top) + 2rem)",display:"flex",flexDir:"column",gap:6,children:[(0,o.jsx)(e_,{}),E?(0,o.jsxs)(eL.Z,{title:i("settings.yourAccount.title"),rightComponent:ec,containerProps:tc,children:[(0,o.jsxs)(W.k,{alignItems:"center",justifyContent:"space-between",children:[R&&(0,o.jsx)(tn,{px:4,py:4}),I&&!R&&(0,o.jsxs)(ea.U,{ml:4,children:[(0,o.jsx)(k.x,{fontSize:"sm",fontWeight:600,children:i("settings.yourAccount.web3user.title")}),(0,o.jsx)(k.x,{fontSize:"xs",children:z})]}),(0,o.jsx)(y.K,{spacing:1,py:4,mr:4,minW:"100px",children:(0,o.jsx)(ep.M,{children:(0,o.jsx)(e9,{textProps:{color:"text.subtle",fontSize:"sm"}})})})]}),!I&&(0,o.jsx)(eB.X,{heading:i("settings.yourAccount.manageAccount.cta"),onClick:a}),I&&R&&(0,o.jsx)(eB.X,{heading:i("settings.yourAccount.walletManagement.title"),onClick:Q}),M&&L&&(0,o.jsx)(eB.X,{heading:i("settings.yourAccount.morUpgrade.cta"),onClick:()=>m()}),P&&(0,o.jsx)(eB.X,{heading:i("settings.yourAccount.manageSubscription.cta"),onClick:()=>{d.push("/api/subscription/portal")}}),(0,o.jsx)(eB.X,{heading:i("settings.yourAccount.pointsHistory.cta"),onClick:et}),(0,o.jsx)(eB.X,{heading:"".concat(i("settings.yourAccount.apiKeys.cta")),badgeText:"Beta",onClick:es})]}):(0,o.jsx)(eL.Z,{title:i("settings.veniceAccounts.title"),containerProps:tc,children:(0,o.jsxs)(eB.X,{children:[(0,o.jsxs)(y.K,{spacing:4,children:[(0,o.jsx)(k.x,{color:"text.subtle",fontSize:"sm",children:i("settings.veniceAccounts.createAccount.description")}),(0,o.jsxs)(k.x,{color:"text.subtle",fontSize:"sm",children:[i("settings.veniceAccounts.createAccount.alreadyHaveAccount"),"  ",(0,o.jsx)(T.z,{colorScheme:"primary",variant:"link",as:eP.r,onClick:er,children:i("settings.veniceAccounts.createAccount.alreadyHaveAccountCta")}),"."]})]}),(0,o.jsx)(T.z,{colorScheme:"primary",as:"a",href:"/sign-up","data-testid":"sign up",px:8,children:i("settings.veniceAccounts.createAccount.signUpCta")})]})}),E&&(0,o.jsxs)(F.Z,{bg:"background.surface.muted",borderRadius:"xl",overflow:"hidden",borderWidth:1,borderColor:"border.base",boxShadow:"var(--ring-offset-shadow,0 0 #0000),var(--ring-shadow,0 0 #0000),var(--shadow)",children:[(0,o.jsx)(eB.X,{heading:i("settings.veniceAccounts.referralProgram.title"),body:(0,o.jsxs)(eE.g,{spacing:3,children:[(0,o.jsxs)(k.x,{color:"text.subtle",children:[i("settings.veniceAccounts.referralProgram.description.part1")," ",M?100:50," ",i("settings.veniceAccounts.referralProgram.description.part2")," ",M?"2,000":"1,000"," ",i("settings.veniceAccounts.referralProgram.description.part3")]}),(0,o.jsxs)(K.B,{size:"sm",children:[(0,o.jsx)(O.I,{borderLeftRadius:"lg",onClick:()=>$("https://venice.ai/chat?ref=".concat(H)),value:E?"https://venice.ai/chat?ref=".concat(H):"",readOnly:!0}),(0,o.jsx)(N.x,{children:(0,o.jsx)(B.h,{borderLeftRadius:"none",colorScheme:"primary",isDisabled:!E,onClick:ee,icon:(0,o.jsx)(q.umD,{}),"aria-label":"Share"})})]})]})}),X&&(0,o.jsxs)(W.k,{fontSize:"sm",px:4,py:4,borderTopWidth:1,borderColor:"border.base",children:[(0,o.jsxs)(W.k,{alignItems:"center",gap:2,flex:1,children:[(0,o.jsx)(ep.M,{boxSize:"40px",fontSize:"xl",bg:"var(--input)",borderRadius:"full",children:(0,o.jsx)(q.S8z,{style:{strokeWidth:2}})}),(0,o.jsxs)(y.K,{spacing:0,children:[(0,o.jsx)(k.x,{fontWeight:"semibold",children:Z}),(0,o.jsx)(k.x,{color:"text.subtle",children:1!==Z?i("settings.veniceAccounts.referralRanking.pluralUsers"):i("settings.veniceAccounts.referralRanking.singleUser")})]})]}),(0,o.jsxs)(W.k,{alignItems:"center",gap:2,flex:1,children:[(0,o.jsx)(ep.M,{boxSize:"40px",fontSize:"xl",bg:"var(--input)",borderRadius:"full",children:(0,o.jsx)(q.gBl,{style:{strokeWidth:2}})}),(0,o.jsxs)(y.K,{spacing:0,children:[(0,o.jsx)(k.x,{fontWeight:"semibold",children:null==X?void 0:X.rank}),(0,o.jsx)(k.x,{color:"text.subtle",children:i("settings.veniceAccounts.referralRanking.rank")})]})]})]})]}),!M&&(0,o.jsxs)(F.Z,{bg:"background.surface.muted",borderRadius:"xl",overflow:"hidden",borderWidth:1,borderColor:"border.base",boxShadow:"var(--ring-offset-shadow,0 0 #0000),var(--ring-shadow,0 0 #0000),var(--shadow)",children:[(0,o.jsx)(eo.xu,{bg:"var(--primary)",boxSize:"100px",borderRadius:"full",position:"absolute",filter:"blur(100px)",opacity:"0.7",right:0,top:0}),(0,o.jsx)(eB.X,{rowProps:{zIndex:2},heading:i("settings.veniceAccounts.upgradeToPro.title"),body:(0,o.jsx)(k.x,{color:"text.subtle",children:i("settings.veniceAccounts.upgradeToPro.description")}),children:(0,o.jsx)(T.z,{colorScheme:"primary",mt:4,"data-testid":"upgrade",rightIcon:(0,o.jsx)(q.c_x,{}),onClick:()=>m(),children:i("settings.veniceAccounts.upgradeToPro.cta")})}),(0,o.jsx)(eY.K,{transform:"rotate(-25deg)",zIndex:"1",top:"-10%",opacity:"0.75",_dark:{opacity:"0.3"},boxSize:"750px",position:"absolute",color:"background.surface.base"})]}),(0,o.jsx)(eG,{}),(0,o.jsxs)(eL.Z,{title:i("settings.chatHistory.title"),containerProps:tc,children:[(0,o.jsx)(e3,{spaceProps:td}),(0,o.jsx)(eB.X,{heading:i("settings.chatHistory.deleteHistory.title"),body:(0,o.jsx)(k.x,{color:"text.subtle",fontSize:"sm",children:i("settings.chatHistory.deleteHistory.description")}),children:(0,o.jsx)(T.z,{colorScheme:"red",onClick:J,children:i("settings.chatHistory.deleteHistory.cta")})}),A&&(0,o.jsx)(eZ,{}),A&&(0,o.jsx)(eB.X,{heading:i("settings.chatHistory.encryptedBackup.title"),body:(0,o.jsx)(k.x,{color:"text.subtle",fontSize:"sm",children:i("settings.chatHistory.encryptedBackup.description")}),children:(0,o.jsx)(T.z,{colorScheme:"primary",onClick:()=>{t(b.K.BackupHistory)},children:i("settings.chatHistory.encryptedBackup.cta")})})]}),A&&(0,o.jsx)(eL.Z,{title:i("settings.debug.title"),containerProps:tc,rightComponent:(0,o.jsx)(tr,{mr:2}),children:(0,o.jsx)(eH,{})}),E&&(0,o.jsx)(T.z,{size:"lg",fontSize:"sm",onClick:el,children:i("settings.appSettings.signOut.cta")})]}),(0,o.jsx)(eN,{isOpen:n,onClose:r})]})},th=e=>{let{isOpen:t,onClose:s}=e,i=(0,ed.YF)(e=>e.dbLocked),[n,r]=(0,p.useState)(b.K.Settings),a=(0,v.Sz)(G.St,e=>e.isVeniceStaff),l=(0,p.useMemo)(()=>{switch(n){case b.K.PointHistory:return(0,o.jsx)(eM,{setRoute:r});case b.K.ApiKeys:return(0,o.jsx)(S.m,{setRoute:r});case b.K.BackupHistory:return a?(0,o.jsx)(eh,{setRoute:r}):null;default:return(0,o.jsx)(tu,{setRoute:r,onClose:s})}},[n,a,s]),c=(0,p.useCallback)(()=>{r(b.K.Settings),s()},[s]);return(0,o.jsxs)(m.u_,{size:{base:"full",md:"lg"},isOpen:t,onClose:i?()=>null:c,children:[(0,o.jsx)(f.Z,{}),(0,o.jsx)(j.h,{children:l})]})};var tp=s(91092),tg=s(62128),tx=s(41214),tm=s(36165),tf=s(27648),tj=s(61273),tv=s(8498);let tb=(0,p.memo)(e=>{let{placeholder:t,searchTerm:s,onSearch:i}=e;return(0,o.jsx)(W.k,{position:"relative",alignItems:"center",pl:3,pr:{base:3,lg:1},mt:{base:3,lg:1},children:(0,o.jsxs)(K.B,{children:[(0,o.jsx)(N.Z,{children:(0,o.jsx)(tv.W,{color:"text.subtle"})}),(0,o.jsx)(O.I,{type:"text",variant:"filled",placeholder:null!=t?t:"",value:s,borderWidth:0,onChange:e=>{i(e.target.value)},id:"searchField"}),s&&(0,o.jsx)(N.x,{children:(0,o.jsx)(B.h,{size:"xs",isRound:!0,variant:"ghost","aria-label":"clear chat",icon:(0,o.jsx)(tj._0w,{}),onClick:()=>{i("")}})})]})})});tb.displayName="Search";var tS=s(8554);let ty=()=>{let e=(0,v.Sz)(G.St,e=>e.id),{data:t}=(0,tS.PE)(e);if(t)return(0,o.jsxs)(W.k,{ml:"auto",p:1,borderWidth:1,borderColor:"border.base",bgColor:"background.surface.muted",borderRadius:"full",children:[t.sort((e,t)=>{var s,i;return(null!==(s=t.lastUsed)&&void 0!==s?s:0)-(null!==(i=e.lastUsed)&&void 0!==i?i:0)}).slice(0,3).map((e,s)=>(0,o.jsx)(tt.q,{name:e.name,src:e.photo,zIndex:t.length-s,boxSize:"1.25rem",ml:"-0.75rem",_first:{ml:0},cursor:"pointer",ignoreFallback:!0},e.id)),(null==t?void 0:t.length)>3&&(0,o.jsx)(ep.M,{fontSize:"xs",px:2,color:"text.base",children:"+".concat(t.length-3)})]})};var tw=s(58528);let tk={base:"calc(env(safe-area-inset-bottom, 1rem) + 0.5rem)",md:2},tC={base:3,lg:1},tz=(0,o.jsx)(q.lhV,{}),tI=(0,o.jsx)(tp.c,{borderColor:"border.base"});(i=r||(r={})).CHAT="chat",i.MENU="menu";let tR=e=>{let{isOpen:t,items:s,itemComponent:i,folderComponent:n,footerComponent:r,searchTerm:a,isV2:c,handleSearchTerm:d,handleDrop:u,toggleOpen:g}=e,x=(0,h.useTranslations)(),m=(0,l.useRouter)(),{onOpen:j}=(0,to.R)("upgrade"),{clearSelectedConversation:b}=(0,ta.uu)(),S=(0,v.Sz)(G.St,e=>e.isProUser),[C]=(0,tg.a)("(min-width: ".concat(tw.A.lg,")")),z=e=>{e.preventDefault()},I=e=>{e.target.style.background="#343541"},R=e=>{e.target.style.background="none"},M=(0,p.useCallback)(()=>{c||b(),C||g()},[b,C,c,g]),P=(0,p.useCallback)(()=>{C||g(),S?m.push("/character-chat"):j()},[C,S,j,m,g]),E=(0,p.useMemo)(()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tb,{placeholder:x("sidebar.search.placeholder"),searchTerm:a,onSearch:d}),(0,o.jsxs)(y.K,{pl:3,pr:tC,children:[(0,o.jsxs)(T.z,{size:"md",px:2,height:"auto",minHeight:"auto",py:2,variant:"ghost",fontSize:"sm",justifyContent:"flex-start",gap:2,as:tf.default,href:"/token",onClick:M,children:[(0,o.jsx)(ep.M,{boxSize:8,bg:"var(--muted)",borderRadius:"lg",borderColor:"border.base",borderWidth:1,children:(0,o.jsx)(q.MQc,{})}),x("nav.token")]}),(0,o.jsxs)(T.z,{size:"md",px:2,height:"auto",minHeight:"auto",py:2,variant:"ghost",fontSize:"sm",justifyContent:"flex-start",gap:2,as:tf.default,href:c?"/v2":"/chat",onClick:M,children:[(0,o.jsx)(ep.M,{boxSize:8,bg:"var(--muted)",borderRadius:"lg",borderColor:"border.base",borderWidth:1,children:(0,o.jsx)(q.Rwq,{})}),x("nav.chat")]}),(0,o.jsxs)(T.z,{size:"md",px:2,py:2,height:"auto",minHeight:"auto",variant:"ghost",fontSize:"sm",justifyContent:"flex-start",gap:2,onClick:P,children:[(0,o.jsx)(ep.M,{boxSize:8,bg:"var(--muted)",borderRadius:"lg",borderColor:"border.base",borderWidth:1,children:(0,o.jsx)(q.Kam,{})}),(0,o.jsxs)(W.k,{gap:2,alignItems:"center",children:[x("nav.characters"),(0,o.jsx)(ek.Vp,{size:"sm",ml:"auto",colorScheme:"purple",children:x(S?"common.new":"common.pro")})]}),(0,o.jsx)(ty,{})]})]}),(0,o.jsxs)(y.K,{mt:2,pl:3,pr:{base:3,lg:1},spacing:2,divider:tI,overflow:"auto",flexGrow:1,children:[(0,o.jsx)(W.k,{children:n}),(null==s?void 0:s.length)>0?(0,o.jsx)("div",{onDrop:u,onDragOver:z,onDragEnter:I,onDragLeave:R,children:i}):(0,o.jsxs)(W.k,{mt:8,flexDir:"column",alignItems:"center",textAlign:"center",gap:4,color:"text.subtle",opacity:"0.5",children:[(0,o.jsx)(tj.TpC,{}),(0,o.jsx)(k.x,{size:"sm",children:x("sidebar.chats.description")})]})]})]}),[n,P,u,M,d,S,c,i,null==s?void 0:s.length,a,x]);return C?(0,o.jsx)(W.k,{position:"sticky",top:0,overflow:"hidden",transitionProperty:"width",transitionDuration:"normal",width:t?"320px":"0px",flexShrink:0,children:(0,o.jsx)(W.k,{width:"320px",whiteSpace:"nowrap",children:(0,o.jsxs)(W.k,{pb:tk,pt:{base:4,md:3},width:"full",flexDir:"column",overflow:"hidden",gap:2,children:[E,r]})})}):(0,o.jsxs)(tx.d,{blockScrollOnMount:!1,isOpen:t,onClose:g,placement:"left",children:[(0,o.jsx)(f.Z,{}),(0,o.jsxs)(tm.s,{maxWidth:"85%",children:[(0,o.jsx)(B.h,{position:"absolute",right:"-2.5rem","aria-label":"close",onClick:g,icon:tz,top:"env(safe-area-inset-top, 30px)"}),(0,o.jsx)(w.f,{p:0,display:"flex",children:(0,o.jsxs)(W.k,{pb:tk,pt:"env(safe-area-inset-top)",width:"full",flexDir:"column",overflow:"hidden",gap:2,children:[E,r]})})]})]})},tT={searchTerm:""};var tM=s(22048);let tP=(0,p.memo)(()=>{let e=(0,h.useTranslations)(),[t]=(0,tg.a)("(min-width: ".concat(tw.A.md,")"),{ssr:!1});(function(){let e=(0,v.Sz)(G.St,e=>e.userName),t=(0,v.Sz)(G.St,e=>e.isSignedIn),s=(0,v.Sz)(G.St,e=>e.id),i=void 0!==window.zE,n=(0,p.useCallback)(async()=>{try{let t=await fetch("/api/auth/zendesk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:e})}),s=await t.json();s.jwt&&window.zE("messenger","loginUser",e=>e(s.jwt))}catch(e){tM.Tb(e)}},[e]);(0,p.useEffect)(()=>{s&&t&&i&&n()},[n,t,s,i])})();let{state:{showSettingsModal:s,showChatbar:i},dispatch:n}=(0,_.IO)(),r=(0,p.useCallback)(()=>{t||n({field:"showChatbar",value:!i}),n({field:"showSettingsModal",value:!s})},[n,t,i,s]),a=(0,p.useCallback)(()=>{void 0!==window.zE&&(t||n({field:"showChatbar",value:!i}),window.zE("messenger","open"))},[n,t,i]);return(0,o.jsxs)(y.K,{borderTopWidth:1,borderColor:"border.base",pl:2,pt:2,pr:{base:2,lg:0},children:[(0,o.jsx)(T.z,{display:"flex",height:"auto",gap:3,alignItems:"center",variant:"ghost",borderRadius:"lg",pl:2,py:2,onClick:r,children:(0,o.jsx)(tn,{showProTag:!0,subText:(0,o.jsx)(e9,{}),size:"md",flex:1,justifyContent:"space-between",showDots:!0})}),(0,o.jsxs)(y.K,{spacing:4,py:2,px:2,children:[(0,o.jsx)(T.z,{justifyContent:"flex-start",color:"text.link",variant:"link",as:eP.r,href:"/home",children:e("chatBar.learnAboutVenice.cta")}),(0,o.jsx)(T.z,{variant:"link",fontWeight:"medium",color:"text.link",justifyContent:"flex-start",onClick:a,children:e("chatBar.submitFeedback.cta")})]})]})});tP.displayName="ChatbarSettings";var tE=s(59892);let tD={color:"text.primary.base"},tF={boxShadow:"none"},tA=(0,o.jsx)(q.e6w,{}),tL=(0,o.jsx)(q.lhV,{}),tK=(0,o.jsx)(q.Lik,{}),tO=(0,o.jsx)(q.EF5,{}),tN=(0,o.jsx)(q.HXz,{}),tB=(0,p.memo)(e=>{let{conversation:t,onExportData:s,baseUrl:i="/chat"}=e,n=(0,h.useTranslations)(),r=(0,l.usePathname)(),a=(0,l.useRouter)(),c=r==="".concat(i,"/").concat(t.id),{attributes:u,listeners:g,setNodeRef:x,transform:m,isDragging:f}=(0,d.O1)({id:t.id,data:{title:t.name}}),{state:{messageIsStreaming:j}}=(0,_.IO)(),{selectedConversation:b,setSelectedConversation:S,updateConversation:y}=(0,ta.uu)(),{handleDeleteConversation:w}=(0,p.useContext)(eQ),k=(0,v.Sz)(G.St,e=>e.isVeniceStaff),[C,z]=(0,p.useState)(!1),[I,R]=(0,p.useState)(!1),[M,P]=(0,p.useState)(""),E=(0,p.useCallback)(async e=>{M.trim().length>0&&(await y({...e,name:M}),P(""),R(!1))},[M,y]),D=(0,p.useCallback)(async e=>{"Enter"===e.key&&(e.preventDefault(),b&&await E(b))},[E,b]),F=(0,p.useCallback)(async e=>{e.stopPropagation(),I&&await E(t),R(!1)},[t,E,I]),A=(0,p.useCallback)(e=>{e.stopPropagation(),R(!1)},[]),L=(0,p.useCallback)(e=>{e.stopPropagation(),R(!0),b&&P(b.name)},[b]),K=(0,p.useCallback)(async e=>{if(e.stopPropagation(),z(!0),!confirm(n("chatBar.conversations.delete.confirmation"))){z(!1);return}await w(t),z(!1)},[t,w,n]),N=(0,p.useCallback)(e=>{P(e.target.value)},[]),U=(0,p.useCallback)(()=>{f||(S(t),a.push("".concat(i,"/").concat(t.id)))},[t,a,i,f,S]),H=(0,p.useCallback)(()=>{s(t.id)},[t.id,s]);(0,p.useEffect)(()=>{I?z(!1):C&&R(!1)},[I,C]);let X=(0,p.useMemo)(()=>({transform:tE.ux.Translate.toString(m)}),[m]);return(0,o.jsxs)(W.k,{position:"relative",alignItems:"center",className:"relative flex items-center",children:[I&&c?(0,o.jsx)(W.k,{width:"full",alignItems:"center",gap:2,px:2,borderRadius:"lg",bg:"background.button.secondary.hover",children:(0,o.jsx)(O.I,{type:"text",fontWeight:"medium",mr:14,overflow:"hidden",textOverflow:"ellipsis",bg:"transparent",borderWidth:0,boxShadow:"none",fontSize:"md",_focus:tF,value:M,px:0,onChange:N,onKeyDown:D,autoFocus:!0})}):(0,o.jsx)(T.z,{onClick:U,disabled:j,draggable:"true",ref:x,isActive:c,variant:"ghost",colorScheme:"secondary",borderRadius:"lg",fontWeight:"normal",px:3,py:5,ml:t.folderId?"1.4rem":"0",style:X,width:"full",...u,...g,children:(0,o.jsx)(eo.xu,{position:"relative",flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordBreak:"break-all",textAlign:"left",pl:0,ml:0,pr:c?k?"5rem":"4rem":1,children:t.name})}),(C||I)&&c&&(0,o.jsxs)(W.k,{right:1,zIndex:"10",position:"absolute",children:[(0,o.jsx)(B.h,{isActive:c,variant:"solid",fontSize:"lg",icon:tA,"aria-label":"confirm",onClick:F,mr:1}),(0,o.jsx)(B.h,{isActive:c,variant:"solid",fontSize:"lg","aria-label":"Cancel",icon:tL,onClick:A,_hover:tD})]}),c&&!C&&!I&&!f&&(0,o.jsxs)(W.k,{right:1,zIndex:"10",position:"absolute",children:[(0,o.jsx)(B.h,{size:"sm","aria-label":n("chatBar.conversations.rename.cta"),icon:tK,fontSize:"lg",color:"text.secondary.muted",onClick:L,variant:"ghost"}),(0,o.jsx)(B.h,{size:"sm","aria-label":n("chatBar.conversations.delete.cta"),icon:tO,fontSize:"lg",color:"text.secondary.muted",onClick:K,variant:"ghost"}),(0,o.jsx)(B.h,{size:"sm","aria-label":n("chatBar.conversations.export.cta"),icon:tN,fontSize:"lg",color:"text.secondary.muted",onClick:H,variant:"ghost"})]})]})});tB.displayName="ConversationComponent";var tW=s(47672),tU=e=>{var t;let{currentFolder:s,searchTerm:i,folderComponent:n}=e,{handleDeleteFolder:r,handleUpdateFolder:a}=(0,_.IO)(),{conversations:c}=(0,ta.uu)(),u=(0,l.usePathname)(),{setNodeRef:h,isOver:g}=(0,d.Zj)({id:s.id}),{data:x}=(0,tS.sF)(null!==(t=s.characterId)&&void 0!==t?t:""),[m,f]=(0,p.useState)(!1),[j,v]=(0,p.useState)(!1),[b,S]=(0,p.useState)(""),[y,w]=(0,p.useState)(!1),k=async e=>{"Enter"===e.key&&(e.preventDefault(),await C())},C=(0,p.useCallback)(async()=>{await a(s.id,b),S(""),v(!1)},[s.id,a,b]),z=(0,p.useCallback)(async e=>{e.stopPropagation(),m?await r(s.id):j&&await C(),f(!1),v(!1)},[s.id,r,C,m,j]);return(0,p.useEffect)(()=>{j?f(!1):m&&v(!1)},[j,m]),(0,p.useEffect)(()=>{i?w(!0):w(!1)},[i]),(0,p.useEffect)(()=>{c&&c.filter(e=>e.folderId===s.id).some(e=>u==="/chat/".concat(e.id))&&w(!0)},[c,s.id,u]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(W.k,{position:"relative",alignItems:"center",className:"relative flex items-center",width:"full",children:[j?(0,o.jsxs)(W.k,{width:"full",alignItems:"center",gap:2,px:2,fontSize:"lg",children:[y?(0,o.jsx)(q.YW4,{}):(0,o.jsx)(q.mzH,{}),(0,o.jsx)(O.I,{type:"text",fontWeight:"bold",mr:14,overflow:"hidden",textOverflow:"ellipsis",bg:"transparent",borderWidth:0,boxShadow:"none",_focus:{boxShadow:"none"},fontSize:"sm",px:0,value:b,onChange:e=>S(e.target.value),onKeyDown:k,autoFocus:!0})]}):(0,o.jsx)(T.z,{flex:1,variant:"ghost",px:2,py:5,pr:x?24:2,onClick:()=>w(!y),ref:h,isActive:g,justifyContent:"flex-start",leftIcon:y?(0,o.jsx)(q.YW4,{}):(0,o.jsx)(q.mzH,{}),children:(0,o.jsxs)(W.k,{gap:2,alignItems:"center",overflow:"hidden",children:[x&&(0,o.jsx)(tt.q,{size:"xs",src:x.photo,ignoreFallback:!0}),(0,o.jsx)(eo.xu,{position:"relative",maxHeight:5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordBreak:"break-all",fontSize:"sm",children:x?x.name:s.name})]})}),(m||j)&&(0,o.jsxs)(W.k,{position:"absolute",right:1,zIndex:"4",children:[(0,o.jsx)(B.h,{"aria-label":"done",size:"sm",fontSize:"lg",variant:"ghost",icon:(0,o.jsx)(q.e6w,{}),onClick:z}),(0,o.jsx)(B.h,{"aria-label":"done",size:"sm",fontSize:"lg",variant:"ghost",icon:(0,o.jsx)(q.lhV,{}),onClick:e=>{e.stopPropagation(),f(!1),v(!1)}})]}),!m&&!j&&(0,o.jsxs)(W.k,{position:"absolute",right:1,zIndex:"4",children:[x&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(tW.M,{characterId:x.id,as:B.h,icon:(0,o.jsx)(q.ZIz,{}),variant:"ghost"})}),!x&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(B.h,{"aria-label":"done",variant:"ghost",size:"sm",fontSize:"lg",icon:(0,o.jsx)(q.Lik,{}),onClick:e=>{e.stopPropagation(),v(!0),S(s.name)}}),(0,o.jsx)(B.h,{"aria-label":"done",variant:"ghost",size:"sm",fontSize:"lg",icon:(0,o.jsx)(q.EF5,{}),onClick:e=>{e.stopPropagation(),f(!0)}})]})]})]}),y?n:null]})};let tH=(0,o.jsx)(q.MP7,{}),tX=e=>{let{searchTerm:t}=e,s=(0,h.useTranslations)(),{state:{folders:i},handleCreateFolder:n}=(0,_.IO)(),{handleExportConversation:r}=(0,p.useContext)(eQ),{conversations:a,updateConversation:l,lookupConversationById:c}=(0,ta.uu)(),d=(0,p.useCallback)(async()=>{await n("New folder","chat"),(0,x.Qe)({name:"createdNewFolder",data:{}})},[n]),u=async(e,t)=>{if(e.dataTransfer){let s=JSON.parse(e.dataTransfer.getData("conversationId")),i=await c(s);i&&await l({...i,folderId:t.id})}},g=e=>a?a.filter(e=>e.folderId).map((t,s)=>{if(t.folderId===e.id)return(0,o.jsx)("div",{children:(0,o.jsx)(tB,{conversation:t,onExportData:r})},s)}):[];return(0,o.jsxs)(y.K,{width:"full",flexDir:"column",children:[(0,o.jsxs)(W.k,{justifyContent:"space-between",alignItems:"center",pr:1,children:[(0,o.jsx)(k.x,{fontSize:"sm",color:"text.subtlest",textTransform:"uppercase",px:3,py:2,fontWeight:"bold",children:"Folders"}),(0,o.jsx)(B.h,{icon:tH,variant:"ghost",fontSize:"lg",size:"sm","aria-label":s("sidebar.chats.addFolder"),onClick:d})]}),i.filter(e=>"chat"===e.type).sort((e,t)=>e.name.localeCompare(t.name)).map((e,s)=>(0,o.jsx)(tU,{searchTerm:t,currentFolder:e,handleDrop:u,folderComponent:g(e)},s))]})},tZ=(0,p.memo)(e=>{let{conversations:t,baseUrl:s="/chat"}=e,{handleExportConversation:i}=(0,p.useContext)(eQ),n=(0,p.useMemo)(()=>t.filter(e=>!e.folderId).slice().reverse().map((e,t)=>(0,o.jsx)(tB,{conversation:e,onExportData:i,baseUrl:s},t)),[s,t,i]);return(0,o.jsxs)(W.k,{width:"full",flexDir:"column",gap:0,children:[(0,o.jsx)(k.x,{color:"text.subtlest",fontSize:"sm",textTransform:"uppercase",fontWeight:"bold",px:3,py:2,children:"Chats"}),n]})});tZ.displayName="Conversations";var tq=s(49270);(n=a||(a={})).JSON="json",n.MARKDOWN="markdown";let t_=e=>{let t="# Conversation: ".concat(e.name,"\n\n");return e.messages.forEach((s,i)=>{if(t+="***",s.updatedAtUnixTimestamp&&(t+="".concat(new Date(s.updatedAtUnixTimestamp).toLocaleString()," - ")),t+="".concat("assistant"===s.role?"Venice":"User",":***\n\n"),s.contentBinary)t+="[Generated Image]\n\n";else{let{content:e,references:i=[]}=s;t+="".concat(e,"\n\n"),i.map((e,s)=>{t+="[".concat(s+1," ").concat(e.title,"](").concat(e.url,")\n\n")})}i!==e.messages.length-1&&(t+="---\n\n")}),t},tV=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json";try{let s,i;let n=await eW.db.conversations.get(e),r=await eW.db.messages.where("conversationId").equals(e).sortBy("updatedAtUnixTimestamp"),a={...n,messages:r||[]},o=(null==n?void 0:n.name)?n.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]+/g,"").replace(/-+$/,""):e,l=new Date().getTime();if("markdown"===t){let e=t_(a);s=new Blob([e],{type:"text/plain"}),i="".concat(o,"-").concat(l,"-export.txt")}else s=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),i="".concat(o,"-{").concat(l,"}-export.json");let c=URL.createObjectURL(s),d=document.createElement("a");return d.download=i,d.href=c,d.style.display="none",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),!0}catch(e){return console.error("Error exporting data",e),null}},tG=e=>{let{isOpen:t,onClose:s,conversationId:i}=e,[n,r]=(0,p.useState)(!1),l=(0,D.p)(),c=(0,h.useTranslations)("exportModal"),d=(0,v.Sz)(G.St,e=>e.isVeniceStaff),u=async e=>{i&&(r(!0),await tV(i,e)?(l({title:c("success"),status:"success",duration:5e3,isClosable:!0,position:"bottom-right"}),s()):l({title:c("error"),status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}))};return(0,o.jsxs)(m.u_,{isOpen:t,onClose:s,size:"md",isCentered:!0,children:[(0,o.jsx)(f.Z,{}),(0,o.jsxs)(j.h,{children:[(0,o.jsx)(eK.o,{}),(0,o.jsx)(tq.x,{children:c("title")}),(0,o.jsx)(w.f,{children:(0,o.jsx)(k.x,{color:"text.subtle",children:c("body")})}),(0,o.jsxs)(R.m,{gap:4,children:[d&&(0,o.jsx)(T.z,{variant:"outline",size:"md",onClick:()=>u(a.JSON),children:c("ctaJSON")}),(0,o.jsx)(T.z,{size:"md",colorScheme:"primary",isLoading:n,onClick:()=>u(a.MARKDOWN),children:c("cta")})]})]})]})};var tQ=s(24387),tJ=s(86573),tY=s(18254);let t$=(0,p.memo)(()=>{let e=(0,h.useTranslations)(),t=(0,l.useRouter)(),[s,i]=(0,p.useState)(),{isOpen:n,onClose:r,onOpen:a}=(0,c.q)(),m=(0,d.Dy)((0,d.VT)(d.LO,{activationConstraint:{delay:500,tolerance:10}}),(0,d.VT)(d.MA,{activationConstraint:{distance:8}})),{clearConversations:f,conversations:j,deleteConversation:v,updateConversation:b,selectedConversation:S,clearSelectedConversation:y,lookupConversationById:w,createNewConversation:k,setSelectedConversation:C}=(0,ta.uu)(),z=(0,tJ.L)({initialState:tT}),{state:{showChatbar:I,folders:R,showSettingsModal:T},dispatch:M,handleCreateFolder:P}=(0,_.IO)(),E=(0,p.useMemo)(()=>I,[I]),{state:{searchTerm:D},dispatch:F}=z,A=(0,p.useMemo)(()=>D.length>0,[D]),L=(0,p.useMemo)(()=>j?null==j?void 0:j.sort((e,t)=>e.updatedAtUnixTimestamp-t.updatedAtUnixTimestamp):[],[j]),K=(0,p.useCallback)(async()=>{M({field:"loading",value:!0});let e=await k(tY.i.Text);window.history.pushState({},"","/chat/".concat(e.id)),C(e),(0,x.Qe)({name:"createdNewChat",data:{}}),M({field:"loading",value:!1})},[k,M,C]),O=(0,p.useCallback)(async()=>{f();let e=R.filter(e=>"chat"!==e.type);M({field:"folders",value:e}),await (0,tQ._K)(e),window.history.pushState({},"","/chat")},[f,R,M]),N=(0,p.useCallback)(async e=>{(0,x.Qe)({name:"deletedConversation",data:{}}),await v(e.id),F({field:"searchTerm",value:""}),S&&S.id===e.id&&(y(),t.push("/chat"))},[F,y,v,t,S]),B=(0,p.useCallback)(async()=>{await P("New folder","chat"),(0,x.Qe)({name:"createdNewFolder",data:{}})},[P]),W=(0,p.useCallback)(()=>{M({field:"showChatbar",value:!I}),g.Z.setItem("showChatbar",JSON.stringify(!I)),(0,x.Qe)({name:"toggledChatbar",data:{value:!I}})},[M,I]),U=(0,p.useCallback)(()=>{M({field:"showSettingsModal",value:!T}),(0,x.Qe)({name:"toggledSettingsModal",data:{value:!T}})},[M,T]),H=(0,p.useCallback)(async e=>{var t;e.activatorEvent.preventDefault();let s=e.active.id,i=null===(t=e.over)||void 0===t?void 0:t.id,n=await w(s);await b({...n,folderId:null!=i?i:null})},[w,b]),X=(0,p.useCallback)(async e=>{if(e.dataTransfer){let t=JSON.parse(e.dataTransfer.getData("conversationId")),s=await w(t);await b({...s,folderId:"0"}),F({field:"searchTerm",value:""}),e.target.style.background="none",(0,x.Qe)({name:"organizedChatbar",data:{}})}},[F,w,b]),Z=(0,p.useCallback)((e,t)=>t?"string"!=typeof t?[]:(0,u.Lu)(e,t,{keys:["name"],threshold:u.Lu.rankings.CONTAINS,sorter:e=>e.sort((e,t)=>e.item.updatedAtUnixTimestamp-t.item.updatedAtUnixTimestamp)}):e,[]),q=(0,p.useMemo)(()=>D&&A?Z(L,D):L,[Z,A,D,L]),V=(0,p.useMemo)(()=>(0,o.jsx)(tZ,{conversations:q}),[q]),G=(0,p.useMemo)(()=>(0,o.jsx)(tX,{searchTerm:D}),[D]),Q=(0,p.useCallback)(e=>{F({field:"searchTerm",value:e})},[F]),J=(0,p.useMemo)(()=>(0,o.jsx)(tP,{}),[]),Y=(0,p.useCallback)(e=>{i(e),a()},[a]);return(0,o.jsxs)(eQ.Provider,{value:{...z,handleDeleteConversation:N,handleClearConversations:O,handleExportConversation:Y},children:[(0,o.jsx)(d.LB,{onDragEnd:H,sensors:m,children:(0,o.jsx)(tR,{side:"left",isOpen:E,addItemButtonTitle:e("newChat"),itemComponent:V,folders:R,folderComponent:G,items:q,searchTerm:D,handleSearchTerm:Q,toggleOpen:W,handleCreateItem:K,handleCreateFolder:B,handleDrop:X,footerComponent:J})}),(0,o.jsx)(th,{isOpen:T,onClose:U}),n&&(0,o.jsx)(tG,{isOpen:n,onClose:r,conversationId:s})]})});t$.displayName="Chatbar";var t0=s(77612),t1=s(11593);let t2=(0,p.memo)(()=>{let e=(0,h.useTranslations)(),t=(0,v.Sz)(G.St,e=>e.id),s=(0,l.useRouter)(),[i,n]=(0,p.useState)(),{isOpen:r,onClose:a,onOpen:m}=(0,c.q)(),f=(0,d.Dy)((0,d.VT)(d.LO,{activationConstraint:{delay:500,tolerance:10}}),(0,d.VT)(d.MA,{activationConstraint:{distance:8}})),{clearConversations:j,deleteConversation:b,updateConversation:S,selectedConversation:y,clearSelectedConversation:w,lookupConversationById:k,createNewConversation:C,setSelectedConversation:z}=(0,ta.uu)(),{data:I}=(0,t1.WF)(t),R=(0,tJ.L)({initialState:t0.E}),{state:{showChatbar:T,folders:M,showSettingsModal:P},dispatch:E,handleCreateFolder:D}=(0,_.IO)(),F=(0,p.useMemo)(()=>T,[T]),{state:{searchTerm:A},dispatch:L}=R,K=(0,p.useMemo)(()=>A.length>0,[A]),O=(0,p.useMemo)(()=>I?null==I?void 0:I.sort((e,t)=>e.updatedAtUnixTimestamp-t.updatedAtUnixTimestamp):[],[I]),N=(0,p.useCallback)(async()=>{E({field:"loading",value:!0});let e=await C(tY.i.Text);window.history.pushState({},"","/chat/".concat(e.id)),z(e),(0,x.Qe)({name:"createdNewChat",data:{}}),E({field:"loading",value:!1})},[C,E,z]),B=(0,p.useCallback)(async()=>{j();let e=M.filter(e=>"chat"!==e.type);E({field:"folders",value:e}),await (0,tQ._K)(e),window.history.pushState({},"","/chat")},[j,M,E]),W=(0,p.useCallback)(async e=>{(0,x.Qe)({name:"deletedConversation",data:{}}),await b(e.id),L({field:"searchTerm",value:""}),y&&y.id===e.id&&(w(),s.push("/chat"))},[L,w,b,s,y]),U=(0,p.useCallback)(async()=>{await D("New folder","chat"),(0,x.Qe)({name:"createdNewFolder",data:{}})},[D]),H=(0,p.useCallback)(()=>{E({field:"showChatbar",value:!T}),g.Z.setItem("showChatbar",JSON.stringify(!T)),(0,x.Qe)({name:"toggledChatbar",data:{value:!T}})},[E,T]),X=(0,p.useCallback)(()=>{E({field:"showSettingsModal",value:!P}),(0,x.Qe)({name:"toggledSettingsModal",data:{value:!P}})},[E,P]),Z=(0,p.useCallback)(async e=>{var t;e.activatorEvent.preventDefault();let s=e.active.id,i=null===(t=e.over)||void 0===t?void 0:t.id,n=await k(s);await S({...n,folderId:null!=i?i:null})},[k,S]),q=(0,p.useCallback)(async e=>{if(e.dataTransfer){let t=JSON.parse(e.dataTransfer.getData("conversationId")),s=await k(t);await S({...s,folderId:"0"}),L({field:"searchTerm",value:""}),e.target.style.background="none",(0,x.Qe)({name:"organizedChatbar",data:{}})}},[L,k,S]),V=(0,p.useCallback)((e,t)=>t?"string"!=typeof t?[]:(0,u.Lu)(e,t,{keys:["name"],threshold:u.Lu.rankings.CONTAINS,sorter:e=>e.sort((e,t)=>e.item.updatedAtUnixTimestamp-t.item.updatedAtUnixTimestamp)}):e,[]),Q=(0,p.useMemo)(()=>A&&K?V(O,A):O,[V,K,A,O]),J=(0,p.useMemo)(()=>(0,o.jsx)(tZ,{baseUrl:"/v2",conversations:Q}),[Q]),Y=(0,p.useMemo)(()=>(0,o.jsx)(tX,{searchTerm:A}),[A]),$=(0,p.useCallback)(e=>{L({field:"searchTerm",value:e})},[L]),ee=(0,p.useMemo)(()=>(0,o.jsx)(tP,{}),[]),et=(0,p.useCallback)(e=>{n(e),m()},[m]);return(0,o.jsxs)(eQ.Provider,{value:{...R,handleDeleteConversation:W,handleClearConversations:B,handleExportConversation:et},children:[(0,o.jsx)(d.LB,{onDragEnd:Z,sensors:f,children:(0,o.jsx)(tR,{side:"left",isOpen:F,addItemButtonTitle:e("newChat"),itemComponent:J,folders:M,folderComponent:Y,items:Q,searchTerm:A,handleSearchTerm:$,toggleOpen:H,handleCreateItem:N,handleCreateFolder:U,handleDrop:q,footerComponent:ee,isV2:!0})}),(0,o.jsx)(th,{isOpen:P,onClose:X}),r&&(0,o.jsx)(tG,{isOpen:r,onClose:a,conversationId:i})]})});t2.displayName="Chatbar";let t4=()=>{let e=(0,l.usePathname)();return(null==e?void 0:e.includes("v2"))?(0,o.jsx)(t2,{}):(0,o.jsx)(t$,{})}},41124:function(e,t,s){"use strict";s.d(t,{r:function(){return o}});var i=s(57437),n=s(57174),r=s(25730);let a=(0,i.jsx)(n.R,{}),o=e=>(0,i.jsx)(r.h,{variant:"ghost",icon:a,fontSize:"xl",size:"md",isRound:!0,"aria-label":"back",...e})},10187:function(e,t,s){"use strict";s.d(t,{default:function(){return a}});var i=s(57437),n=s(86827),r=s(74386);function a(e){let{altLogo:t,children:s}=e;return(0,i.jsxs)(n.M,{width:"100vw",height:"100dvh",flexDir:"column",gap:4,children:[(0,i.jsx)(r.K,{boxSize:"150px",color:t?"text.link":"text.base"}),s]})}},7717:function(e,t,s){"use strict";s.d(t,{Z:function(){return p}});var i=s(57437),n=s(91092),r=s(37354),a=s(13449),o=s(4360),l=s(22053),c=s(83657),d=s(45168),u=s(41425);let h=(0,i.jsx)(n.c,{borderColor:"border.base"}),p=e=>{let{title:t,rightComponent:s,tooltipBody:n,onClick:p,containerProps:g,flexProps:x,...m}=e;return(0,i.jsxs)(r.Z,{py:4,gap:1,boxShadow:"none",...g,children:[t&&(0,i.jsxs)(a.k,{px:4,mt:2,justifyContent:"space-between",alignItems:"center",onClick:p,cursor:p?"pointer":"inherit",...x,children:[(0,i.jsxs)(a.k,{gap:2,alignItems:"center",children:[(0,i.jsx)(o.x,{fontSize:"sm",fontWeight:"semibold",color:"text.base",children:t}),n&&(0,i.jsx)(u.x,{label:n,children:(0,i.jsx)(l.xu,{as:"span",color:"text.subtle",children:(0,i.jsx)(d.Qoz,{})})})]}),s]}),(0,i.jsx)(c.K,{divider:h,spacing:0,overflow:"hidden",...m})]})}},7414:function(e,t,s){"use strict";s.d(t,{X:function(){return u}});var i=s(57437),n=s(31384),r=s(13449),a=s(4360),o=s(72499),l=s(22053),c=s(45168),d=s(41425);let u=e=>{let{heading:t,icon:s,body:u,children:h,layout:p="inline",tooltipBody:g,onClick:x,hideChildren:m,hiddenMessage:f,rowProps:j,stackProps:v,badgeText:b,headingProps:S}=e;return(0,i.jsxs)(r.k,{columnGap:6,rowGap:4,justifyContent:"space-between",px:4,py:4,flexDir:"inline"===p?"row":"column",alignItems:"inline"===p?"center":"flex-start",width:"full",_last:{borderBottomRadius:"xl"},...j,...x&&{onClick:x,_hover:{bg:"background.button.secondary.hover"},_active:{bg:"background.button.secondary.pressed"},cursor:"pointer"},children:[t&&(0,i.jsxs)(r.k,{alignItems:"inline"===p?"flex-start":"center",width:"inline"===p?"auto":"full",justifyContent:"space-between",flexDir:"inline"===p?"column":"row",gap:2,minWidth:0,children:[(0,i.jsxs)(r.k,{gap:2,alignItems:"center",width:"100%",flexGrow:0,children:[s,(0,i.jsx)(a.x,{fontSize:"sm",flexGrow:0,fontWeight:"semibold",whiteSpace:"nowrap",color:"text.subtle",minWidth:0,overflow:"hidden",textOverflow:"ellipsis",...S,children:t}),b&&(0,i.jsx)(o.C,{colorScheme:"green",children:b}),g&&(0,i.jsx)(d.x,{label:g,children:(0,i.jsx)(l.xu,{as:"span",color:"text.subtle",children:(0,i.jsx)(c.Qoz,{})})})]}),!m&&u&&(0,i.jsx)(l.xu,{fontSize:"sm",children:u}),m&&f]}),h&&!m&&(0,i.jsx)(r.k,{flexDir:"inline"===p?"row":"column",gap:4,width:"inline"===p?"auto":"full",...v,children:h}),x&&(0,i.jsx)(n.m,{color:"text.subtle"})]})}},71272:function(e,t,s){"use strict";var i,n;s.d(t,{K:function(){return i}}),(n=i||(i={})).BackupHistory="backup-history",n.Settings="settings",n.PointHistory="point_history",n.ManageAccount="manage_account",n.ApiKeys="api_keys"},73595:function(e,t,s){"use strict";s.d(t,{m:function(){return J}});var i=s(57437),n=s(71416),r=s(37354),a=s(6924),o=s(4360),l=s(72499),c=s(16152),d=s(83657),u=s(61507),h=s(6314),p=s(34442),g=s(13449),x=s(13701),m=s(71632),f=s(42586),j=s(2265),v=s(45168),b=s(71272),S=s(38386),y=s(97244),w=s(78796),k=s(31631),C=s(97205),z=s(25730),I=s(22048),R=s(29827),T=s(21770);let M=()=>(0,i.jsxs)(r.Z,{bg:"var(--muted)",children:[(0,i.jsx)(S.O,{children:(0,i.jsx)(y.O,{width:"100px",height:"18px",startColor:"var(--secondary)",endColor:"var(--secondary-hover)"})}),(0,i.jsx)(a.e,{children:(0,i.jsx)(y.O,{height:"18px",startColor:"var(--secondary)",endColor:"var(--secondary-hover)"})})]}),P=e=>{let{id:t,description:s,last6Chars:n,createdAt:l}=e,c=(0,w.p)(),u=(0,R.NL)(),h=(0,f.useTranslations)(),p=(0,T.D)({mutationFn:async e=>{if(!(await fetch("/api/user/api_keys/destroy",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok)throw Error("Error deleting key")},onSuccess:async()=>{await u.invalidateQueries({queryKey:["api_keys"]}),c({title:h("settings.apiKeys.delete.toast.title"),status:"success"})}}),x=(0,j.useCallback)(async()=>{if(window.confirm(h("settings.apiKeys.delete.confirmation")))try{await p.mutateAsync(t)}catch(e){I.Tb(e),console.error(e)}},[p,t,h]);return(0,i.jsx)(r.Z,{overflow:"hidden",children:(0,i.jsx)(a.e,{children:(0,i.jsxs)(d.K,{spacing:0,children:[(0,i.jsxs)(g.k,{alignItems:"center",justifyContent:"space-between",mb:2,children:[(0,i.jsx)(k.X,{size:"sm",children:s}),(0,i.jsx)(C.h,{spacing:2,variant:"ghost",size:"sm",flexShrink:0,children:(0,i.jsx)(z.h,{onClick:x,fontSize:"xl",icon:(0,i.jsx)(v.EF5,{}),colorScheme:"red","aria-label":"Show",isLoading:"pending"===p.status})})]}),(0,i.jsxs)(d.K,{spacing:2,children:[(0,i.jsxs)(o.x,{whiteSpace:"nowrap",as:"p",overflow:"hidden",textOverflow:"ellipsis",fontFamily:"ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace",children:["*************************************",n]}),(0,i.jsxs)(o.x,{fontSize:"sm",color:"text.subtle",children:[h("settings.apiKeys.createdAt"),": ",new Date(l).toLocaleString()]})]})]})})})};var E=s(34096),D=s(27924),F=s(49270),A=s(95171),L=s(40748),K=s(12125),O=s(10883),N=s(68193),B=s(20517),W=s(34394),U=s(19383),H=s(48860),X=s(29501),Z=s(1914),q=s(93020);let _=e=>{let{isOpen:t,onClose:s}=e,n=(0,f.useTranslations)(),r=(0,R.NL)(),[a,o]=(0,j.useState)(null),{copyToClipboard:l,isCopied:d}=(0,Z.m)({timeout:2e3}),u=(0,T.D)({mutationFn:async e=>{let{description:t}=e,s=await fetch("/api/user/api_keys/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:t})});if(!s.ok)throw Error("Error creating key");return s.json()},onSuccess:async()=>{await r.invalidateQueries({queryKey:["api_keys"]})}}),{register:h,handleSubmit:p,reset:g,formState:{errors:m,isValid:b,isSubmitting:S}}=(0,X.cI)({defaultValues:{description:""},mode:"onChange"}),y=(0,j.useCallback)(async e=>{o(await u.mutateAsync(e))},[u]),w=(0,j.useCallback)(()=>{o(null),s(),g()},[s,g]),k=(0,j.useMemo)(()=>a?(0,i.jsxs)(E.h,{children:[(0,i.jsx)(D.o,{}),(0,i.jsx)(F.x,{children:n("settings.apiKeys.createModal.success.header")}),(0,i.jsx)(c.f,{children:(0,i.jsxs)(A.NI,{mt:4,children:[(0,i.jsx)(L.l,{children:n("settings.apiKeys.createModal.success.label")}),(0,i.jsxs)(K.B,{children:[(0,i.jsx)(O.I,{value:a.apiKey,isReadOnly:!0}),(0,i.jsx)(N.x,{children:(0,i.jsx)(z.h,{icon:d?(0,i.jsx)(v.e6w,{}):(0,i.jsx)(v.muo,{}),onClick:()=>l(a.apiKey),"aria-label":"Copy API key"})})]}),(0,i.jsx)(A.Q6,{children:n("settings.apiKeys.createModal.fields.apiKeyHelper")})]})}),(0,i.jsx)(B.m,{children:(0,i.jsx)(x.z,{colorScheme:"secondary",onClick:w,children:n("settings.apiKeys.createModal.cta.close")})})]}):(0,i.jsx)("form",{onSubmit:(0,q.I)(p(y)),children:(0,i.jsxs)(E.h,{children:[(0,i.jsx)(D.o,{}),(0,i.jsx)(F.x,{children:n("settings.apiKeys.createModal.header")}),(0,i.jsx)(c.f,{children:(0,i.jsxs)(A.NI,{isInvalid:!!m.description,children:[(0,i.jsx)(L.l,{children:n("settings.apiKeys.createModal.fields.description")}),(0,i.jsx)(O.I,{...h("description",{required:"Description is required"})}),m.description&&(0,i.jsx)(W.J1,{children:m.description.message})]})}),(0,i.jsxs)(B.m,{children:[(0,i.jsx)(x.z,{colorScheme:"secondary",mr:3,onClick:s,isDisabled:S,children:n("settings.apiKeys.createModal.cta.cancel")}),(0,i.jsx)(x.z,{colorScheme:"primary",type:"submit",isDisabled:!b,isLoading:S,children:n("settings.apiKeys.createModal.cta.create")})]})]})}),[l,m.description,w,p,d,S,b,a,s,y,h,n]);return(0,i.jsxs)(U.u_,{size:"md",isOpen:t,onClose:w,children:[(0,i.jsx)(H.Z,{}),k]})};var V=s(41124),G=s(86537),Q=s(72246);let J=e=>{let{setRoute:t,onClose:s}=e,S=(0,f.useTranslations)(),{isOpen:y,onOpen:w,onClose:k}=(0,n.q)(),{data:C,status:z}=(0,m.a)({queryKey:["api_keys"],queryFn:async()=>{let e=await fetch("/api/user/api_keys");if(!e.ok)throw Error("Error fetching keys");return e.json()}}),I=(0,j.useCallback)(()=>{s?s():t(b.K.Settings)},[s,t]),R=(0,j.useCallback)(()=>{let e=(null==C?void 0:C.length)===0?"/":"/api-reference/api-spec";window.open("https://docs.venice.ai/".concat(e),"_blank")},[C]),T=(0,j.useMemo)(()=>"pending"===z?(0,i.jsx)(M,{}):(null==C?void 0:C.length)===0?(0,i.jsx)(r.Z,{children:(0,i.jsxs)(a.e,{alignItems:"center",justifyContent:"center",display:"flex",flexDirection:"column",gap:2,children:[(0,i.jsx)(v.BS5,{size:48,color:"var(--muted)"}),(0,i.jsx)(o.x,{textAlign:"center",color:"text.subtle",children:S("settings.apiKeys.empty")})]})}):null==C?void 0:C.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).map(e=>(0,i.jsx)(P,{...e},e.id)),[C,z,S]),E=(0,i.jsx)(v.NQR,{});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(G.fK,{children:[(0,i.jsx)(G.fK.Left,{children:(0,i.jsx)(V.r,{onClick:I})}),(0,i.jsxs)(G.fK.Middle,{children:[(0,i.jsx)(v.BS5,{}),(0,i.jsxs)(Q.$,{children:[S("settings.apiKeys.header")," ",(0,i.jsx)(l.C,{colorScheme:"green",children:"Beta"})]})]})]}),(0,i.jsx)(c.f,{px:4,pb:4,children:(0,i.jsxs)(d.K,{spacing:4,children:[(0,i.jsxs)(u.b,{borderRadius:"lg",children:[(0,i.jsx)(h.z,{}),(0,i.jsx)(p.X,{fontSize:"sm",children:S("settings.apiKeys.description")})]}),(0,i.jsxs)(g.k,{justifyContent:"space-between",gap:2,flexWrap:"wrap",children:[(0,i.jsx)(x.z,{w:{base:"100%",md:"auto"},onClick:R,variant:"outline",leftIcon:E,size:"md","aria-label":"docs",children:"Docs"}),(0,i.jsx)(x.z,{w:{base:"100%",md:"auto"},size:"md",onClick:w,children:S("settings.apiKeys.cta.create")})]}),T]})}),(0,i.jsx)(_,{isOpen:y,onClose:k})]})}},25315:function(e,t,s){"use strict";s.d(t,{K1:function(){return v},YF:function(){return b}});var i=s(57437),n=s(78796),r=s(22048),a=s(29827),o=s(37065),l=s.n(o),c=s(42586),d=s(2265),u=s(25774),h=s(4271),p=s(74468),g=s(33458),x=s(63649),m=s(94197);let f="backup-context-upload",j=(0,u.kr)({}),v=e=>{let{children:t}=e,o=(0,c.useTranslations)("settings.encryptedBackup.create.progress"),u=(0,a.NL)(),{saveEncryptedBackup:v}=(0,m.Z)(),b=(0,n.p)(),S=(0,d.useRef)(null),y=(0,d.useRef)(),w=(0,d.useRef)(null),k=(0,d.useRef)(!1),C=(0,d.useRef)(0),z=(0,d.useRef)(new Set),[I,R]=(0,d.useState)(!1),[T,M]=(0,d.useState)(!1),[P,E]=(0,d.useState)(!1),[D,F]=(0,d.useState)(),[A,L]=(0,d.useState)(0),[K,O]=(0,d.useState)(""),N=(0,d.useCallback)(e=>(z.current.add(e),()=>z.current.delete(e)),[]),B=(0,d.useCallback)(e=>{z.current.forEach(t=>t(e))},[]),W=(0,d.useCallback)(()=>{var e;k.current=!0,E(!1),M(!1),null===(e=w.current)||void 0===e||e.postMessage({type:"cancel"})},[]);(0,d.useEffect)(()=>{w.current=new Worker(s.tu(new URL(s.p+s.u(7370),s.b)),{type:void 0});let e=e=>{E(!1),M(!1),k.current||F(o("createFailed")),k.current||r.Tb(e)},t=async(e,t,s,i,n)=>{try{console.log("Saving backup url"),L(.95),O(o("saving")),await v(e,i,s),L(1),R(!0),O(o("complete")),await u.invalidateQueries({queryKey:x.S.encryptedBackups(n)}),(0,p.Qe)({name:"encryptedBackupExported",data:{fileSizeInMb:t}})}catch(e){throw e}finally{E(!1),M(!1)}};return w.current.onmessage=s=>{let{downloadUrl:i,encodedNonce:n,error:r,message:a,name:l,fileSizeInMb:c,ownerId:d,type:u,progressMessage:h,progress:p,backupId:g}=s.data;if(g===C.current){if("started"===u)return L(0),O(o("starting")),E(!0),B("lock"),M(!0);if("db-export-complete"===u)return B("unlock"),E(!1);if("message"===u&&a)return console.log("Worker message:",a);if("progress"===u){L(p),O(o(h));return}if("error"===u||void 0===i||void 0===n||void 0===l||void 0===c||void 0===d)return e(null!=r?r:"Backup save failed");"success"===u&&t(i,c,n,l,d).catch(t=>e(t))}},w.current.onerror=e=>{k.current||console.error("Worker error:",e),k.current||F(o("createFailed")),E(!1),M(!1)},()=>{var e;return null===(e=w.current)||void 0===e?void 0:e.terminate()}},[]);let U=(0,d.useCallback)(l()((e,t,s)=>{var i;T||(C.current=C.current+1,k.current=!1,F(void 0),R(!1),L(0),O(o("starting")),null===(i=w.current)||void 0===i||i.postMessage({baseUrl:"".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.port?":"+window.location.port:""),ownerId:e,password:t,name:s,encryptionKey:(0,g.XR)(),backupId:C.current,type:"started"}))},1500),[g.XR,T]);(0,d.useEffect)(()=>{let e=()=>{y.current=setTimeout(()=>{b.close(f)},5e3)};return(()=>{if(y.current&&clearTimeout(y.current),T&&!b.isActive(f)){let e=b({render:()=>(0,i.jsx)(h.W,{cancel:W,cancelTitle:o("cancel"),description:K,progress:100*A}),id:f,duration:null,isClosable:!1,position:"top"});if(!e)return;return S.current=e}if(T&&b.isActive(f))return b.update(f,{render:()=>(0,i.jsx)(h.W,{cancel:W,cancelTitle:o("cancel"),description:K,progress:100*A})});if(!T&&b.isActive(f)){if(I)return e(),b.update(f,{render:()=>(0,i.jsx)(h.W,{cancelTitle:o("cancel"),description:o("complete"),progress:100})});if(D)return e(),b.update(f,{render:()=>(0,i.jsx)(h.W,{cancelTitle:o("cancel"),description:o("failed"),progress:0})});if(k.current)return e(),b.update(f,{render:()=>(0,i.jsx)(h.W,{cancelTitle:o("cancel"),description:o("cancelled"),progress:0})});e()}})(),()=>{y.current&&clearTimeout(y.current)}},[W,b,T,K,A,o]);let H=(0,d.useMemo)(()=>({createBackup:U,cancel:W,dbLocked:P,error:D,isRunning:T,progress:A,progressMessage:K,success:I,addDbLockListener:N}),[U,W,P,D,T,A,K,I,N]);return(0,i.jsx)(j.Provider,{value:H,children:t})},b=e=>(0,u.Sz)(j,e)},38236:function(e,t,s){"use strict";s.d(t,{H:function(){return b},W:function(){return S}});var i=s(57437),n=s(78796),r=s(22048),a=s(99411),o=s(42586),l=s(2265),c=s(36776),d=s(25774),u=s(74468),h=s(79482),p=s(51138),g=s(3490),x=s(14508),m=s(21846),f=s(18977),j=s(94197),v=s(93369);let b=(0,d.kr)({handleTextFileUpload:async()=>{},handleImageFileUpload:async()=>{},resetFileState:()=>{},setFiles:()=>{},isFileLoading:!1,fileName:"",fileType:"",fileText:"",fileTokens:0,files:[]}),S=e=>{let{children:t}=e,[s,d]=(0,l.useState)(!1),[S,y]=(0,l.useState)([]),[w,k]=(0,l.useState)(""),[C,z]=(0,l.useState)(""),[I,R]=(0,l.useState)(""),[T,M]=(0,l.useState)(0),P=(0,v.F)(e=>e.settings.textModel),E=(0,v.F)(e=>e.saveTextModel),D=(0,v.F)(e=>e.saveCodeModel),F=(0,n.p)(),A=(0,o.useTranslations)(),{getChatFile:L}=(0,j.Z)(),K=(0,l.useMemo)(()=>({status:"error",duration:1e4,isClosable:!0,position:"top-right"}),[]),O=(0,l.useCallback)(e=>{F({title:A("chatInput.fileUpload.errors.genericError.title"),description:A("chatInput.fileUpload.errors.genericError.description"),...K}),y([]),r.Tb(e),(0,f.x)((0,c.Xy)(e))},[y,F,K,A]),N=(0,l.useCallback)(async e=>{try{d(!0),y([e]);let t=(0,p.Ho)(null!=P?P:p.bO.id);(0,p.Pd)(t)<p.sI&&(E(p.dw.id),D(p.dw.id),F({...K,title:A("chatInput.fileUpload.largerContextSelected.title"),description:A("chatInput.fileUpload.largerContextSelected.description"),status:"info"}));let s=(0,m.m)(e.name),i=await (0,a.ws)("".concat(g.ju,"/").concat((0,h.LJ)(),".").concat(s),e,{access:"public",handleUploadUrl:"/api/inference/chat-file/upload"}),n=i.downloadUrl,r=await L(n,i.contentType);d(!1),k(e.name),z((0,x.J)(e)),(0,u.Qe)({name:"uploadedDocument",data:{mimeType:e.type,tokens:r.tokens}});let o=r.text.trim();if("PasswordException"===o){F({title:A("chatInput.fileUpload.errors.passwordException.title"),description:A("chatInput.fileUpload.errors.passwordException.description"),...K}),y([]);return}if(""===o){F({title:A("chatInput.fileUpload.errors.noText.title"),description:A("chatInput.fileUpload.errors.noText.description"),...K}),y([]);return}R(r.text),M(r.tokens)}catch(e){d(!1),O(e)}},[P,L,E,D,F,K,A,O]),B=(0,l.useCallback)(async e=>{try{y([e]),d(!0);let t=await new Promise((t,s)=>{let i=new FileReader;i.onload=()=>{let e=i.result.split(",")[1];t(e.trim())},i.onerror=()=>s(Error("Failed to read file")),i.readAsDataURL(e)});d(!1),k(e.name),z((0,x.J)(e)),R(t),(0,u.Qe)({name:"uploadedImage",data:{mimeType:e.type,base64Size:t.length}})}catch(e){d(!1),O(e)}},[O]),W=(0,l.useCallback)(()=>{y([]),R(""),k(""),z(""),M(0)},[y]);return(0,i.jsx)(b.Provider,{value:{handleTextFileUpload:N,handleImageFileUpload:B,resetFileState:W,setFiles:y,isFileLoading:s,fileName:w,fileType:C,fileText:I,fileTokens:T,files:S},children:t})}},5207:function(e,t,s){"use strict";s.d(t,{lZ:function(){return w},yl:function(){return k}});var i=s(57437),n=s(78796),r=s(22048),a=s(37065),o=s.n(a),l=s(42586),c=s(2265),d=s(25774),u=s(4271),h=s(74468),p=s(29827),g=s(64214),x=s(13823),m=s(43159),f=s(24387),j=s(63649);let v=e=>{let{children:t}=e,s=(0,p.NL)(),i=(0,d.Sz)(m.St,e=>e.id),{dispatch:n}=(0,c.useContext)(x.Q8),{fetchConversations:r}=(0,g.uu)(),a=k(e=>e.success);return(0,c.useEffect)(()=>{let e=async()=>{await s.invalidateQueries({queryKey:j.S.all}),n({field:"folders",value:await (0,f.eC)(i)}),r(i)};a&&e()},[a]),t};var b=s(33458);let S="backup-context-upload",y=(0,d.kr)({}),w=e=>{let{children:t}=e,a=(0,l.useTranslations)("settings.encryptedBackup.restore.progress"),d=(0,n.p)(),p=(0,c.useRef)(null),g=(0,c.useRef)(),x=(0,c.useRef)(null),m=(0,c.useRef)(!1),f=(0,c.useRef)(0),[j,w]=(0,c.useState)(!1),[k,C]=(0,c.useState)(!1),[z,I]=(0,c.useState)(),[R,T]=(0,c.useState)(0),[M,P]=(0,c.useState)(""),E=(0,c.useCallback)(()=>{var e;m.current=!0,C(!1),null===(e=x.current)||void 0===e||e.postMessage({type:"cancel"})},[]);(0,c.useEffect)(()=>{x.current=new Worker(s.tu(new URL(s.p+s.u(5792),s.b)),{type:void 0});let e=e=>{C(!1),m.current||I(a("restoreFailed")),m.current||r.Tb(e)},t=()=>{try{T(1),w(!0),P(a("complete")),(0,h.Qe)({name:"encryptedBackupRestored",data:{}})}catch(e){throw e}finally{C(!1)}};return x.current.onmessage=s=>{let{error:i,message:n,backupId:r,progress:o,progressMessage:l,type:c}=s.data;if(r===f.current){if("started"===c)return T(0),P(a("starting")),C(!0);if("message"===c&&n)return console.log("Worker message:",n);if(i)return e(null!=i?i:"Backup save failed");if("progress"===c){T(o),P(a(l));return}if("error"===c)return e(null!=i?i:"Backup restore failed");"success"===c&&t()}},x.current.onerror=e=>{m.current||console.error("Worker error:",e),m.current||I(a("restoreFailed")),C(!1)},()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.terminate()}},[]);let D=(0,c.useCallback)(o()((e,t,s)=>{var i;k||(f.current=f.current+1,m.current=!1,I(void 0),w(!1),P(a("starting")),T(0),null===(i=x.current)||void 0===i||i.postMessage({type:"started",blobUrls:e,password:t,nonce:s,encryptionKey:(0,b.XR)(),backupId:f.current}))},1500),[b.XR,k]);(0,c.useEffect)(()=>{let e=()=>{g.current=setTimeout(()=>{d.close(S)},5e3)};return(()=>{if(g.current&&clearTimeout(g.current),k&&!d.isActive(S)){let e=d({render:()=>(0,i.jsx)(u.W,{cancel:E,cancelTitle:a("cancel"),description:M,progress:100*R}),id:S,duration:null,isClosable:!1,position:"top"});if(!e)return;return p.current=e}if(k&&d.isActive(S))return d.update(S,{render:()=>(0,i.jsx)(u.W,{cancel:E,cancelTitle:a("cancel"),description:M,progress:100*R})});if(!k&&d.isActive(S)){if(j)return e(),d.update(S,{render:()=>(0,i.jsx)(u.W,{cancelTitle:a("cancel"),description:a("complete"),progress:100})});if(z)return e(),d.update(S,{render:()=>(0,i.jsx)(u.W,{cancelTitle:a("cancel"),description:a("failed"),progress:0})});if(m.current)return e(),d.update(S,{render:()=>(0,i.jsx)(u.W,{cancelTitle:a("cancel"),description:a("cancelled"),progress:0})});e()}})(),()=>{g.current&&clearTimeout(g.current)}},[E,d,k,M,R,a]);let F=(0,c.useMemo)(()=>({restoreBackup:D,cancel:E,error:z,isRunning:k,progress:R,progressMessage:M,success:j}),[D,E,z,k,R,M,j]);return(0,i.jsx)(y.Provider,{value:F,children:(0,i.jsx)(v,{children:t})})},k=e=>(0,d.Sz)(y,e)},51868:function(e,t,s){"use strict";s.d(t,{Q:function(){return n}});var i=s(47887);let n=async e=>{let{type:t,modelPostBody:s,clientProcessingTime:n,abortSignal:r}=e,a=t===i.BY.Image?"/api/inference/image":"/api/inference/chat";return await fetch(a,{method:"POST",headers:{"Content-Type":"application/json","X-Venice-Version":"20250129.213603"},signal:r,body:JSON.stringify({...s,clientProcessingTime:n})})}},1914:function(e,t,s){"use strict";s.d(t,{m:function(){return n}});var i=s(2265);function n(e){let{timeout:t=2e3}=e,[s,n]=(0,i.useState)(!1);return{isCopied:s,copyToClipboard:(0,i.useCallback)(e=>{var s;(null===(s=navigator.clipboard)||void 0===s?void 0:s.writeText)&&e&&navigator.clipboard.writeText(e).then(()=>{n(!0),setTimeout(()=>{n(!1)},t)})},[t])}}},63724:function(e,t,s){"use strict";s.d(t,{w:function(){return o}});var i=s(21652),n=s.n(i),r=s(2265),a=s(66262);let o=()=>{let[e,t]=(0,r.useState)(!1),s="/api/venice/version",i=(0,r.useCallback)(async e=>{try{let t=await fetch("".concat(e,"?").concat(new Date().valueOf()));if(!t.ok)throw Error("Network response was not ok");return await t.json()}catch(e){console.error(e)}},[]);return(0,r.useEffect)(()=>{let e=async()=>{let e=await i(s);if(!e)return;let r=!n()((0,a.y)(),e.version);(0,a.P)((0,a.y)(),e.minRequiredVersion)&&window.location.reload(),t(r)},r=setInterval(()=>void e(),9e5);return e(),()=>clearInterval(r)},[i,s]),e}},3240:function(e,t,s){"use strict";s.d(t,{s:function(){return n}});var i=s(82957);let n=e=>i.Buffer.from(e).toString("base64")},48728:function(e,t,s){"use strict";s.d(t,{z:function(){return n}});var i=s(48778);async function n(e,t,s){let n=new i.cB({separator:"\n",emitPartialTokens:!1});n.onValue=e=>{let{value:s,stack:i}=e;0===i.length&&"object"==typeof s&&s.constructor===Object&&("meta"===s.kind&&s.references||"content"===s.kind&&s.content)&&t(s)};let r=new TextDecoder,a=e.getReader();for(;;){let{done:e,value:t}=await a.read();if(e)return!1;let i=r.decode(t);if(n.write(i),null==s?void 0:s())return a.cancel(),!0}}},93020:function(e,t,s){"use strict";function i(e){return t=>{t.stopPropagation(),e(t)}}s.d(t,{I:function(){return i}})},14508:function(e,t,s){"use strict";s.d(t,{J:function(){return n}});var i=s(21846);function n(e){let t=e.type.toLowerCase();if("text/plain"===t||""===t.trim())return"Plain Text";if(t.startsWith("image/"))return"Image";if(t.startsWith("audio/"))return"Audio";if(t.startsWith("video/"))return"Video";if("application/pdf"===t)return"PDF";if(t.includes("spreadsheet")||"application/vnd.ms-excel"===t)return"Spreadsheet";if(t.includes("wordprocessing")||"application/msword"===t)return"Document";else return(0,i.m)(e.name)}},8958:function(e,t,s){"use strict";s.d(t,{v:function(){return n}});var i=s(61651);let n=(e,t,s)=>{let n=e.split(",");if(!n||n.length<2)return;let r=atob(n[1]),a=r.length,o=new Uint8Array(a);for(;a--;)o[a]=r.charCodeAt(a);return new i.$([o],t,{type:s})}},21846:function(e,t,s){"use strict";s.d(t,{m:function(){return i}});let i=e=>{if(-1===e.lastIndexOf("."))return"txt";let t=e.split(".").pop();return null!=t?t.replaceAll(/\s/g,""):"txt"}},44167:function(e,t,s){"use strict";s.d(t,{forwardRef:function(){return K.forwardRef}});var i=s(7193);s.o(i,"forwardRef")&&s.d(t,{forwardRef:function(){return i.forwardRef}});var n=s(26216);s.o(n,"forwardRef")&&s.d(t,{forwardRef:function(){return n.forwardRef}});var r=s(71247);s.o(r,"forwardRef")&&s.d(t,{forwardRef:function(){return r.forwardRef}});var a=s(93765);s.o(a,"forwardRef")&&s.d(t,{forwardRef:function(){return a.forwardRef}});var o=s(62031);s.o(o,"forwardRef")&&s.d(t,{forwardRef:function(){return o.forwardRef}});var l=s(77192);s.o(l,"forwardRef")&&s.d(t,{forwardRef:function(){return l.forwardRef}});var c=s(93542);s.o(c,"forwardRef")&&s.d(t,{forwardRef:function(){return c.forwardRef}});var d=s(75149);s.o(d,"forwardRef")&&s.d(t,{forwardRef:function(){return d.forwardRef}});var u=s(54586);s.o(u,"forwardRef")&&s.d(t,{forwardRef:function(){return u.forwardRef}});var h=s(21776);s.o(h,"forwardRef")&&s.d(t,{forwardRef:function(){return h.forwardRef}});var p=s(21295);s.o(p,"forwardRef")&&s.d(t,{forwardRef:function(){return p.forwardRef}});var g=s(61714);s.o(g,"forwardRef")&&s.d(t,{forwardRef:function(){return g.forwardRef}});var x=s(44939);s.o(x,"forwardRef")&&s.d(t,{forwardRef:function(){return x.forwardRef}});var m=s(71292);s.o(m,"forwardRef")&&s.d(t,{forwardRef:function(){return m.forwardRef}});var f=s(27567);s.o(f,"forwardRef")&&s.d(t,{forwardRef:function(){return f.forwardRef}});var j=s(60706);s.o(j,"forwardRef")&&s.d(t,{forwardRef:function(){return j.forwardRef}});var v=s(9735);s.o(v,"forwardRef")&&s.d(t,{forwardRef:function(){return v.forwardRef}});var b=s(73814);s.o(b,"forwardRef")&&s.d(t,{forwardRef:function(){return b.forwardRef}});var S=s(85542);s.o(S,"forwardRef")&&s.d(t,{forwardRef:function(){return S.forwardRef}});var y=s(4543);s.o(y,"forwardRef")&&s.d(t,{forwardRef:function(){return y.forwardRef}});var w=s(28405);s.o(w,"forwardRef")&&s.d(t,{forwardRef:function(){return w.forwardRef}});var k=s(22888);s.o(k,"forwardRef")&&s.d(t,{forwardRef:function(){return k.forwardRef}});var C=s(62946);s.o(C,"forwardRef")&&s.d(t,{forwardRef:function(){return C.forwardRef}});var z=s(4254);s.o(z,"forwardRef")&&s.d(t,{forwardRef:function(){return z.forwardRef}});var I=s(55158);s.o(I,"forwardRef")&&s.d(t,{forwardRef:function(){return I.forwardRef}});var R=s(53030);s.o(R,"forwardRef")&&s.d(t,{forwardRef:function(){return R.forwardRef}});var T=s(53481);s.o(T,"forwardRef")&&s.d(t,{forwardRef:function(){return T.forwardRef}});var M=s(53333);s.o(M,"forwardRef")&&s.d(t,{forwardRef:function(){return M.forwardRef}});var P=s(73115);s.o(P,"forwardRef")&&s.d(t,{forwardRef:function(){return P.forwardRef}});var E=s(71069);s.o(E,"forwardRef")&&s.d(t,{forwardRef:function(){return E.forwardRef}});var D=s(85170);s.o(D,"forwardRef")&&s.d(t,{forwardRef:function(){return D.forwardRef}});var F=s(55212);s.o(F,"forwardRef")&&s.d(t,{forwardRef:function(){return F.forwardRef}});var A=s(96074);s.o(A,"forwardRef")&&s.d(t,{forwardRef:function(){return A.forwardRef}});var L=s(75148);s.o(L,"forwardRef")&&s.d(t,{forwardRef:function(){return L.forwardRef}});var K=s(16121)},7193:function(){},26216:function(){},71247:function(){},93765:function(){},62031:function(){},77192:function(){},93542:function(){},75149:function(){},54586:function(){},21776:function(){},21295:function(){},61714:function(){},44939:function(){},71292:function(){},27567:function(){},60706:function(){},9735:function(){},73814:function(){},85542:function(){},4543:function(){},28405:function(){},22888:function(){},62946:function(){},4254:function(){},55158:function(){},53030:function(){},53481:function(){},53333:function(){},73115:function(){},71069:function(){},85170:function(){},55212:function(){},96074:function(){},75148:function(){},16121:function(e,t,s){"use strict";s.d(t,{forwardRef:function(){return i.G}});var i=s(68973)},11593:function(e,t,s){"use strict";s.d(t,{Gi:function(){return u},WF:function(){return d},hE:function(){return c},pA:function(){return h}});var i=s(71632),n=s(29827),r=s(21770),a=s(718),o=s(63649),l=s(33458);let c=e=>{let{getConversationById:t}=(0,a.c)();return(0,i.a)({queryKey:o.S.conversation(null!=e?e:""),queryFn:async()=>{if(!e)return null;let s=await t(e);return null!=s?s:null},enabled:!!e})},d=e=>{let{getConversations:t}=(0,a.c)();return(0,i.a)({queryKey:o.S.conversations(e),queryFn:()=>t(e),enabled:!!e})},u=()=>{let e=(0,n.NL)();return(0,r.D)({mutationFn:e=>l.db.conversations.put(e,e.id),onSuccess:async(t,s)=>{await e.invalidateQueries({queryKey:o.S.conversations(s.ownerId)})}})},h=()=>{let e=(0,n.NL)();return(0,r.D)({mutationFn:e=>l.db.conversations.update(e.id,e),onMutate:async e=>l.db.conversations.get(e.id),onSuccess:async(t,s,i)=>{await e.invalidateQueries({queryKey:o.S.conversation(s.id)}),i&&await e.invalidateQueries({queryKey:o.S.conversations(i.ownerId)})}})}},31223:function(e,t,s){"use strict";s.d(t,{g:function(){return d}});var i=s(21770),n=s(99411),r=s(66629),a=s(2265),o=s(94197),l=s(3490),c=s(18977);let d=e=>{let{setFiles:t,initialFiles:s}=e,[d,u]=(0,a.useState)(""),[h,p]=(0,a.useState)(s),{getChatFile:g}=(0,o.Z)(),x=(0,a.useMemo)(()=>h?h.reduce((e,t)=>e+t.tokens,0):0,[h]),m=(0,i.D)({mutationFn:async e=>{let{file:t,id:s}=e,i=await (0,n.ws)("".concat(l.ju,"/").concat(t.name),t,{access:"public",handleUploadUrl:"/api/inference/chat-file/upload"}),r=i.downloadUrl;return{data:await g(r,i.contentType),id:s}},onMutate:e=>{let{file:t,id:s}=e;u(""),p(e=>[...e,{id:s,file:t,fileName:t.name,text:"",tokens:0,isLoading:!0}])},onSuccess:e=>{let{id:s,data:i}=e;if(""===i.text.trim()){u("No text found in file"),p(e=>e.filter(e=>e.id!==s));return}p(e=>{let n=e.map(e=>e.id===s?{...e,text:i.text,tokens:i.tokens,isLoading:!1}:e);return t(n),n})},onError:e=>{(0,c.x)(e),u("We could not process your files. Please try again.")}});return{uploadFiles:(0,a.useCallback)(async e=>{for(let t of e)try{let e=(0,r.x0)();await m.mutateAsync({file:t,id:e})}catch(e){console.error("Error uploading file ".concat(t.name,":"),e)}},[m]),removeFile:(0,a.useCallback)(e=>{p(s=>{let i=s.filter(t=>t.id!==e);return t(i),i})},[t]),files:h,error:d,totalTokens:x,isLoading:m.isPending}}}},function(e){e.O(0,[6950,7240,7699,1866,174,702,8541,6613,7064,330,156,2957,7394,1760,9420,4748,4718,3889,1450,5878,7502,937,98,9411,7083,9307,8457,1161,1606,4575,1296,7316,4497,8435,5355,3074,4553,6416,991,2971,9189,3649,1744],function(){return e(e.s=69367)}),_N_E=e.O()}]);